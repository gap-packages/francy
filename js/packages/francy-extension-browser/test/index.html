<html>

<head>
  <meta charset="utf-8" content="text/html" property="GAP,francy,d3.v5">
  <script src="https://unpkg.com/viz.js@1.8.1/viz.js"></script>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://unpkg.com/d3-graphviz@2.6.0/build/d3-graphviz.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full,Safe"></script>
  <script src="../dist/browser/francy-extension-browser.bundle.js"></script>
  <title>Francy Test</title>
</head>

<body>
  <div id="francy_draw" style="visibility:hidden;"></div>
</body>

<script>
  /* global Francy */

  function trigger(json) {
    console.log(`Trigger(${JSON.stringify(JSON.stringify(json))});`);
  }

  function resolvePromise(francy) {
    francy.render().catch(error => console.log(error)).then(element => {
      // NOTE: we're using a visible div to append the object so no need to do anything here
      //document.getElementsByTagName('body')[0].appendChild(element);
      if (element) {
        document.body.appendChild(element);
        console.log('Object rendered...', element);
      }
    });
  }

  let settings = { appendTo: '#francy_draw', callbackHandler: trigger };
  Francy.settings(settings);

  fetch('json1.json')
    .then(response => response.json())
    .then(json => {
      resolvePromise(Francy.load(json));
    });

  fetch('json2.json')
    .then(response => response.json())
    .then(json => {
      resolvePromise(Francy.load(json));
    });

  fetch('json3.json')
    .then(response => response.json())
    .then(json => {
      resolvePromise(Francy.load(json));
    });

  fetch('json4.json')
    .then(response => response.json())
    .then(json => {
      resolvePromise(Francy.load(json));
    });

  fetch('json5.json')
    .then(response => response.json())
    .then(json => {
      resolvePromise(Francy.load(json));
    });

  fetch('json6.json')
    .then(response => response.json())
    .then(json => {
      resolvePromise(Francy.load(json));
    });

  fetch('json7.json')
    .then(response => response.json())
    .then(json => {
      resolvePromise(Francy.load(json));
    });
</script>

</html>
