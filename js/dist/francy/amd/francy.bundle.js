define(function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(4)),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}));if(new.target===t)throw new TypeError("Cannot construct [Renderer] instances directly!");if(void 0===i.render||"function"!=typeof i.render)throw new TypeError("Must override [render(json)] method!");return void 0===i.unrender&&i.logger.debug("No [unrender()] method specified..."),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"HTMLParent",get:function(){return"SVG"===this.options.appendTo.node().tagName?d3.select(this.options.appendTo.node().parentNode):this.options.appendTo}},{key:"SVGParent",get:function(){return"DIV"===this.options.appendTo.node().tagName?this.options.appendTo.select("svg"):this.options.appendTo}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}));return i.tooltip=i.HTMLParent.select("div.francy-tooltip-holder"),i.tooltip.node()||(i.tooltip=i.HTMLParent.append("div").attr("class","francy-tooltip-holder")),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"render",value:function(e){if(e&&Object.values(e).length){var t=d3.mouse(this.SVGParent.node());if(this.tooltip.style("left",t[0]+"px").style("top",t[1]+"px"),!this.tooltip.selectAll("*").node()){var n=this.tooltip.append("div").attr("class","francy-tooltip").append("div").attr("class","francy-table").append("div").attr("class","francy-table-body");Object.keys(e).map(function(t){var r=n.append("div").attr("class","francy-table-row");r.append("div").attr("class","francy-table-cell").text(e[t].title),r.append("div").attr("class","francy-table-cell").text(e[t].text)}),this.tooltip.style("display","block")}}}},{key:"unrender",value:function(){this.tooltip.selectAll("*").remove(),this.tooltip.style("display",null)}}]),t}();t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(0)),i=r(n(15)),l=r(n(16)),c=r(n(17)),u=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"render",value:function(e){if(e.canvas.chart){var t=void 0;switch(e.canvas.chart.type){case"bar":t=new i.default(this.options).render(e);break;case"line":t=new l.default(this.options).render(e);break;case"scatter":t=new c.default(this.options).render(e)}return t}}},{key:"unrender",value:function(){}}],[{key:"domainRange",value:function(e){return Array.from(new Array(e),function(e,t){return t}).map(function(e){return e})}},{key:"colors",get:function(){return d3.scaleSequential().domain([0,100]).interpolator(d3.interpolateRainbow)}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}));if(new.target===t)throw new TypeError("Cannot construct [Composite] instances directly!");return i.renderers=[],i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"add",value:function(e){this.renderers.push(e)}},{key:"renderChildren",value:function(e,t){var n=this.options;e&&(n.appendTo=e);var r=!0,o=!1,a=void 0;try{for(var i,l=this.renderers[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){i.value.update(n).render(t)}}catch(e){o=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw a}}}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(10)),a=function(){function e(t){var n=t.verbose,r=void 0!==n&&n,a=t.appendTo,i=t.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={verbose:r,appendTo:a,callbackHandler:i},this.logger=new o.default(this.options)}return r(e,[{key:"update",value:function(e){var t=e.verbose,n=void 0!==t&&t,r=e.appendTo,o=e.callbackHandler;return this.options={verbose:n,appendTo:r,callbackHandler:o},this}}]),e}();t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(0)),i=r(n(6)),l=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"traverse",value:function(e,t){for(var n=this;t.hasNext();){var r=t.next(),o=e.append("li"),a=o.selectAll("a").data([r]).enter().append("a").attr("title",r.title).html(r.title);if(r.callback&&Object.values(r.callback).length&&a.on("click",function(e){return new i.default(n.options).execute(e)}),r.menus&&Object.values(r.menus).length>0){var l=o.append("ul"),c=this.iterator(Object.values(r.menus));this.traverse(l,c)}}}},{key:"iterator",value:function(e){var t=0;return{next:function(){return this.hasNext()?e[t++]:void 0},hasNext:function(){return t<e.length}}}},{key:"unrender",value:function(){}}]),t}();t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(4)),i=r(n(14)),l=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"execute",value:function(e){return Object.keys(e.callback.requiredArgs).length?new i.default(this.options).render(e):this.options.callbackHandler(e.callback)}}]),t}();t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(8)),i=r(n(9)),l={},c=function(){function e(t){var n=t.verbose,r=void 0!==n&&n,o=t.appendTo,a=t.callbackHandler;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!a)throw new Error("A Callback Handler must be provided! This will be used to trigger events from the graphics produced...");if(!o)throw new Error("Missing an element or id to append the graphics to...!");if(!d3)throw new Error("D3 is not imported! Francy won't work without it... please import D3 v4+.");this.options={verbose:r,appendTo:o,callbackHandler:a}}return o(e,[{key:"render",value:function(e){var t=a.default.parse(e);if(t){var n=new i.default(this.options),r=n.render(t);return l[t.canvas.id]=n.canvas,r.node()}}},{key:"unrender",value:function(e){delete l[e]}}]),e}();t.default=c;try{t.Francy=window.Francy=c,window.onresize=function(){Object.values(l).forEach(function(e){e.zoomToFit()})}}catch(e){t.Francy=c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"parse",value:function(t){t=(t="string"!=typeof t?JSON.stringify(t):t).replace(/[\n\r\b\\]+|(gap>)/g,"");var n=/{(?:[^])*}/g.exec(t);if(n){t=n[0];try{var r=JSON.parse(t);return r.mime===e.MIME?r:void 0}catch(e){console.error(e)}}}},{key:"MIME",get:function(){return"application/vnd.francy+json"}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(3)),i=r(n(11)),l=r(n(18)),c=r(n(21)),u=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var u=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}));return u.canvas=new i.default(u.options),u.menu=new l.default(u.options),u.messages=new c.default(u.options),u.add(u.messages),u.add(u.menu),u.add(u.canvas),u}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"render",value:function(e){var t=d3.select(this.options.appendTo),n="F"+e.canvas.id,r=d3.select("div#"+n);if(r.node()||(this.logger.debug("Creating Frame ["+n+"]..."),r=t.append("div").attr("class","francy").attr("id",n)),!r.node())throw new Error("Oops, could not create frame with id ["+n+"]... Cannot proceed.");return this.logger.debug("Frame updated ["+n+"]..."),this.renderChildren(r,e),r}},{key:"unrender",value:function(){}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=null,a=function(){function e(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).verbose,n=void 0!==t&&t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o)return o;this.verbose=n,this.console=console,o=this}return r(e,[{key:"debug",value:function(e){this.verbose&&this.console.debug(this._format("DEBUG",e))}},{key:"info",value:function(e){this.console.info(this._format("INFO",e))}},{key:"error",value:function(e,t){this.console.error(this._format("ERROR",e),t)}},{key:"warn",value:function(e,t){t=t||{},this.console.error(this._format("WARN",e),t)}},{key:"_format",value:function(e,t){return"["+e+"] - "+(new Date).toISOString()+" - "+t}}]),e}();t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(3)),i=r(n(12)),l=r(n(2)),c=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var c=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}));return c.graph=new i.default(c.options),c.chart=new l.default(c.options),c.add(c.graph),c.add(c.chart),c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"render",value:function(e){function t(){i.attr("transform",d3.event.transform)}var n=this.options.appendTo,r=e.canvas.id,o=d3.select("svg#"+r);if(o.node()||(this.logger.debug("Creating Canvas ["+r+"]..."),o=n.append("svg").attr("id",r).attr("class","francy-canvas")),!o.node())throw new Error("Oops, could not create canvas with id ["+r+"]... Cannot proceed.");o.attr("width",e.canvas.width).attr("height",e.canvas.height);var a=d3.zoom(),i=o.select("g.francy-content");return i.node()||(i=o.append("g").attr("class","francy-content"),a.on("zoom",t),o.call(a).on("dblclick.zoom",null)),o.on("click",function(){d3.event.defaultPrevented&&d3.event.stopPropagation()},!0),o.zoomToFit=this.zoomToFit=function(){if(e.canvas.zoomToFit){var t=i.node().getBBox(),n=o.node().getBoundingClientRect(),r=n.right-n.left,l=n.bottom-n.top,c=t.width,u=t.height;if(0==c||0==u)return;var s=t.x+c/2,f=t.y+u/2,d=.75/Math.max(c/r,u/l),p=r/2-d*s,y=l/2-d*f;i.transition().duration(2e3).attr("transform","translate("+p+","+y+")scale("+d+","+d+")").on("end",function(){return function(e,t,n){o.call(a.transform,d3.zoomIdentity.translate(e,t).scale(n,n))}(p,y,d)})}},this.logger.debug("Canvas updated ["+r+"]..."),this.renderChildren(o,e),o}},{key:"unrender",value:function(){}}]),t}();t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(0)),i=r(n(13)),l=r(n(1)),c=r(n(6)),u=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,null,[{key:"getSymbol",value:function(e){return"circle"===e?d3.symbolCircle:"cross"===e?d3.symbolCross:"diamond"===e?d3.symbolDiamond:"square"===e?d3.symbolSquare:"triangle"===e?d3.symbolTriangle:"star"===e?d3.symbolStar:"wye"===e?d3.symbolWye:d3.symbolCircle}},{key:"colors",get:function(){return d3.scaleSequential().domain([0,100]).interpolator(d3.interpolateRainbow)}}]),o(t,[{key:"render",value:function(e){function n(){k.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),j.attr("transform",function(e){return"translate("+e.x+","+e.y+")"}),P.attr("x",function(e){return e.x-e.title.length-Math.sqrt(e.size*e.title.length*2)}).attr("y",function(e){return e.y-Math.sqrt(2*e.size)}),j.each(function(e){var t=d3.quadtree(b);return function(n){var r=100*n.size+L,o=n.x-r,a=n.x+r,i=n.y-r,l=n.y+r;t.visit(function(t,c,u,s,f){if(t.point&&t.point!==n){var d=n.x-t.point.x,p=n.y-t.point.y,y=Math.sqrt(d*d+p*p);y<r&&(y=(y-r)/y*e,n.x-=d*=y,n.y-=p*=y,t.point.x+=d,t.point.y+=p)}return c>a||s<o||u>l||f<i})}}(1))}function r(){function e(e,t){return N[e.index+","+t.index]}if(d3.event.preventDefault(),0===B){var t=d3.select(this).node().__data__;j.style("opacity",function(n){return e(t,n)||e(n,t)?1:.1}),k.style("opacity",function(e){return t.index===e.source.index||t.index===e.target.index?1:.1}),B=1}else j.style("opacity",1),k.style("opacity",1),B=0}function o(e){d3.event.active||H.alphaTarget(.01).restart(),e.fx=e.x,e.fy=e.y}function a(e){e.fx=d3.event.x,e.fy=d3.event.y}function u(e){d3.event.active||H.alphaTarget(0),e.fx=null,e.fy=null}function s(e,t){e.callbacks&&Object.values(e.callbacks).forEach(function(e){e.trigger===t&&v.execute({callback:e})})}var f=this.options.appendTo;if(e.canvas.graph){var d=!1,p=this.options;p.appendTo=d3.select(f.node().parentNode);var y=new l.default(p),h=new i.default(this.options),v=new c.default(this.options),b=e.canvas.graph.nodes?Object.values(e.canvas.graph.nodes):[],g=e.canvas.graph.links?Object.values(e.canvas.graph.links):[],m=f.select("g.francy-content"),w=+f.attr("width")||d3.select("body").node().getBoundingClientRect().width,x=+f.attr("height")||d3.select("body").node().getBoundingClientRect().height,_=m.selectAll("g.francy-links");_.node()||(_=m.append("g").attr("class","francy-links"));var k=_.selectAll("line.francy-link").data(g);(k.enter().data().length>0||k.enter().data().length>0)&&(d=!0),k.exit().remove(),k=k.enter().append("line").attr("class","francy-link").attr("id",function(e){return e.source+","+e.target}).attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}).merge(k),"directed"===e.canvas.graph.type&&(f.append("defs").selectAll("marker").data(["arrow"]).enter().append("marker").attr("class","francy-arrows").attr("id",function(e){return e}).attr("viewBox","0 -5 10 10").attr("refX",25).attr("refY",0).attr("markerWidth",10).attr("markerHeight",10).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5 L10,0 L0, -5"),k.style("marker-end","url(#arrow)"));var O=m.selectAll("g.francy-nodes");O.node()||(O=m.append("g").attr("class","francy-nodes"));var j=O.selectAll("path.francy-node").data(b);(j.exit().data().length>0||j.enter().data().length>0)&&(d=!0),j.exit().remove(),j=j.enter().append("path").merge(j).attr("d",d3.symbol().type(function(e){return t.getSymbol(e.type)}).size(function(e){return 100*e.size})).attr("transform",function(e){return"translate("+e.x+","+e.y+")"}).style("fill",function(e){return t.colors(5*e.layer)}).attr("class",function(e){return"francy-node"+(e.highlight?" francy-highlight":"")+(Object.values(e.menus).length?" francy-context":"")}).attr("id",function(e){return e.id}),e.canvas.graph.drag&&j.call(d3.drag().on("start",o).on("drag",a).on("end",u)),j.on("contextmenu",function(e){h.render(e),s.call(this,e,"contextmenu")}).on("click",function(e){r.call(this),s.call(this,e,"click")}).on("dblclick",function(e){s.call(this,e,"dblclick")}).on("mouseenter",function(e){y.render(e.messages)}).on("mouseleave",function(){y.unrender()});var T=m.selectAll(".francy-labels");T.node()||(T=m.append("g").attr("class","francy-labels"));var P=T.selectAll("text").data(b);if(P.exit().remove(),(P=P.enter().append("text").merge(P).attr("class","francy-label").text(function(e){return e.title}).attr("x",function(e){return e.x-e.title.length-Math.sqrt(e.size*e.title.length*2)}).attr("y",function(e){return e.y-Math.sqrt(2*e.size)})).on("contextmenu",function(e){h.render(e),s.call(this,e,"contextmenu")}).on("click",function(e){r.call(this),s.call(this,e,"click")}).on("dblclick",function(e){s.call(this,e,"dblclick")}).on("mouseover",function(e){y.render(e.messages)}).on("mouseout",function(){y.unrender()}),e.canvas.graph.simulation&&d){var E=d3.forceCenter().x(w/2).y(x/2),A=d3.forceManyBody().strength(30*-b.length),M=d3.forceLink(g).id(function(e){return e.id}).distance(50),C=d3.forceCollide(function(e){return 2*e.size}),S=d3.forceX(w/2).strength(.05),R=d3.forceY(x/2).strength(.25);"hasse"===e.canvas.graph.type&&(S=d3.forceX(w/2).strength(.5),R=d3.forceY(function(e){return 50*e.layer}).strength(5));var H=d3.forceSimulation(b).force("charge",A).force("link",M).force("center",E).force("x",S).force("y",R).force("collide",C).on("tick",n).on("end",function(){f.zoomToFit()});H.restart()}else f.zoomToFit();for(var L=10,B=0,N={},F=0;F<b.length;F++)N[F+","+F]=1;return g.forEach(function(e){N[e.source.index+","+e.target.index]=1}),m}this.logger.debug("No Graph to render here... continuing...")}},{key:"unrender",value:function(){}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(5)),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}));return i.contextMenu=i.HTMLParent.select("div.francy-context-menu-holder"),i.contextMenu.node()||(i.contextMenu=i.HTMLParent.append("div").attr("class","francy-context-menu-holder")),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"render",value:function(e){var t=this;if(d3.event.preventDefault(),e.menus&&Object.values(e.menus).length){var n=d3.mouse(this.SVGParent.node());if(this.contextMenu.transition().duration(1e3).style("left",n[0]+5+"px").style("top",n[1]+5+"px"),this.contextMenu.style("display","block"),!this.contextMenu.selectAll("*").node()){d3.select("body").on("click.francy-context-menu",function(){return t.unrender()});var r=this.contextMenu.append("div").attr("class","francy-context-menu").append("ul"),o=this.iterator(Object.values(e.menus));return this.traverse(r,o),this.contextMenu}}else this.logger.debug("No ContextMenu to render here... continuing...")}},{key:"unrender",value:function(){this.contextMenu.selectAll("*").remove(),this.contextMenu.style("display",null)}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"render",value:function(e){var t=this,n=e.callback.id;this.logger.debug("Creating Callback Modal ["+n+"]...");var r=d3.select("body").append("div").attr("class","francy-overlay"),o=d3.select("body").append("div").attr("class","francy"),a=o.append("div").attr("id",n).attr("class","francy-modal"),i=a.append("form"),l=i.append("div").attr("class","francy-modal-header").append("span").html("Required arguments&nbsp;");e.title&&l.append("span").attr("style","font-weight: bold;").text("for "+e.title);var c=i.append("div").attr("class","francy-modal-content").append("div").attr("class","francy-table").append("div").attr("class","francy-table-body"),u=!0,s=!1,f=void 0;try{for(var d,p=Object.values(e.callback.requiredArgs)[Symbol.iterator]();!(u=(d=p.next()).done);u=!0){var y=d.value,h=c.append("div").attr("class","francy-table-row");h.append("div").attr("class","francy-table-cell").append("label").attr("for",y.id).text(y.title);var v=h.append("div").attr("class","francy-table-cell").append("input").attr("id",y.id).attr("class","francy-arg").attr("required","").attr("name",y.id).attr("type",y.type).attr("value",y.value).on("change",function(){e.callback.requiredArgs[this.id].value=this.value}).on("input",this.onchange).on("keyup",this.onchange).on("paste",this.onchange);"boolean"===y.type&&(y.value=y.value||!1,v.attr("type","checkbox").attr("required",null).attr("value",y.value).on("change",function(){e.callback.requiredArgs[this.id].value=this.value=this.checked})),h.append("span").attr("class","validity")}}catch(e){s=!0,f=e}finally{try{!u&&p.return&&p.return()}finally{if(s)throw f}}var b=i.append("div").attr("class","francy-modal-footer");b.append("button").text("Ok").on("click",function(){return i.node().checkValidity()&&(t.options.callbackHandler(e.callback),r.remove(),a.remove(),o.remove(),event.preventDefault()),!1}),b.append("button").text("Cancel").on("click",function(){return event.preventDefault(),r.remove(),a.remove(),o.remove(),!1});try{Jupyter.keyboard_manager.register_events(".francy"),Jupyter.keyboard_manager.register_events(".francy-arg"),Jupyter.keyboard_manager.register_events(".francy-overlay"),Jupyter.keyboard_manager.register_events(".francy-modal")}catch(e){"ReferenceError"==e.name&&t.logger.debug("It seems we're not running on Jupyter...",e)}return c.selectAll(".francy-arg").node().focus(),this.logger.debug("Callback Modal updated ["+n+"]..."),a}},{key:"unrender",value:function(){}}]),t}();t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(0)),i=r(n(1)),l=r(n(2)),c=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"render",value:function(e){if(e.canvas.chart){var t=new i.default(this.options),n=this.options.appendTo,r=e.canvas.chart.axis,o=e.canvas.chart.data,a=Object.keys(o),c=n.select("g.francy-content"),u=50,s=50,f=50,d=50,p=+n.attr("width")||d3.select("body").node().getBoundingClientRect().width,y=+n.attr("height")||d3.select("body").node().getBoundingClientRect().height;p=p-d-s,y=y-u-f;var h=d3.scaleBand().range([0,p]).padding(.1).domain(r.x.domain),v=d3.scaleLinear().range([y,0]).domain(r.y.domain),b=[];a.forEach(function(e){return b=b.concat(o[e])}),r.y.domain.length||v.domain([0,d3.max(b,function(e){return e})]),r.x.domain.length||(r.x.domain=l.default.domainRange(b.length/a.length),h.domain(r.x.domain));var g=c.selectAll("g.francy-bars");g.node()||(g=c.append("g").attr("class","francy-bars")),a.forEach(function(e,n){var i=g.selectAll(".francy-bar"+n).data(o[e]);i.exit().remove(),i.enter().append("rect").style("fill",function(){return l.default.colors(5*n)}).attr("class","francy-bar"+n).attr("x",function(e,t){return h(r.x.domain[t])+n*(h.bandwidth()/a.length)}).attr("width",h.bandwidth()/a.length-1).attr("y",function(e){return v(e)}).attr("height",function(e){return y-v(e)}).on("mouseover",function(n){d3.select(this).transition().duration(250).style("fill-opacity",.5),t.render({Dataset:e,Value:n})}).on("mouseout",function(){d3.select(this).transition().duration(250).style("fill-opacity",1),t.unrender()}),i.merge(i)});var m=c.selectAll("g.francy-x-axis");m.node()||(m=c.append("g").attr("class","francy-x-axis")),m.selectAll("*").remove(),m.attr("transform","translate(0,"+y+")").call(d3.axisBottom(h)).append("text").attr("dy",50).attr("dx",p/2).attr("fill","black").attr("class","francy-axis").style("text-anchor","end").text(r.x.title);var w=c.selectAll("g.francy-y-axis");w.node()||(w=c.append("g").attr("class","francy-y-axis")),w.selectAll("*").remove(),w.call(d3.axisLeft(v)).append("text").attr("dx",-50).attr("dy",y/2).attr("fill","black").attr("class","francy-axis").style("text-anchor","end").text(r.y.title);var x=c.selectAll(".francy-legend");x.node()||(x=c.append("g").attr("class","francy-legend")),x.selectAll("*").remove();var _=x.selectAll("g").data(a.slice());return _.exit().remove(),(_=_.enter().append("g").attr("transform",function(e,t){return"translate(0,"+20*t+")"}).merge(_)).append("rect").attr("x",p+20).attr("width",19).attr("height",19).style("fill",function(e,t){return l.default.colors(5*t)}),_.append("text").attr("x",p+80).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(e){return e}),n.zoomToFit(),c}this.logger.debug("No BarChart to render here... continuing...")}},{key:"unrender",value:function(){}}]),t}();t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(0)),i=r(n(1)),l=r(n(2)),c=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"render",value:function(e){if(e.canvas.chart){var t=new i.default(this.options),n=this.options.appendTo,r=e.canvas.chart.axis,o=e.canvas.chart.data,a=Object.keys(o),c=n.select("g.francy-content"),u=50,s=50,f=50,d=50,p=+n.attr("width")||d3.select("body").node().getBoundingClientRect().width,y=+n.attr("height")||d3.select("body").node().getBoundingClientRect().height;p=p-d-s,y=y-u-f;var h=d3.scaleLinear().range([0,p]).domain(r.x.domain),v=d3.scaleLinear().range([y,0]).domain(r.y.domain),b=[];a.forEach(function(e){return b=b.concat(o[e])}),r.y.domain.length||v.domain([0,d3.max(b,function(e){return e})]),r.x.domain.length||h.domain([0,b.length/a.length]);var g=c.selectAll("g.francy-lines");g.node()||(g=c.append("g").attr("class","francy-lines")),a.forEach(function(e,n){var r=d3.line().x(function(e,t){return h(t)}).y(function(e){return v(e)}),a=g.selectAll(".line"+n).data([o[e]]);a.exit().remove(),a.enter().append("path").style("stroke",function(){return l.default.colors(5*n)}).style("stroke-width","5px").attr("class","francy-line"+n).attr("d",r).on("mouseover",function(n){d3.select(this).transition().duration(250).style("stroke-opacity",.5).style("stroke-width","10px"),t.render({Dataset:e,Value:n})}).on("mouseout",function(){d3.select(this).transition().duration(250).style("stroke-opacity",1).style("stroke-width","5px"),t.unrender()}),a.merge(a)});var m=c.selectAll("g.francy-x-axis");m.node()||(m=c.append("g").attr("class","francy-x-axis")),m.selectAll("*").remove(),m.attr("transform","translate(0,"+y+")").call(d3.axisBottom(h)).append("text").attr("dy",50).attr("dx",p/2).attr("fill","black").attr("class","francy-axis").style("text-anchor","end").text(r.x.title);var w=c.selectAll("g.francy-y-axis");w.node()||(w=c.append("g").attr("class","francy-y-axis")),w.selectAll("*").remove(),w.call(d3.axisLeft(v)).append("text").attr("dx",-50).attr("dy",y/2).attr("fill","black").attr("class","francy-axis").style("text-anchor","end").text(r.y.title);var x=c.selectAll(".francy-legend");x.node()||(x=c.append("g").attr("class","francy-legend")),x.selectAll("*").remove();var _=x.selectAll("g").data(a.slice());return _.exit().remove(),(_=_.enter().append("g").attr("transform",function(e,t){return"translate(0,"+20*t+")"}).merge(_)).append("rect").attr("x",p+20).attr("width",19).attr("height",19).style("fill",function(e,t){return l.default.colors(5*t)}),_.append("text").attr("x",p+80).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(e){return e}),n.zoomToFit(),c}this.logger.debug("No LineChart to render here... continuing...")}},{key:"unrender",value:function(){}}]),t}();t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(0)),i=r(n(1)),l=r(n(2)),c=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"render",value:function(e){if(e.canvas.chart){var t=new i.default(this.options),n=this.options.appendTo,r=e.canvas.chart.axis,o=e.canvas.chart.data,a=Object.keys(o),c=n.select("g.francy-content"),u=50,s=50,f=50,d=50,p=+n.attr("width")||d3.select("body").node().getBoundingClientRect().width,y=+n.attr("height")||d3.select("body").node().getBoundingClientRect().height;p=p-d-s,y=y-u-f;var h=d3.scaleLinear().range([0,p]).domain(r.x.domain),v=d3.scaleLinear().range([y,0]).domain(r.y.domain),b=[];a.forEach(function(e){return b=b.concat(o[e])}),r.y.domain.length||v.domain([0,d3.max(b,function(e){return e})]),r.x.domain.length||h.domain([0,b.length/a.length]);var g=c.selectAll("g.francy-scatters");g.node()||(g=c.append("g").attr("class","francy-scatters")),a.forEach(function(e,n){var r=g.selectAll(".scatter"+n).data(o[e]);r.exit().remove(),r.enter().append("circle").style("fill",function(){return l.default.colors(5*n)}).attr("class","francy-scatter"+n).attr("r",5).attr("cx",function(e,t){return h(t)}).attr("cy",function(e){return v(e)}).on("mouseover",function(n){d3.select(this).transition().duration(250).style("fill-opacity",.5).attr("r",10),t.render({Dataset:e,Value:n})}).on("mouseout",function(){d3.select(this).transition().duration(250).style("fill-opacity",1).attr("r",5),t.unrender()}),r.merge(r)});var m=c.selectAll("g.francy-x-axis");m.node()||(m=c.append("g").attr("class","francy-x-axis")),m.selectAll("*").remove(),m.attr("transform","translate(0,"+y+")").call(d3.axisBottom(h)).append("text").attr("dy",50).attr("dx",p/2).attr("fill","black").attr("class","francy-axis").style("text-anchor","end").text(r.x.title);var w=c.selectAll("g.francy-y-axis");w.node()||(w=c.append("g").attr("class","francy-y-axis")),w.selectAll("*").remove(),w.call(d3.axisLeft(v)).append("text").attr("dx",-50).attr("dy",y/2).attr("fill","black").attr("class","francy-axis").style("text-anchor","end").text(r.y.title);var x=c.selectAll(".francy-legend");x.node()||(x=c.append("g").attr("class","francy-legend")),x.selectAll("*").remove();var _=x.selectAll("g").data(a.slice());return _.exit().remove(),(_=_.enter().append("g").attr("transform",function(e,t){return"translate(0,"+20*t+")"}).merge(_)).append("rect").attr("x",p+20).attr("width",19).attr("height",19).style("fill",function(e,t){return l.default.colors(5*t)}),_.append("text").attr("x",p+80).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(e){return e}),n.zoomToFit(),c}this.logger.debug("No ScatterChart to render here... continuing...")}},{key:"unrender",value:function(){}}]),t}();t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(5)),i=r(n(19)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(20)),c=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"render",value:function(e){var t=this.options.appendTo,n=new i.default(this.options),r="MainMenu-"+e.canvas.id,o=d3.select("#"+r);o.node()||(this.logger.debug("Creating Main Menu ["+r+"]..."),o=t.append("div").attr("class","francy-main-menu-holder").attr("id",r)),o.selectAll("*").remove(),o=o.append("ul").attr("class","francy-main-menu"),e.canvas.title&&o.append("li").attr("class","francy-title").append("a").html(e.canvas.title);var a=o.append("li");a.append("a").html("Francy");var c=a.append("ul");e.canvas.zoomToFit&&c.append("li").append("a").on("click",function(){return t.canvas.zoomToFit()}).attr("title","Zoom to Fit").html("Zoom to Fit"),c.append("li").append("a").on("click",function(){return l.saveSvgAsPng(document.getElementById(e.canvas.id),"diagram.png")}).attr("title","Save to PNG").html("Save to PNG"),c.append("li").append("a").on("click",function(){return n.render(e)}).attr("title","About").html("About");var u=this.iterator(Object.values(e.canvas.menus));return this.traverse(o,u),this.logger.debug("Main Menu updated ["+r+"]..."),o}},{key:"unrender",value:function(){}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"render",value:function(e){var t="AboutModalWindow";this.logger.debug("Creating About Modal ["+t+"]...");var n=d3.select("body").append("div").attr("class","francy-overlay"),r=d3.select("body").append("div").attr("class","francy"),o=r.append("div").attr("id",t).attr("class","francy-modal"),a=o.append("form");a.append("div").attr("class","francy-modal-header").append("span").html("About Francy v"+e.version);var i=a.append("div").attr("class","francy-modal-content").append("div").attr("class","francy-table").append("div").attr("class","francy-table-body");i.append("span").text("Loaded Object:"),i.append("pre").attr("class","francy").html(this.syntaxHighlight(JSON.stringify(e.canvas,null,2))),i.append("span").append("a").attr("href","https://github.com/mcmartins/francy").text("Francy on Github");a.append("div").attr("class","francy-modal-footer").append("button").text("Ok").on("click",function(){return o.remove(),r.remove(),n.remove(),event.preventDefault(),!1});try{Jupyter.keyboard_manager.register_events(".francy"),Jupyter.keyboard_manager.register_events(".francy-arg"),Jupyter.keyboard_manager.register_events(".francy-overlay"),Jupyter.keyboard_manager.register_events(".francy-modal")}catch(e){"ReferenceError"==e.name&&self.logger.debug("It seems we're not running on Jupyter...",e)}return this.logger.debug("Callback About updated ["+t+"]..."),o}},{key:"unrender",value:function(){}},{key:"syntaxHighlight",value:function(e){return(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?)/g,function(e){var t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),'<span class="'+t+'">'+e+"</span>"})}}]),t}();t.default=a},function(e,t,n){"use strict";var r;!function(){function o(e){if(!function(e){return e instanceof HTMLElement||e instanceof SVGElement}(e))throw new Error("an HTMLElement or SVGElement is required; got "+e)}function a(e){return e&&0==e.lastIndexOf("http",0)&&-1==e.lastIndexOf(window.location.host)}function i(e,t,n){function r(e){function t(t){function n(e){console.warn("Failed to load font from: "+t.url),console.warn(e),i+=t.text+"\n",r()}var o=new XMLHttpRequest;o.addEventListener("load",function(){var n=function(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,o=0;o<r;o++)t+=String.fromCharCode(n[o]);return window.btoa(t)}(o.response);!function(t,n){var o='url("data:'+t.format+";base64,"+n+'")';i+=t.text.replace(t.fontUrlRegexp,o)+"\n",setTimeout(function(){r(e)},0)}(t,n)}),o.addEventListener("error",n),o.addEventListener("abort",n),o.open("GET",t.url),o.responseType="arraybuffer",o.send()}if(e.length>0){t(e.pop())}else n(i)}for(var o=t.selectorRemap,a=t.modifyStyle,i="",l=[],c=document.styleSheets,u=0;u<c.length;u++){try{var s=c[u].cssRules}catch(e){console.warn("Stylesheet could not be loaded: "+c[u].href);continue}if(null!=s)for(var f,d=0;d<s.length;d++,f=null){var p=s[d];if(void 0!==p.style){var y;try{y=p.selectorText}catch(e){console.warn('The following CSS rule has an invalid selector: "'+p+'"',e)}try{y&&(f=e.querySelector(y)||e.parentNode.querySelector(y))}catch(e){console.warn('Invalid CSS selector "'+y+'"',e)}if(f){var h=o?o(p.selectorText):p.selectorText,v=a?a(p.style.cssText):p.style.cssText;i+=h+" { "+v+" }\n"}else if(p.cssText.match(/^@font-face/)){var b=/url\(["']?(.+?)["']?\)/,g=p.cssText.match(b),m=g&&g[1]||"";m.match(/^data:/)&&(m=""),m?(m.startsWith("../")?m=c[u].href+"/../"+m:m.startsWith("./")&&(m=c[u].href+"/."+m),l.push({text:p.cssText,fontUrlRegexp:b,format:function(e){for(var t={woff2:"font/woff2",woff:"font/woff",otf:"application/x-font-opentype",ttf:"application/x-font-ttf",eot:"application/vnd.ms-fontobject",sfnt:"application/font-sfnt",svg:"image/svg+xml"},n=Object.keys(t),r=0;r<n.length;++r){var o=n[r];if(e.indexOf("."+o)>0)return t[o]}return console.error("Unknown font format for "+e+"; Fonts may not be working correctly"),"application/octet-stream"}(m),url:m})):i+=p.cssText+"\n"}}}}r(l)}function l(e,t,n){var r=e.viewBox&&e.viewBox.baseVal&&e.viewBox.baseVal[n]||null!==t.getAttribute(n)&&!t.getAttribute(n).match(/%$/)&&parseInt(t.getAttribute(n))||e.getBoundingClientRect()[n]||parseInt(t.style[n])||parseInt(window.getComputedStyle(e).getPropertyValue(n));return void 0===r||null===r||isNaN(parseFloat(r))?0:r}function c(e){for(var t=window.atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),o=new Uint8Array(r),a=0;a<t.length;a++)o[a]=t.charCodeAt(a);return new Blob([r],{type:n})}var u=void 0!==t&&t||{}||this;u.prepareSvg=function(e,t,n){o(e),(t=t||{}).scale=t.scale||1,t.responsive=t.responsive||!1;var r="http://www.w3.org/2000/xmlns/";!function(e,t){o(e);var n=e.querySelectorAll("image"),r=n.length,i=function(){0===r&&t()};i();for(var l=0;l<n.length;l++)!function(e){var t=e.getAttributeNS("http://www.w3.org/1999/xlink","href");if(t&&a(t.value))console.warn("Cannot render embedded images linking to external hosts: "+t.value);else{var n=document.createElement("canvas"),o=n.getContext("2d"),l=new Image;l.crossOrigin="anonymous",(t=t||e.getAttribute("href"))?(l.src=t,l.onload=function(){n.width=l.width,n.height=l.height,o.drawImage(l,0,0),e.setAttributeNS("http://www.w3.org/1999/xlink","href",n.toDataURL("image/png")),r--,i()},l.onerror=function(){console.log("Could not load "+t),r--,i()}):(r--,i())}}(n[l])}(e,function(){var o,a,c=document.createElement("div"),u=e.cloneNode(!0);if("svg"==e.tagName)o=t.width||l(e,u,"width"),a=t.height||l(e,u,"height");else{if(!e.getBBox)return void console.error("Attempted to render non-SVG element",e);var s=e.getBBox();o=s.x+s.width,a=s.y+s.height,u.setAttribute("transform",u.getAttribute("transform").replace(/translate\(.*?\)/,""));var f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.appendChild(u),u=f}u.setAttribute("version","1.1"),u.getAttribute("xmlns")||u.setAttributeNS(r,"xmlns","http://www.w3.org/2000/svg"),u.getAttribute("xmlns:xlink")||u.setAttributeNS(r,"xmlns:xlink","http://www.w3.org/1999/xlink"),t.responsive?(u.removeAttribute("width"),u.removeAttribute("height"),u.setAttribute("preserveAspectRatio","xMinYMin meet")):(u.setAttribute("width",o*t.scale),u.setAttribute("height",a*t.scale)),u.setAttribute("viewBox",[t.left||0,t.top||0,o,a].join(" "));for(var d=u.querySelectorAll("foreignObject > *"),p=0;p<d.length;p++)d[p].getAttribute("xmlns")||d[p].setAttributeNS(r,"xmlns","http://www.w3.org/1999/xhtml");c.appendChild(u),i(e,t,function(e){var t=document.createElement("style");t.setAttribute("type","text/css"),t.innerHTML="<![CDATA[\n"+e+"\n]]>";var r=document.createElement("defs");if(r.appendChild(t),u.insertBefore(r,u.firstChild),n){var i=c.innerHTML;i=i.replace(/NS\d+:href/gi,'xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href'),n(i,o,a)}})})},u.svgAsDataUri=function(e,t,n){u.prepareSvg(e,t,function(e){var t="data:image/svg+xml;base64,"+window.btoa(function(e){return e=encodeURIComponent(e),e=e.replace(/%([0-9A-F]{2})/g,function(e,t){var n=String.fromCharCode("0x"+t);return"%"===n?"%25":n}),decodeURIComponent(e)}('<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" [<!ENTITY nbsp "&#160;">]>'+e));n&&n(t)})},u.svgAsPngUri=function(e,t,n){o(e),(t=t||{}).encoderType=t.encoderType||"image/png",t.encoderOptions=t.encoderOptions||.8;var r=function(e,r,o){var a=document.createElement("canvas"),i=a.getContext("2d");a.width=r,a.height=o,t.canvg?t.canvg(a,e):i.drawImage(e,0,0),t.backgroundColor&&(i.globalCompositeOperation="destination-over",i.fillStyle=t.backgroundColor,i.fillRect(0,0,a.width,a.height));var l;try{l=a.toDataURL(t.encoderType,t.encoderOptions)}catch(e){if("undefined"!=typeof SecurityError&&e instanceof SecurityError||"SecurityError"==e.name)return void console.error("Rendered SVG images cannot be downloaded in this browser.");throw e}n(l)};t.canvg?u.prepareSvg(e,t,r):u.svgAsDataUri(e,t,function(e){var t=new Image;t.onload=function(){r(t,t.width,t.height)},t.onerror=function(){console.error("There was an error loading the data URI as an image on the following SVG\n",window.atob(e.slice(26)),"\n","Open the following link to see browser's diagnosis\n",e)},t.src=e})},u.download=function(e,t){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(c(t),e);else{var n=document.createElement("a");if("download"in n){n.download=e,n.style.display="none",document.body.appendChild(n);try{var r=c(t),o=URL.createObjectURL(r);n.href=o,n.onclick=function(){requestAnimationFrame(function(){URL.revokeObjectURL(o)})}}catch(e){console.warn("This browser does not support object URLs. Falling back to string URL."),n.href=t}n.click(),document.body.removeChild(n)}else window.open(t,"_temp","menubar=no,toolbar=no,status=no")}},u.saveSvg=function(e,t,n){o(e),n=n||{},u.svgAsDataUri(e,n,function(e){u.download(t,e)})},u.saveSvgAsPng=function(e,t,n){o(e),n=n||{},u.svgAsPngUri(e,n,function(e){u.download(t,e)})},void 0===(r=function(){return u}.call(t,n,t,e))||(e.exports=r)}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,o=e.appendTo,a=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:o,callbackHandler:a}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"render",value:function(e){var t=this.options.appendTo,n=e.canvas.messages;if(n&&Object.values(n).length){n=Object.keys(e.canvas.messages).map(function(e){return{id:e,type:n[e].type,title:n[e].title,text:n[e].text}});var r="Messages-"+e.canvas.id,o=d3.select("#"+r);return o.node()||(o=t.append("div").attr("class","francy-message-holder").attr("id",r)),n.map(function(e){if(!o.select("div#"+e.id).node()){var t=o.append("div").attr("id",e.id).attr("class","francy-alert alert-"+e.type).on("click",function(){d3.select(this).style("display","none")});t.append("span").attr("class","strong").text(e.title),t.append("span").text(e.text),t.append("span").attr("class","strong").style("display","none").text("x")}}),o.style("display","block"),o}}},{key:"unrender",value:function(){}}]),t}();t.default=a}])});