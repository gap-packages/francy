{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 1a0a434c577b2cfb12bb","webpack:///./src/render/renderer.js","webpack:///./src/util/data-decorator.js","webpack:///./src/util/component.js","webpack:///./src/render/chart.js","webpack:///./src/render/composite.js","webpack:///./src/render/base.js","webpack:///./src/util/logger.js","webpack:///./src/render/graph.js","webpack:///./src/render/menu.js","webpack:///./src/render/callback.js","webpack:///./src/render/tooltip.js","webpack:///./src/francy.js","webpack:///./src/render/frame.js","webpack:///./src/util/json-utils.js","webpack:///./src/render/canvas.js","webpack:///./src/render/graph-factory.js","webpack:///./src/render/graph-tree.js","webpack:///./src/render/menu-context.js","webpack:///./src/render/modal-required.js","webpack:///./src/render/graph-generic.js","webpack:///./src/render/chart-factory.js","webpack:///./src/render/chart-bar.js","webpack:///./src/render/chart-line.js","webpack:///./src/render/chart-scatter.js","webpack:///./src/render/menu-main.js","webpack:///./src/render/modal-about.js","webpack:///./node_modules/save-svg-as-png/saveSvgAsPng.js","webpack:///./src/render/message.js"],"names":["Renderer","verbose","appendTo","callbackHandler","new","target","TypeError","render","undefined","unrender","logger","debug","element","transitionDuration","options","node","tagName","toLowerCase","d3","select","parentNode","top","right","bottom","left","width","parent","attr","getBoundingClientRect","margin","height","requires","props","decorator","name","descriptor","oldValue","value","hasData","getProperty","data","apply","arguments","obj","propertyPath","tmp","properties","split","property","hasOwnProperty","Array","length","Object","values","RegisterMathJax","RegisterJupyterKeyboardEvents","setTimeout","MathJax","Hub","Config","tex2jax","jax","inlineMath","displayMath","processEscapes","Register","StartupHook","selectAll","each","self","mathJax","append","remove","Queue","Configured","e","info","classes","map","cl","Jupyter","keyboard_manager","register_events","Chart","axis","yScale","xScale","datasets","datasetNames","tooltip","canvas","chart","keys","scaleLinear","range","domain","x","y","allValues","forEach","concat","key","max","d","xAxisGroup","call","axisBottom","style","text","title","yAxisGroup","axisLeft","showLegend","legendGroup","legend","slice","exit","enter","i","merge","colors","dataset","from","_","scaleSequential","interpolator","interpolateRainbow","Composite","renderers","renderer","push","settings","load","Base","log","Error","json","partial","parse","Logger","console","message","_format","error","level","Date","toISOString","Graph","contextMenu","callback","on","executeCallback","messages","event","callbacks","cb","trigger","execute","type","symbolCross","symbolDiamond","symbolSquare","symbolTriangle","symbolStar","symbolWye","symbolCircle","Menu","menusIterator","hasNext","menuItem","next","entry","action","html","menus","content","subMenusIterator","iterator","traverse","array","nextIndex","CallbackHandler","requiredArgs","callbackObj","_execute","calbackObj","JSON","stringify","Tooltip","HTMLParent","pos","mouse","SVGParent","table","row","ALL_CANVAS","Francy","frame","id","exports","window","oldResize","onresize","zoomToFit","Frame","menu","add","frameId","renderChildren","JsonUtils","input","replace","jsonRegex","match","exec","mime","MIME","Canvas","graph","chartFactory","zoom","updateZoom","translateX","translateY","scale","transform","zoomIdentity","translate","zoomed","stopped","defaultPrevented","stopPropagation","bounds","getBBox","clientBounds","fullWidth","fullHeight","midX","midY","Math","transition","duration","canvasId","TreeGraph","_initialize","root","hierarchy","treeData","children","x0","y0","levelWidth","childCount","n","newHeight","treemap","tree","size","collapsed","collapse","update","_children","source","nodes","descendants","links","depth","linkGroup","link","linkEnter","o","diagonal","s","nodeGroup","nodeEnter","symbol","getSymbol","nodeUpdate","layer","_applyEvents","nodeOnClick","click","canvasNodes","dataMap","reduce","ContextMenu","preventDefault","RequiredArgsModal","modalId","overlay","holder","form","header","headerTitle","arg","onchange","checked","footer","checkValidity","inputElement","focus","GenericGraph","simulationActive","simulation","canvasLinks","linksToAdd","_filterNewElements","nodesToAdd","highlight","drag","dragstarted","dragged","dragended","empty","showNeighbours","connectedNodes","centerForce","forceCenter","manyForce","forceManyBody","strength","linkForce","forceLink","distance","collideForce","forceCollide","forceX","forceY","forceSimulation","force","ticked","alpha","restart","toggle","linkedByIndex","index","neighboring","a","b","__data__","active","alphaTarget","fx","fy","canvasObjects","d3Element","newElements","find","ChartFactory","BarChart","scaleBand","padding","domainRange","barsGroup","bar","barEnter","bandwidth","_renderAxis","_renderLegend","LineChart","linesGroup","valueLine","line","lineEnter","ScatterChart","scatterGroup","scatter","scatterEnter","SvgToPng","MainMenu","aboutModal","menuId","saveSvgAsPng","AboutModal","version","syntaxHighlight","cls","test","out$","doctype","isElement","HTMLElement","SVGElement","requireDomNode","el","isExternal","url","lastIndexOf","location","host","inlineImages","images","querySelectorAll","checkDone","image","href","getAttributeNS","warn","document","createElement","ctx","getContext","img","Image","crossOrigin","getAttribute","src","onload","drawImage","setAttributeNS","toDataURL","onerror","styles","cssLoadedCallback","selectorRemap","modifyStyle","css","fontsQueue","sheets","styleSheets","rules","cssRules","j","rule","selectorText","err","querySelector","selector","cssText","fontUrlRegexp","fontUrlMatch","externalFontUrl","fontUrlIsDataURI","startsWith","format","getFontMimeTypeFromUrl","processFontQueue","fontUrl","supportedFormats","extensions","extension","indexOf","queue","font","pop","processNext","oReq","XMLHttpRequest","addEventListener","fontLoaded","transferFailed","open","responseType","send","fontBits","response","fontInBase64","arrayBufferToBase64","updateFontStyle","dataUrl","buffer","binary","bytes","Uint8Array","len","byteLength","String","fromCharCode","btoa","getDimension","clone","dim","v","viewBox","baseVal","parseInt","getComputedStyle","getPropertyValue","isNaN","parseFloat","reEncode","encodeURIComponent","p1","c","decodeURIComponent","prepareSvg","responsive","xmlns","outer","cloneNode","box","setAttribute","svg","createElementNS","appendChild","removeAttribute","join","fos","innerHTML","defs","insertBefore","firstChild","outHtml","svgAsDataUri","uri","svgAsPngUri","encoderType","encoderOptions","convertToPng","w","h","context","canvg","backgroundColor","globalCompositeOperation","fillStyle","fillRect","png","SecurityError","atob","download","navigator","msSaveOrOpenBlob","uriToBlob","saveLink","downloadSupported","display","body","blob","URL","createObjectURL","onclick","requestAnimationFrame","revokeObjectURL","removeChild","byteString","mimeString","ArrayBuffer","intArray","charCodeAt","Blob","saveSvg","define","Message","alertsId","messageEnter"],"mappings":"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","file":"francy.bundle.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1a0a434c577b2cfb12bb","import Base from './base';\n\n/* global d3 */\n\nexport default class Renderer extends Base {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    if (new.target === Renderer) {\n      throw new TypeError('Cannot construct [Renderer] instances directly!');\n    }\n    if (this.render === undefined || typeof this.render !== 'function') {\n      throw new TypeError('Must override [render()] method!');\n    }\n    if (this.unrender === undefined) {\n      this.logger.debug('No [unrender()] method specified...');\n    }\n    this.element = undefined;\n    this.transitionDuration = 750; //ms\n  }\n\n  get HTMLParent() {\n    return this.options.appendTo.element.node().tagName.toLowerCase() === 'svg' ? d3.select(this.options.appendTo.element.node().parentNode) : this.options.appendTo.element;\n  }\n\n  get SVGParent() {\n    return this.options.appendTo.element.node().tagName.toLowerCase() === 'div' ? this.options.appendTo.element.select('svg') : this.options.appendTo.element;\n  }\n  \n  get parent() {\n    return this.options.appendTo.element;\n  }\n  \n  get margin() {\n    return { top: 50, right: 50, bottom: 50, left: 50 };\n  }\n  \n  get width() {\n    let width = +this.parent.attr('width') || d3.select('body').node().getBoundingClientRect().width;\n    return width - this.margin.left - this.margin.right;\n  }\n  \n  get height() {\n    let height = +this.parent.attr('height') || d3.select('body').node().getBoundingClientRect().height;\n    return height - this.margin.top - this.margin.bottom;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/renderer.js","export function requires(props) {\n  return function decorator(target, name, descriptor) {\n    var oldValue = descriptor.value;\n\n    descriptor.value = function() {\n      if (!hasData(getProperty(this.data, props))) {\n        this.logger.debug(`No data here [${props}], nothing to render... continuing...`);\n        return;\n      }\n      return oldValue.apply(this, arguments);\n    };\n\n    return descriptor;\n  };\n}\n\nfunction getProperty(obj, propertyPath) {\n\n  var tmp = obj;\n\n  if (tmp && propertyPath) {\n    var properties = propertyPath.split('.');\n\n    for (var property of properties) {\n      if (!tmp.hasOwnProperty(property)) {\n        tmp = undefined;\n        break;\n      }\n      else {\n        tmp = tmp[property];\n      }\n    }\n  }\n\n  return tmp;\n}\n\nfunction hasData(obj) {\n  return obj && ((obj instanceof Array && obj.length) || (obj instanceof Object && Object.values(obj).length));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/data-decorator.js","import Logger from './logger';\n\n/* global Jupyter, MathJax, d3 */\n\nexport function RegisterMathJax(element) {\n  if (!element) return;\n  setTimeout(() => {\n    try {\n      MathJax.Hub.Config({\n        tex2jax: {\n          jax: ['input/TeX', 'output/SVG'],\n          inlineMath: [\n            ['$', '$'],\n            ['\\\\(', '\\\\)']\n          ],\n          displayMath: [\n            ['$$', '$$'],\n            ['\\\\[', '\\\\]']\n          ],\n          processEscapes: true\n        }\n      });\n\n      MathJax.Hub.Register.StartupHook('End', function() {\n        setTimeout(() => {\n          element.selectAll('.francy-label').each(function() {\n            var self = d3.select(this),\n              mathJax = self.select('text>span>svg');\n            if (mathJax.node()) {\n              setTimeout(() => {\n                mathJax.attr('x', self.attr('x'));\n                mathJax.attr('y', -15);\n                d3.select(self.node().parentNode).append(function() {\n                  return mathJax.node();\n                });\n                self.selectAll('*').remove();\n              }, 10);\n            }\n          });\n        }, 250);\n      });\n\n      MathJax.Hub.Queue(['Typeset', MathJax.Hub, element.node()]);\n\n      MathJax.Hub.Configured();\n    }\n    catch (e) {\n      if (e.name === 'ReferenceError') {\n        new Logger().info('It seems MathJax is not loaded...', e);\n      }\n    }\n\n  }, 10);\n}\n\nexport function RegisterJupyterKeyboardEvents(classes) {\n  // disable keyboard shortcuts in Jupyter for classes\n  if (!classes) return;\n  try {\n    classes.map((cl) => {\n      Jupyter.keyboard_manager.register_events(cl);\n    });\n  }\n  catch (e) {\n    if (e.name === 'ReferenceError') {\n      new Logger().info('It seems we\\'re not running on Jupyter...', e);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/component.js","import Renderer from './renderer';\nimport Tooltip from './tooltip';\n\n/* global d3 */\n\nexport default class Chart extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.axis = undefined;\n    this.yScale = undefined;\n    this.xScale = undefined;\n    this.datasets = undefined;\n    this.datasetNames = undefined;\n    this.tooltip = undefined;\n  }\n  \n  _initialize() {\n    this.tooltip = new Tooltip(this.options);\n    \n    this.element = this.parent.select('g.francy-content');\n    \n    this.axis = this.data.canvas.chart.axis;\n    this.datasets = this.data.canvas.chart.data;\n    this.datasetNames = Object.keys(this.datasets);\n\n    this.xScale = d3.scaleLinear().range([0, this.width]).domain(this.axis.x.domain);\n    this.yScale = d3.scaleLinear().range([this.height, 0]).domain(this.axis.y.domain);\n    \n    this.allValues = [];\n    this.datasetNames.forEach(key => this.allValues = this.allValues.concat(this.datasets[key]));\n\n    if (!this.axis.y.domain.length) {\n      this.yScale.domain([0, d3.max(this.allValues, d => d)]);\n    }\n\n    if (!this.axis.x.domain.length) {\n      this.xScale.domain([0, this.allValues.length / this.datasetNames.length]);\n    }\n  }\n  \n  _renderAxis() {\n    // force rebuild axis again\n    let xAxisGroup = this.element.selectAll('g.francy-x-axis');\n\n    if (!xAxisGroup.node()) {\n      xAxisGroup = this.element.append('g').attr('class', 'francy-x-axis');\n    }\n\n    xAxisGroup.selectAll('*').remove();\n\n    // add the x Axis\n    xAxisGroup\n      .attr('transform', `translate(0,${this.height})`)\n      .call(d3.axisBottom(this.xScale))\n      .append('text')\n      .attr('dy', 50)\n      .attr('dx', this.width / 2)\n      .attr('fill', 'black')\n      .attr('class', 'francy-axis')\n      .style('text-anchor', 'end')\n      .text(this.axis.x.title);\n\n    // force rebuild axis again\n    let yAxisGroup = this.element.selectAll('g.francy-y-axis');\n\n    if (!yAxisGroup.node()) {\n      yAxisGroup = this.element.append('g').attr('class', 'francy-y-axis');\n    }\n\n    yAxisGroup.selectAll('*').remove();\n\n    // add the y Axis\n    yAxisGroup\n      .call(d3.axisLeft(this.yScale))\n      .append('text')\n      .attr('dx', -50)\n      .attr('dy', this.height / 2)\n      .attr('fill', 'black')\n      .attr('class', 'francy-axis')\n      .style('text-anchor', 'end')\n      .text(this.axis.y.title);\n  }\n  \n  _renderLegend() {\n    if (this.data.canvas.chart.showLegend) {\n\n      let legendGroup = this.element.selectAll('.francy-legend');\n\n      if (!legendGroup.node()) {\n        legendGroup = this.element.append('g').attr('class', 'francy-legend');\n      }\n\n      // force rebuild legend again\n      legendGroup.selectAll('*').remove();\n\n      let legend = legendGroup.selectAll('g').data(this.datasetNames.slice());\n\n      legend.exit().remove();\n\n      legend = legend.enter()\n        .append('g')\n        .attr('transform', (d, i) => `translate(0,${i * 20})`)\n        .merge(legend);\n\n      legend.append('rect')\n        .attr('x', this.width + 20)\n        .attr('width', 19)\n        .attr('height', 19)\n        .style('fill', (d, i) => Chart.colors(i * 5));\n\n      legend.append('text')\n        .attr('x', this.width + 80)\n        .attr('y', 9)\n        .attr('dy', '.35em')\n        .style('text-anchor', 'end')\n        .text(d => d);\n    }\n  }\n\n  static tooltip(dataset, value) {\n    return { 'A': { 'title': 'Dataset', 'text': dataset }, 'B': { 'title': 'Value', 'text': value } };\n  }\n\n  static get colors() {\n    return d3.scaleSequential().domain([0, 100]).interpolator(d3.interpolateRainbow);\n  }\n\n  static domainRange(max) {\n    return Array.from(new Array(max), (_, i) => i).map(x => x);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart.js","import Renderer from './renderer';\n\nexport default class Composite extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    if (new.target === Composite) {\n      throw new TypeError('Cannot construct [Composite] instances directly!');\n    }\n    this.renderers = [];\n  }\n\n  add(renderer) {\n    this.renderers.push(renderer);\n    return this;\n  }\n\n  renderChildren() {\n    // update children rendering with a new parent!\n    let options = this.options;\n    options.appendTo = this;\n    // render other components\n    for (let renderer of this.renderers) {\n      renderer.settings(options).load(this.data).render();\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/composite.js","import Logger from '../util/logger';\nimport JsonUtils from '../util/json-utils';\n\nexport default class Base {\n\n  constructor({ verbose = false, appendTo = 'body', callbackHandler }) {\n    this.settings({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    /**\n     * @type {Logger} the logger for this class\n     */\n    this.log = new Logger(this.options);\n  }\n\n  settings({ verbose, appendTo, callbackHandler }) {\n    this.options = this.options || {};\n    if (!this.options.callbackHandler && !callbackHandler) {\n      throw new Error('A Callback Handler must be provided! This will be used to trigger events from the graphics produced...');\n    }\n    if (!this.options.appendTo && !appendTo) {\n      throw new Error('Missing an element or id to append the graphics to...!');\n    }\n    /**\n     * @typedef {Object} Options\n     * @property {Boolean} verbose prints extra log information to console.log, default false\n     * @property {Boolean} appendTo where the generated html/svg components will be attached to, default body\n     * @property {Function} callbackHandler this handler will be used to invoke actions from the menu, default console.log\n     */\n    this.options.verbose = verbose || this.options.verbose;\n    this.options.appendTo = appendTo || this.options.appendTo;\n    this.options.callbackHandler = callbackHandler || this.options.callbackHandler;\n    return this;\n  }\n\n  load(json, partial) {\n    let data = JsonUtils.parse(json, partial);\n    if (data) {\n      this.data = data;\n    }\n    return this;\n  }\n\n  get logger() {\n    return this.log;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/base.js","/**\n * This class provides a logger for the Francy application.\n */\nexport default class Logger {\n\n  /**\n   * Logger constructor\n   * @param verbose prints extra log information to console.log, defaults to false\n   */\n  constructor({ verbose = false } = {}) {\n    this.verbose = verbose;\n    this.console = console;\n  }\n\n  /**\n   * Creates a [DEBUG] entry in the console log\n   * @param message the message to print\n   */\n  debug(message) {\n    if (this.verbose) {\n      this.console.debug(Logger._format('DEBUG', message));\n    }\n  }\n\n  /**\n   * Creates a [INFO] entry in the console log\n   * @param message the message to print\n   */\n  info(message) {\n    this.console.info(Logger._format('INFO', message));\n  }\n\n  /**\n   * Creates a [ERROR] entry in the console log\n   * @param message the message to print\n   * @param error the error Object to attach to the message\n   */\n  error(message, error) {\n    this.console.error(Logger._format('ERROR', message), error);\n  }\n\n  /**\n   * Creates a [WARN] entry in the console log\n   * @param message the message to print\n   * @param error the error Object to attach to the message\n   */\n  warn(message, error) {\n    error = error || {};\n    this.console.error(Logger._format('WARN', message), error);\n  }\n\n  /**\n   * This is a private method that formats all log messages\n   * @param level the log level\n   * @param message the message to print\n   */\n  static _format(level, message) {\n    return `[${level}] - ${new Date().toISOString()} - ${message}`;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/logger.js","import Renderer from './renderer';\nimport ContextMenu from './menu-context';\nimport Tooltip from './tooltip';\nimport Callback from './callback';\n\n/* global d3 */\n\nexport default class Graph extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n  \n  _initialize() {\n    this.element = this.parent.select('g.francy-content');\n  }\n\n  _applyEvents(element) {\n    if (!element) return;\n\n    let tooltip = new Tooltip(this.options);\n    let contextMenu = new ContextMenu(this.options);\n    let callback = new Callback(this.options);\n\n    element\n      .on('contextmenu', function(d) {\n        d = d.data || d;\n        // default, build context menu\n        contextMenu.load(d, true).render();\n        // any callbacks will be handled here\n        executeCallback.call(this, d, 'contextmenu');\n      })\n      .on('click', function(d) {\n        d = d.data || d;\n        // any callbacks will be handled here\n        executeCallback.call(this, d, 'click');\n      })\n      .on('dblclick', function(d) {\n        d = d.data || d;\n        // any callbacks will be handled here\n        executeCallback.call(this, d, 'dblclick');\n      })\n      .on('mouseenter', d => {\n        d = d.data || d;\n        // default, show tooltip\n        tooltip.load(d.messages, true).render();\n      })\n      .on('mouseleave', () => {\n        // default, hide tooltip\n        tooltip.unrender();\n      });\n\n    function executeCallback(data, event) {\n      if (data.callbacks) {\n        Object.values(data.callbacks).forEach((cb) => {\n          // execute the ones that match the event!\n          cb.trigger === event && callback.load({ callback: cb }, true).execute();\n        });\n      }\n    }\n  }\n\n  static get colors() {\n    return d3.scaleSequential().domain([0, 100]).interpolator(d3.interpolateRainbow);\n  }\n\n  static getSymbol(type) {\n    \n    let element = undefined;\n    switch (type) {\n    case 'cross':\n      element = d3.symbolCross;\n      break;\n    case 'diamond':\n      element = d3.symbolDiamond;\n      break;\n    case 'square':\n      element = d3.symbolSquare;\n      break;\n    case 'triangle':\n      element = d3.symbolTriangle;\n      break;\n    case 'star':\n      element = d3.symbolStar;\n      break;\n    case 'wye':\n      element = d3.symbolWye;\n      break;\n    case 'circle':\n    default:\n      element = d3.symbolCircle;\n    }\n\n    return element;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/graph.js","import Renderer from './renderer';\nimport Callback from './callback';\n\nexport default class Menu extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  traverse(appendTo, menusIterator) {\n    while (menusIterator.hasNext()) {\n      let menuItem = menusIterator.next();\n      let entry = appendTo.append('li');\n      let action = entry.selectAll('a').data([menuItem]).enter().append('a').attr('title', menuItem.title).html(menuItem.title);\n      if (menuItem.callback && Object.values(menuItem.callback).length) {\n        action.on('click', (d) => new Callback(this.options).load(d, true).execute());\n      }\n      if (menuItem.menus && Object.values(menuItem.menus).length > 0) {\n        let content = entry.append('ul');\n        let subMenusIterator = this.iterator(Object.values(menuItem.menus));\n        this.traverse(content, subMenusIterator);\n      }\n    }\n  }\n\n  iterator(array) {\n    let nextIndex = 0;\n    return {\n      next: function() {\n        return this.hasNext() ? array[nextIndex++] : undefined;\n      },\n      hasNext: function() {\n        return nextIndex < array.length;\n      }\n    };\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/menu.js","import Base from './base';\nimport RequiredArgsModal from './modal-required';\nimport { requires } from '../util/data-decorator';\n\nexport default class CallbackHandler extends Base {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.callback = callbackHandler;\n  }\n\n  @requires('callback')\n  execute() {\n    if (Object.keys(this.data.callback.requiredArgs).length) {\n      let options = this.options;\n      options.callbackHandler = (callbackObj) => this._execute.call(this, callbackObj);\n      return new RequiredArgsModal(options).load(this.data, true).render();\n    }\n    \n    // Trigger is the expected command on GAP for this events!\n    this._execute(this.data.callback);\n    \n  }\n\n  _execute(calbackObj) {\n    this.callback(`Trigger(${JSON.stringify(JSON.stringify(calbackObj))});`);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/callback.js","import Renderer from './renderer';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class Tooltip extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires()\n  render() {\n\n    this.element = this.HTMLParent.select('div.francy-tooltip-holder');\n    // check if the window is already present\n    if (!this.element.node()) {\n      this.element = this.HTMLParent.append('div')\n        .attr('class', 'francy-tooltip-holder');\n    }\n\n    // check if it exists already\n    if (this.element.selectAll('*').node()) {\n      return;\n    }\n\n    let pos = d3.mouse(this.SVGParent.node());\n\n    // TODO fix always visible tooltip, fine until someone complains about :P\n    this.element.style('left', (pos[0] + 5) + 'px').style('top', (pos[1] - 5) + 'px');\n\n    let table = this.element.append('div').attr('class', 'francy-tooltip')\n      .append('div').attr('class', 'francy-table')\n      .append('div').attr('class', 'francy-table-body');\n    let self = this;\n    Object.keys(this.data).map(function(key) {\n      let row = table.append('div').attr('class', 'francy-table-row');\n      row.append('div').attr('class', 'francy-table-cell').text(self.data[key].title);\n      row.append('div').attr('class', 'francy-table-cell').text(self.data[key].text);\n    });\n\n    // show tooltip\n    this.element.style('display', 'block');\n\n    return this;\n  }\n\n  unrender() {\n    if (this.element) {\n      this.element.selectAll('*').remove();\n      this.element.style('display', null);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/tooltip.js","import Frame from './render/frame';\nimport Renderer from './render/renderer';\nimport { requires } from './util/data-decorator';\n\n/* global d3 */\n\nlet ALL_CANVAS = {};\n\n/**\n * Francy is the main entry point for the whole framework. By passing an input string/object to the {Francy.load} function,\n * Francy will handle the creation of that json as long it is a valid and understandable json object to Francy.\n *  \n * @access public\n * \n * @version 0.5.0\n * \n * @example\n * let francy = new Francy({verbose: true, appendTo: '#div-id', callbackHandler: console.log});\n * francy.load(json).render();\n */\nexport default class Francy extends Renderer {\n\n  /**\n   * Creates an instance of Francy with the following options:\n   * @typedef {Object} Options\n   * @property {Boolean} verbose prints extra log information to console.log, default false\n   * @property {Boolean} appendTo where the generated html/svg components will be attached to, default body\n   * @property {Function} callbackHandler this handler will be used to invoke actions from the menu, default console.log\n   */\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    if (!d3) {\n      throw new Error('D3 is not imported! Francy won\\'t work without it... please import D3 v4+.');\n    }\n  }\n\n  /**\n   * Main entry point. Calling render passing a json representation string will \n   * trigger the drawing of a json object.\n   * @returns {Object} the html element created\n   */\n  @requires('canvas')\n  render() {\n    let frame = new Frame(this.options).load(this.data).render();\n    ALL_CANVAS[this.data.canvas.id] = frame;\n    return frame.element.node();\n  }\n\n  static unrender(id) {\n    delete ALL_CANVAS[id];\n  }\n}\n\ntry {\n  exports.Francy = window.Francy = Francy;\n  // handle events on resize\n  let oldResize = window.onresize;\n  window.onresize = function() {\n    // zoom to fit all canvas on resize\n    Object.values(ALL_CANVAS).forEach(function(frame) {\n      frame.canvas.zoomToFit();\n    });\n    // call old resize function if any!\n    if (typeof oldResize === 'function') {\n      oldResize();\n    }\n  };\n}\ncatch (e) {\n  exports.Francy = Francy;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/francy.js","import Composite from './composite';\nimport Canvas from './canvas';\nimport MainMenu from './menu-main';\nimport Message from './message';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class Frame extends Composite {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.canvas = new Canvas(this.options);\n    this.menu = new MainMenu(this.options);\n    this.messages = new Message(this.options);\n    this.add(this.messages).add(this.menu).add(this.canvas);\n  }\n\n  @requires('canvas')\n  render() {\n    let parent = d3.select(this.options.appendTo);\n\n    const frameId = `Frame-${this.data.canvas.id}`;\n    this.element = d3.select(`div#${frameId}`);\n    // check if the canvas is already present\n    if (!this.element.node()) {\n      // create a svg element detached from the DOM!\n      this.logger.debug(`Creating Frame [${frameId}]...`);\n      this.element = parent.append('div').attr('class', 'francy').attr('id', frameId);\n    }\n\n    // cannot continue if canvas is not present\n    if (!this.element.node()) {\n      throw new Error(`Oops, could not create frame with id [${frameId}]... Cannot proceed.`);\n    }\n\n    this.logger.debug(`Frame updated [${frameId}]...`);\n\n    this.renderChildren();\n\n    return this;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/frame.js","/**\n * This class contains methods to deal with JSON.\n */\nexport default class JsonUtils {\n\n  /**\n   * Parses an input nd checks whether this input is valid and returns a JSON object.\n   * @param input - the input to parse\n   * @param partial - if the input is not a complete Francy JSON Object, defaults to false\n   * @returns {json} - if the input is a valid JSON object, otherwise returns {undefined}\n   */\n  static parse(input, partial = false) {\n    if (!input) return;\n    input = typeof input !== 'string' ? JSON.stringify(input) : input;\n    input = input.replace(/[\\n\\r\\b\\\\]+|(gap>)/g, '');\n    let jsonRegex = /{(?:[^])*}/g;\n    let match = jsonRegex.exec(input);\n    if (match) {\n      input = match[0];\n      try {\n        let json = JSON.parse(input);\n        return json.mime === JsonUtils.MIME || partial ? json : undefined;\n      }\n      catch (e) {\n        /* eslint-disable no-console */\n        console.error(e);\n        /* eslint-enable no-console */\n      }\n    }\n  }\n\n  /**\n   * Returns a static string representing the mime type supported by this package\n   */\n  static get MIME() {\n    return 'application/vnd.francy+json';\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/json-utils.js","import Composite from './composite';\nimport GraphFactory from './graph-factory';\nimport ChartFactory from './chart-factory';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class Canvas extends Composite {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.graph = new GraphFactory(this.options);\n    this.chartFactory = new ChartFactory(this.options);\n    this.add(this.graph).add(this.chartFactory);\n  }\n\n  @requires('canvas')\n  render() {\n    let content;\n    let zoom = d3.zoom();\n    let self = this;\n\n    function updateZoom(translateX, translateY, scale) {\n      self.element.call(zoom.transform, d3.zoomIdentity.translate(translateX, translateY).scale(scale, scale));\n    }\n\n    function zoomed() {\n      content.attr('transform', d3.event.transform);\n    }\n\n    function stopped() {\n      if (d3.event.defaultPrevented) { d3.event.stopPropagation(); }\n    }\n\n    function zoomToFit() {\n      // only execute if enable, of course\n      if (self.data.canvas.zoomToFit) {\n        let bounds = content.node().getBBox();\n\n        let clientBounds = self.element.node().getBoundingClientRect(),\n          fullWidth = clientBounds.right - clientBounds.left,\n          fullHeight = clientBounds.bottom - clientBounds.top;\n\n        let width = +bounds.width,\n          height = +bounds.height;\n\n        if (width === 0 || height === 0) return;\n\n        let midX = bounds.x + width / 2,\n          midY = bounds.y + height / 2;\n\n        let scale = 0.9 / Math.max(width / fullWidth, height / fullHeight);\n        let translateX = fullWidth / 2 - scale * midX,\n          translateY = fullHeight / 2 - scale * midY;\n\n        content.transition()\n          .duration(self.transitionDuration)\n          .attr('transform', `translate(${translateX},${translateY})scale(${scale},${scale})`)\n          .on('end', () => updateZoom(translateX, translateY, scale));\n      }\n    }\n\n    const canvasId = `Canvas-${this.data.canvas.id}`;\n    this.element = d3.select(`svg#${canvasId}`);\n    // check if the canvas is already present\n    if (!this.element.node()) {\n      // create a svg element detached from the DOM!\n      this.logger.debug(`Creating Canvas [${canvasId}]...`);\n      this.element = this.parent.append('svg')\n        .attr('class', 'francy-canvas')\n        .attr('id', canvasId);\n    }\n\n    // cannot continue if canvas is not present\n    if (!this.element.node()) {\n      throw new Error(`Oops, could not create canvas with id [${canvasId}]... Cannot proceed.`);\n    }\n\n    this.element.attr('width', this.data.canvas.width).attr('height', this.data.canvas.height);\n\n    content = this.element.select('g.francy-content');\n\n    if (!content.node()) {\n      content = this.element.append('g').attr('class', 'francy-content');\n      zoom.on('zoom', zoomed);\n      // remove zoom on double click!\n      this.element.call(zoom).on('dblclick.zoom', null);\n    }\n\n    this.element.on('click', stopped, true);\n\n    this.element.zoomToFit = this.zoomToFit = zoomToFit;\n\n    this.logger.debug(`Canvas updated [${canvasId}]...`);\n\n    this.renderChildren();\n\n    setTimeout(() => {\n      zoomToFit();\n    }, this.transitionDuration);\n\n    return this;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/canvas.js","import Renderer from './renderer';\nimport TreeGraph from './graph-tree';\nimport GenericGraph from './graph-generic';\nimport { requires } from '../util/data-decorator';\n\nexport default class Graph extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires('canvas.graph')\n  render() {\n\n    let element = undefined;\n    switch (this.data.canvas.graph.type) {\n    case 'tree':\n      element = new TreeGraph(this.options).load(this.data).render();\n      break;\n    default:\n      element = new GenericGraph(this.options).load(this.data).render();\n    }\n\n    return element;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/graph-factory.js","import Graph from './graph';\nimport { RegisterMathJax } from '../util/component';\n\n/* global d3 */\n\nexport default class TreeGraph extends Graph {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  render() {\n    \n    this._initialize();\n\n    let i = 0,\n      root;\n\n    root = d3.hierarchy(this.treeData, d => d.children);\n    root.x0 = this.height / 2;\n    root.y0 = 0;\n\n    // compute height based on the depth of the graph\n    let levelWidth = [1];\n    let childCount = function (level, n) {\n\n      if (n.children && n.children.length > 0) {\n        if (levelWidth.length <= level + 1) levelWidth.push(0);\n\n        levelWidth[level + 1] += n.children.length;\n        n.children.forEach(function (d) {\n          childCount(level + 1, d);\n        });\n      }\n    };\n    childCount(0, root);\n    let newHeight = d3.max(levelWidth) * 100;\n\n    let treemap = d3.tree().size([newHeight, this.width]);\n\n    if (this.data.canvas.graph.collapsed) {\n      root.children.forEach(collapse);\n    }\n\n    update.call(this, root);\n\n    function collapse(d) {\n      if (d.children) {\n        d._children = d.children;\n        d._children.forEach(collapse);\n        d.children = null;\n      }\n    }\n\n    function update(source) {\n      let treeData = treemap(root);\n\n      let nodes = treeData.descendants(),\n        links = treeData.descendants().slice(1);\n\n      nodes.forEach(d => d.y = d.depth * 180);\n\n      let linkGroup = this.element.selectAll('g.francy-links');\n\n      if (!linkGroup.node()) {\n        linkGroup = this.element.append('g').attr('class', 'francy-links');\n      }\n\n      let link = linkGroup.selectAll('path.francy-edge')\n        .data(links, d => d.id || (d.id = ++i));\n\n      let linkEnter = link.enter()\n        .append('path').attr('class', 'francy-edge')\n        .attr('d', () => {\n          let o = {x: source.x0, y: source.y0};\n          return diagonal(o, o);\n        });\n\n      linkEnter.merge(link)\n        .transition().duration(this.transitionDuration).attr('d', d => diagonal(d, d.parent));\n\n      link.exit().transition().duration(this.transitionDuration)\n        .attr('d', () => {\n          let o = {x: source.x, y: source.y};\n          return diagonal(o, o);\n        }).remove();\n\n      linkGroup.selectAll('path.francy-edge')\n        .style('fill', 'none')\n        .style('stroke', '#ccc')\n        .style('stroke-width', '1px');\n\n      nodes.forEach((d) => {\n        d.x0 = d.x;\n        d.y0 = d.y;\n      });\n\n      function diagonal(s, d) {\n        return `M ${s.y} ${s.x}\n            C ${(s.y + d.y) / 2} ${s.x},\n              ${(s.y + d.y) / 2} ${d.x},\n              ${d.y} ${d.x}`;\n      }\n\n      let nodeGroup = this.element.selectAll('g.francy-nodes');\n\n      if (!nodeGroup.node()) {\n        nodeGroup = this.element.append('g').attr('class', 'francy-nodes');\n      }\n\n      let node = nodeGroup.selectAll('g.francy-node')\n        .data(nodes, d => d.id || (d.id = ++i));\n\n      let nodeEnter = node.enter().append('g')\n        .attr('class', 'francy-node')\n        .attr('transform', () => `translate(${source.y0},${source.x0})`);\n\n      nodeEnter.append('path')\n        .attr('d', d3.symbol().type(d => Graph.getSymbol(d.data.type)).size(d => d.data.size * 100))\n        .attr('class', 'francy-symbol');\n\n      nodeEnter.append('text')\n        .attr('class', 'francy-label')\n        .attr('x', d => -(d.data.title.length * 2.5))\n        .style('cursor', d => d.children || d._children ? 'pointer' : 'default')\n        .text(d => d.data.title);\n\n      let nodeUpdate = nodeEnter.merge(node);\n\n      nodeUpdate.transition()\n        .duration(this.transitionDuration)\n        .attr('transform', d => `translate(${d.y},${d.x})`);\n\n      node.exit().transition().duration(this.transitionDuration)\n        .attr('transform', () => `translate(${source.y},${source.x})`)\n        .remove();\n\n      nodeGroup.selectAll('path.francy-symbol')\n        .style('fill', d => d.children || d._children ? 'lightsteelblue' : Graph.colors(d.data.layer * 5))\n        .style('cursor', d => d.children || d._children ? 'pointer' : 'default');\n\n      node = nodeGroup.selectAll('g.francy-node');\n      \n      if (node.node()) {\n        this._applyEvents(node);\n\n        let nodeOnClick = node.on('click');\n        node.on('click', (d) => {\n        // any callbacks will be handled here\n          nodeOnClick.call(this, d.data);\n          // default, highlight connected nodes\n          click.call(this, d);\n        });\n      }\n\n      // Toggle children on click.\n      let self = this;\n\n      function click(d) {\n        if (d.children) {\n          d._children = d.children;\n          d.children = null;\n        }\n        else {\n          d.children = d._children;\n          d._children = null;\n        }\n        update.call(self, d);\n      }\n\n      RegisterMathJax(this.SVGParent);\n\n      setTimeout(() => {\n        this.parent.zoomToFit();\n      }, this.transitionDuration);\n    }\n\n    return this;\n\n  }\n\n  unrender() {}\n\n  /**\n   * Transforms flat data into tree data by analysing the parents of each node\n   * @returns {Object} the data transformed in tree data\n   */\n  get treeData() {\n    let canvasNodes = this.data.canvas.graph.nodes ? Object.values(this.data.canvas.graph.nodes) : [];\n    let dataMap = canvasNodes.reduce(function (map, node) {\n      map[node.id] = node;\n      return map;\n    }, {});\n    let treeData = [];\n    canvasNodes.forEach(function(node) {\n      let parent = dataMap[node.parent];\n      if (parent) {\n        (parent.children || (parent.children = [])).push(node);\n      }\n      else {\n        treeData.push(node);\n      }\n    });\n    return treeData[0];\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/graph-tree.js","import Menu from './menu';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class ContextMenu extends Menu {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires('menus')\n  render() {\n\n    d3.event.preventDefault();\n\n    this.element = this.HTMLParent.select('div.francy-context-menu-holder');\n    // check if the window is already present\n    if (!this.element.node()) {\n      this.element = this.HTMLParent.append('div')\n        .attr('class', 'francy-context-menu-holder');\n    }\n\n    let pos = d3.mouse(this.SVGParent.node());\n\n    this.element.style('left', pos[0] + 5 + 'px').style('top', pos[1] + 5 + 'px');\n\n    // show the context menu\n    this.element.style('display', 'block');\n\n    // check if it exists already\n    if (this.element.selectAll('*').node()) {\n      return;\n    }\n\n    // destroy menu\n    d3.select('body').on('click.francy-context-menu', () => this.unrender());\n\n    // this gets executed when a contextmenu event occurs\n    let menu = this.element.append('div').attr('class', 'francy-context-menu').append('ul');\n    let menusIterator = this.iterator(Object.values(this.data.menus));\n    this.traverse(menu, menusIterator);\n\n    return this;\n  }\n\n  unrender() {\n    if (this.element) {\n      this.element.selectAll('*').remove();\n      this.element.style('display', null);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/menu-context.js","import Renderer from './renderer';\nimport { RegisterJupyterKeyboardEvents } from '../util/component';\n\n/* global d3 */\n\nexport default class RequiredArgsModal extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  render() {\n    let self = this;\n\n    let modalId = this.data.callback.id;\n\n    this.logger.debug(`Creating Callback Modal [${modalId}]...`);\n\n    // we want to overlay everything, hence 'body' must be used\n    let overlay = d3.select('body').append('div')\n      .attr('class', 'francy-overlay');\n    let holder = d3.select('body').append('div')\n      .attr('class', 'francy');\n    this.element = holder.append('div')\n      .attr('id', modalId)\n      .attr('class', 'francy-modal');\n\n    let form = this.element.append('form');\n\n    let header = form.append('div').attr('class', 'francy-modal-header');\n\n    let headerTitle = header.append('span').html('Required arguments&nbsp;');\n    if (this.data.title) {\n      headerTitle.append('span').attr('style', 'font-weight: bold;').text(`for ${this.data.title}`);\n    }\n\n    let content = form.append('div').attr('class', 'francy-modal-content').append('div').attr('class', 'francy-table').append('div').attr('class', 'francy-table-body');\n\n    for (let arg of Object.values(this.data.callback.requiredArgs)) {\n      let row = content.append('div').attr('class', 'francy-table-row');\n      row.append('div').attr('class', 'francy-table-cell').append('label').attr('for', arg.id).text(arg.title);\n      let input = row.append('div').attr('class', 'francy-table-cell').append('input').attr('id', arg.id).attr('class', 'francy-arg')\n        .attr('required', '')\n        .attr('name', arg.id)\n        .attr('type', arg.type)\n        .attr('value', arg.value)\n        .on('change', function () {\n          self.data.callback.requiredArgs[this.id].value = this.value;\n        })\n        .on('input', this.onchange)\n        .on('keyup', this.onchange)\n        .on('paste', this.onchange);\n      // wait, if it is boolean we create a checkbox\n      if (arg.type === 'boolean') {\n        // well, a checkbox works this way so we need to initialize \n        // the value to false and update the value based on the checked \n        // property that triggers the onchange event\n        arg.value = arg.value || false;\n        input.attr('type', 'checkbox').attr('required', null)\n          .attr('value', arg.value)\n          .on('change', function() { self.data.callback.requiredArgs[this.id].value = this.value = this.checked; });\n      }\n      row.append('span').attr('class', 'validity');\n    }\n\n    let footer = form.append('div').attr('class', 'francy-modal-footer');\n\n    footer.append('button').text('Ok').on('click', function() {\n      if (form.node().checkValidity()) {\n        d3.event.preventDefault();\n        self.options.callbackHandler(self.data.callback);\n        overlay.remove();\n        self.element.remove();\n        holder.remove();\n      }\n      return false;\n    });\n    footer.append('button').text('Cancel').on('click', () => {\n      overlay.remove();\n      self.element.remove();\n      holder.remove();\n      d3.event.preventDefault();\n      return false;\n    });\n\n    // disable keyboard shortcuts when using this modal in Jupyter\n    RegisterJupyterKeyboardEvents(['.francy', '.francy-arg', '.francy-overlay', '.francy-modal']);\n\n    let inputElement = content.selectAll('.francy-arg').node();\n    if (inputElement) {\n      inputElement.focus();\n    }\n\n    this.logger.debug(`Callback Modal updated [${modalId}]...`);\n\n    return this;\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/modal-required.js","import Graph from './graph';\nimport { RegisterMathJax } from '../util/component';\n\n/* global d3 */\n\nexport default class GenericGraph extends Graph {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  render() {\n    var self = this;\n    this._initialize();\n    \n    let simulationActive = this.data.canvas.graph.simulation;\n\n    let canvasNodes = this.data.canvas.graph.nodes ? Object.values(this.data.canvas.graph.nodes) : [],\n      canvasLinks = this.data.canvas.graph.links ? Object.values(this.data.canvas.graph.links) : [];\n\n    let linkGroup = this.element.selectAll('g.francy-links');\n\n    if (!linkGroup.node()) {\n      linkGroup = this.element.append('g').attr('class', 'francy-links');\n    }\n\n    let links = linkGroup.selectAll('g.francy-link').data();\n    let linksToAdd = this._filterNewElements(canvasLinks, links);\n\n    let link = linkGroup.selectAll('g.francy-link').data(linksToAdd, d => d.id);\n\n    let nodeGroup = this.element.selectAll('g.francy-nodes');\n\n    if (!nodeGroup.node()) {\n      nodeGroup = this.element.append('g').attr('class', 'francy-nodes');\n    }\n\n    let nodes = nodeGroup.selectAll('g.francy-node').data();\n    let nodesToAdd = this._filterNewElements(canvasNodes, nodes);\n\n    let node = nodeGroup.selectAll('g.francy-node').data(nodesToAdd, d => d.id);\n\n    if (node.exit().data().length === 0 &&\n      node.enter().data().length === 0 &&\n      link.enter().data().length === 0 &&\n      link.exit().data().length === 0) {\n      return;\n    }\n\n    let linkEnter = link.enter().append('g').attr('class', 'francy-link');\n\n    linkEnter.append('line').attr('class', 'francy-edge');\n\n    link.exit().remove();\n\n    link = linkGroup.selectAll('g.francy-link line.francy-edge');\n\n    if (this.data.canvas.graph.type === 'directed') {\n      // this means we need arrows, so we append the marker\n      self.parent.append('defs').selectAll('marker')\n        .data(['arrow'])\n        .enter().append('marker')\n        .attr('class', 'francy-arrows')\n        .attr('id', d => d)\n        .attr('viewBox', '0 -5 10 10')\n        .attr('refX', 25)\n        .attr('refY', 0)\n        .attr('markerWidth', 10)\n        .attr('markerHeight', 10)\n        .attr('orient', 'auto')\n        .append('path')\n        .attr('d', 'M0,-5L10,0L0,5 L10,0 L0, -5');\n      // update the style of the link\n      link.style('marker-end', 'url(#arrow)');\n    }\n\n    let nodeEnter = node.enter().append('g')\n      .attr('class', 'francy-node').attr('id', d => d.id);\n\n    nodeEnter.append('path')\n      .attr('d', d3.symbol().type(d => Graph.getSymbol(d.type)).size(d => d.size * 100))\n      .style('fill', d => Graph.colors(d.layer * 5))\n      .attr('class', d => 'francy-symbol' + (d.highlight ? ' francy-highlight' : '') + (Object.values(d.menus).length ? ' francy-context' : ''));\n\n    nodeEnter.append('text')\n      .attr('class', 'francy-label')\n      .attr('x', d => -(d.title.length * 2.5))\n      .text(d => d.title);\n\n    node.exit().remove();\n\n    node = nodeGroup.selectAll('g.francy-node');\n\n    if (this.data.canvas.graph.drag) {\n      node.call(d3.drag()\n        .on('start', dragstarted)\n        .on('drag', dragged)\n        .on('end', dragended));\n    }\n\n    if (node && !node.empty()) {\n\n      this._applyEvents(node);\n\n      if (this.data.canvas.graph.showNeighbours) {\n        let nodeOnClick = node.on('click');\n        node.on('click', function(d) {\n          // default, highlight connected nodes\n          connectedNodes.call(this);\n          // any callbacks will be handled here\n          nodeOnClick.call(this, d);\n        });\n      }\n    }\n\n    if (simulationActive) {\n      // Canvas Forces\n      let centerForce = d3.forceCenter().x(this.width / 2).y(this.height / 2);\n      let manyForce = d3.forceManyBody().strength(-canvasNodes.length * 50);\n      let linkForce = d3.forceLink(canvasLinks).id(d => d.id).distance(50);\n      let collideForce = d3.forceCollide(d => d.size * 2);\n\n      //Generic gravity for the X position\n      let forceX = d3.forceX(this.width / 2).strength(0.05);\n\n      //Generic gravity for the Y position - undirected/directed graphs fall here\n      let forceY = d3.forceY(this.height / 2).strength(0.25);\n\n      if (this.data.canvas.graph.type === 'hasse') {\n        //Generic gravity for the X position\n        forceX = d3.forceX(this.width / 2).strength(0.3);\n        //Strong y positioning based on layer to simulate the hasse diagram\n        forceY = d3.forceY(d => d.layer * 75).strength(0.7);\n      }\n\n      var simulation = d3.forceSimulation().nodes(nodesToAdd)\n        .force('charge', manyForce)\n        .force('link', linkForce)\n        .force('center', centerForce)\n        .force('x', forceX)\n        .force('y', forceY)\n        .force('collide', collideForce)\n        .on('tick', ticked)\n        .on('end', function() {\n          // zoom to fit when simulation is over\n          self.parent.zoomToFit();\n        });\n\n      //force simulation restart\n      simulation.alpha(0.5).restart();\n    }\n    else {\n      // well, simulation is off, apply fixed positions and zoom to fit now\n      ticked();\n      self.parent.zoomToFit();\n    }\n\n    function ticked() {\n      link\n        .attr('x1', d => d.source.x)\n        .attr('y1', d => d.source.y)\n        .attr('x2', d => d.target.x)\n        .attr('y2', d => d.target.y);\n\n      node.attr('transform', d => `translate(${d.x},${d.y})`);\n    }\n\n    // HIGHLIGHT\n    //Toggle stores whether the highlighting is on\n    let toggle = 0;\n    //Create an array logging what is connected to what\n    let linkedByIndex = {};\n\n    for (let i = 0; i < canvasNodes.length; i++) {\n      linkedByIndex[`${i},${i}`] = 1;\n    }\n\n    canvasLinks.forEach(function(d) {\n      linkedByIndex[`${d.source.index},${d.target.index}`] = 1;\n    });\n\n    function connectedNodes() {\n      //This function looks up whether a pair are neighbours\n      function neighboring(a, b) {\n        return linkedByIndex[`${a.index},${b.index}`];\n      }\n      d3.event.preventDefault();\n      if (toggle === 0) {\n        //Reduce the opacity of all but the neighbouring nodes\n        let d = d3.select(this).node().__data__;\n        node.style('opacity', o => neighboring(d, o) || neighboring(o, d) ? 1 : 0.1);\n        link.style('opacity', o => d.index === o.source.index || d.index === o.target.index ? 1 : 0.1);\n        //Reduce the op\n        toggle = 1;\n      }\n      else {\n        //Put them back to opacity=1\n        node.style('opacity', 1);\n        link.style('opacity', 1);\n        toggle = 0;\n      }\n    }\n\n    function dragstarted(d) {\n      if (!d3.event.active && simulationActive) {\n        simulation.alphaTarget(0.01).restart();\n      }\n      d.fx = d.x;\n      d.fy = d.y;\n    }\n\n    function dragged(d) {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    }\n\n    function dragended(d) {\n      if (!d3.event.active && simulationActive) {\n        simulation.alphaTarget(0);\n      }\n      d.fx = null;\n      d.fy = null;\n    }\n\n    RegisterMathJax(this.SVGParent);\n\n    return this;\n\n  }\n\n  unrender() {}\n  \n  _filterNewElements(canvasObjects, d3Element) {\n    let newElements = [];\n    canvasObjects.forEach(o => {\n      let link = d3Element.find(d => d.id === o.id);\n      if (link) {\n        newElements.push(link);\n      }\n      else {\n        newElements.push(o);\n      }\n    });\n    return newElements;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/graph-generic.js","import Renderer from './renderer';\nimport BarChart from './chart-bar';\nimport LineChart from './chart-line';\nimport ScatterChart from './chart-scatter';\nimport { requires } from '../util/data-decorator';\n\nexport default class ChartFactory extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires('canvas.chart')\n  render() {\n    \n    let element = undefined;\n    switch (this.data.canvas.chart.type) {\n    case 'bar':\n      element = new BarChart(this.options).load(this.data).render();\n      break;\n    case 'line':\n      element = new LineChart(this.options).load(this.data).render();\n      break;\n    case 'scatter':\n      element = new ScatterChart(this.options).load(this.data).render();\n      break;\n    }\n\n    return element;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart-factory.js","import Chart from './chart';\n\n/* global d3 */\n\nexport default class BarChart extends Chart {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  render() {\n\n    this._initialize();\n    \n    this.xScale = d3.scaleBand().range([0, this.width]).padding(0.1).domain(this.axis.x.domain);\n\n    if (!this.axis.x.domain.length) {\n      this.axis.x.domain = Chart.domainRange(this.allValues.length / this.datasetNames.length);\n      this.xScale.domain(this.axis.x.domain);\n    }\n\n    let barsGroup = this.element.selectAll('g.francy-bars');\n\n    if (!barsGroup.node()) {\n      barsGroup = this.element.append('g').attr('class', 'francy-bars');\n    }\n\n    var self = this;\n    \n    this.datasetNames.forEach(function(key, index) {\n      let bar = barsGroup.selectAll(`.francy-bar-${index}`).data(self.datasets[key]);\n\n      bar.exit().transition().duration(750)\n        .style('fill-opacity', 1e-6)\n        .remove();\n\n      // append the rectangles for the bar chart\n      let barEnter = bar.enter()\n        .append('rect')\n        .style('fill', () => Chart.colors(index * 5))\n        .attr('class', `francy-bar-${index}`)\n        .attr('x', function(d, i) {\n          return self.xScale(self.axis.x.domain[i]) + index * (self.xScale.bandwidth() / self.datasetNames.length);\n        })\n        .attr('width', (self.xScale.bandwidth() / self.datasetNames.length) - 1)\n        .attr('y', function(d) {\n          return self.yScale(d);\n        })\n        .attr('height', function(d) {\n          return self.height - self.yScale(d);\n        })\n        .on('mouseenter', function(d) {\n          d3.select(this).transition()\n            .duration(250).style('fill-opacity', 0.5);\n          self.tooltip.load(Chart.tooltip(key, d), true).render();\n        })\n        .on('mouseleave', function() {\n          d3.select(this).transition()\n            .duration(250).style('fill-opacity', 1);\n          self.tooltip.unrender();\n        });\n\n      barEnter.merge(bar)\n        .attr('x', function(d, i) { return self.xScale(self.axis.x.domain[i]) + index * (self.xScale.bandwidth() / self.datasetNames.length); })\n        .attr('width', (self.xScale.bandwidth() / self.datasetNames.length) - 1)\n        .attr('y', function(d) { return self.yScale(d); })\n        .attr('height', function(d) { return self.height - self.yScale(d); });\n    });\n\n    this._renderAxis();\n    this._renderLegend();\n\n    return this;\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart-bar.js","import Chart from './chart';\n\n/* global d3 */\n\nexport default class LineChart extends Chart {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  render() {\n    \n    this._initialize();\n    \n    let linesGroup = this.element.selectAll('g.francy-lines');\n\n    if (!linesGroup.node()) {\n      linesGroup = this.element.append('g').attr('class', 'francy-lines');\n    }\n\n    var self = this;\n    \n    this.datasetNames.forEach(function(key, index) {\n      let valueLine = d3.line()\n        .x(function(d, i) {\n          return self.xScale(i);\n        })\n        .y(function(d) {\n          return self.yScale(d);\n        });\n\n      let line = linesGroup.selectAll(`.francy-line-${index}`).data([self.datasets[key]]);\n\n      line.exit().transition().duration(750)\n        .style('fill-opacity', 1e-6)\n        .remove();\n\n      // append the rectangles for the bar chart\n      let lineEnter = line.enter()\n        .append('path')\n        .style('stroke', () => Chart.colors(index * 5))\n        .style('stroke-width', '5px')\n        .attr('class', `francy-line-${index}`)\n        .attr('d', valueLine)\n        .on('mouseenter', function(d) {\n          d3.select(this).transition()\n            .duration(250)\n            .style('stroke-opacity', 0.5)\n            .style('stroke-width', '10px');\n          self.tooltip.load(Chart.tooltip(key, d), true).render();\n        })\n        .on('mouseleave', function() {\n          d3.select(this).transition()\n            .duration(250)\n            .style('stroke-opacity', 1)\n            .style('stroke-width', '5px');\n          self.tooltip.unrender();\n        });\n\n      lineEnter.merge(line);\n    });\n\n    this._renderAxis();\n    this._renderLegend();\n\n    return this;\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart-line.js","import Chart from './chart';\n\n/* global d3 */\n\nexport default class ScatterChart extends Chart {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  render() {\n    \n    this._initialize();\n\n    let scatterGroup = this.element.selectAll('g.francy-scatters');\n\n    if (!scatterGroup.node()) {\n      scatterGroup = this.element.append('g').attr('class', 'francy-scatters');\n    }\n    \n    let self = this;\n\n    this.datasetNames.forEach(function(key, index) {\n      let scatter = scatterGroup.selectAll(`.francy-scatter-${index}`).data(self.datasets[key]);\n\n      scatter.exit().transition().duration(750)\n        .style('fill-opacity', 1e-6)\n        .remove();\n\n      // append the rectangles for the bar chart\n      let scatterEnter = scatter\n        .enter()\n        .append('circle')\n        .style('fill', () => Chart.colors(index * 5))\n        .attr('class', `francy-scatter-${index}`)\n        .attr('r', 5)\n        .attr('cx', function(d, i) {\n          return self.xScale(i);\n        })\n        .attr('cy', function(d) {\n          return self.yScale(d);\n        })\n        .on('mouseenter', function(d) {\n          d3.select(this).transition()\n            .duration(250)\n            .style('fill-opacity', 0.5)\n            .attr('r', 10);\n          self.tooltip.load(Chart.tooltip(key, d), true).render();\n        })\n        .on('mouseleave', function() {\n          d3.select(this).transition()\n            .duration(250)\n            .style('fill-opacity', 1)\n            .attr('r', 5);\n          self.tooltip.unrender();\n        });\n\n      scatterEnter.merge(scatter);\n    });\n\n    this._renderAxis();\n\n    this._renderLegend();\n\n    return this;\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart-scatter.js","import Menu from './menu';\nimport AboutModal from './modal-about';\nimport * as SvgToPng from '../../node_modules/save-svg-as-png/saveSvgAsPng';\n\n/* global d3 window */\n\nexport default class MainMenu extends Menu {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  render() {\n    let aboutModal = new AboutModal(this.options);\n\n    // Otherwise clashes with the canvas itself!\n    const menuId = `MainMenu-${this.data.canvas.id}`;\n    this.element = d3.select(`#${menuId}`);\n\n    // Check if the menu is already present\n    if (!this.element.node()) {\n      // create a div element detached from the DOM!\n      this.logger.debug(`Creating Main Menu [${menuId}]...`);\n      this.element = this.parent.append('div').attr('class', 'francy-main-menu-holder').attr('id', menuId);\n    }\n\n    // Force rebuild menu again\n    this.element.selectAll('*').remove();\n\n    this.element = this.element.append('ul').attr('class', 'francy-main-menu');\n\n    if (this.data.canvas.title) {\n      this.element.append('li').attr('class', 'francy-title').append('a').html(this.data.canvas.title);\n    }\n\n    let entry = this.element.append('li');\n    entry.append('a').html('Francy');\n    let content = entry.append('ul');\n    content.append('li').append('a').on('click', () => this.options.appendTo.canvas.zoomToFit()).attr('title', 'Zoom to Fit').html('Zoom to Fit');\n    content.append('li').append('a').on('click', () => SvgToPng.saveSvgAsPng(this.SVGParent.node(), 'diagram.png')).attr('title', 'Save to PNG').html('Save to PNG');\n    content.append('li').append('a').on('click', () => aboutModal.load(this.data).render()).attr('title', 'About').html('About');\n\n    // Traverse all menus and flatten them!\n    let menusIterator = this.iterator(Object.values(this.data.canvas.menus));\n    this.traverse(this.element, menusIterator);\n\n    this.logger.debug(`Main Menu updated [${menuId}]...`);\n\n    return this;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/menu-main.js","import Renderer from './renderer';\nimport { RegisterJupyterKeyboardEvents } from '../util/component';\n\n/* global d3 */\n\nexport default class AboutModal extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  render() {\n    let self = this;\n\n    let modalId = 'AboutModalWindow';\n\n    this.logger.debug(`Creating About Modal [${modalId}]...`);\n\n    // we want to overlay everything, hence 'body' must be used\n    let overlay = d3.select('body').append('div')\n      .attr('class', 'francy-overlay');\n    let holder = d3.select('body').append('div')\n      .attr('class', 'francy');\n    this.element = holder.append('div')\n      .attr('id', modalId)\n      .attr('class', 'francy-modal');\n\n    let form = this.element.append('form');\n\n    let header = form.append('div').attr('class', 'francy-modal-header');\n\n    header.append('span').html(`About Francy v${this.data.version || 'N/A'}`);\n\n    let content = form.append('div').attr('class', 'francy-modal-content').append('div').attr('class', 'francy-table').append('div').attr('class', 'francy-table-body');\n\n    content.append('span').text('Loaded Object:');\n    content.append('pre').attr('class', 'francy').html(AboutModal.syntaxHighlight(JSON.stringify(this.data.canvas, null, 2)));\n    content.append('span').append('a').attr('href', 'https://github.com/mcmartins/francy').text('Francy on Github');\n\n    let footer = form.append('div').attr('class', 'francy-modal-footer');\n\n    footer.append('button').text('Ok').on('click', () => {\n      overlay.remove();\n      self.element.remove();\n      holder.remove();\n      d3.event.preventDefault();\n      return false;\n    });\n\n    // disable keyboard shortcuts when using this modal in Jupyter\n    RegisterJupyterKeyboardEvents(['.francy', '.francy-arg', '.francy-overlay', '.francy-modal']);\n\n    this.logger.debug(`Callback About updated [${modalId}]...`);\n\n    return this;\n  }\n\n  unrender() {}\n\n  // credits here: https://stackoverflow.com/questions/4810841/how-can-i-pretty-print-json-using-javascript#answer-7220510\n  static syntaxHighlight(json) {\n    json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n    return json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)/g, function(match) {\n      let cls = 'number';\n      if (/^\"/.test(match)) {\n        if (/:$/.test(match)) {\n          cls = 'key';\n        }\n        else {\n          cls = 'string';\n        }\n      }\n      else if (/true|false/.test(match)) {\n        cls = 'boolean';\n      }\n      else if (/null/.test(match)) {\n        cls = 'null';\n      }\n      return '<span class=\"' + cls + '\">' + match + '</span>';\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/modal-about.js","(function() {\n  var out$ = typeof exports != 'undefined' && exports || typeof define != 'undefined' && {} || this;\n\n  var doctype = '<?xml version=\"1.0\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\" [<!ENTITY nbsp \"&#160;\">]>';\n\n  function isElement(obj) {\n    return obj instanceof HTMLElement || obj instanceof SVGElement;\n  }\n\n  function requireDomNode(el) {\n    if (!isElement(el)) {\n      throw new Error('an HTMLElement or SVGElement is required; got ' + el);\n    }\n  }\n\n  function isExternal(url) {\n    return url && url.lastIndexOf('http',0) == 0 && url.lastIndexOf(window.location.host) == -1;\n  }\n\n  function inlineImages(el, callback) {\n    requireDomNode(el);\n\n    var images = el.querySelectorAll('image'),\n        left = images.length,\n        checkDone = function() {\n          if (left === 0) {\n            callback();\n          }\n        };\n\n    checkDone();\n    for (var i = 0; i < images.length; i++) {\n      (function(image) {\n        var href = image.getAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\");\n        if (href) {\n          if (isExternal(href.value)) {\n            console.warn(\"Cannot render embedded images linking to external hosts: \"+href.value);\n            return;\n          }\n        }\n        var canvas = document.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        var img = new Image();\n        img.crossOrigin=\"anonymous\";\n        href = href || image.getAttribute('href');\n        if (href) {\n          img.src = href;\n          img.onload = function() {\n            canvas.width = img.width;\n            canvas.height = img.height;\n            ctx.drawImage(img, 0, 0);\n            image.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\", canvas.toDataURL('image/png'));\n            left--;\n            checkDone();\n          }\n          img.onerror = function() {\n            console.log(\"Could not load \"+href);\n            left--;\n            checkDone();\n          }\n        } else {\n          left--;\n          checkDone();\n        }\n      })(images[i]);\n    }\n  }\n\n  function styles(el, options, cssLoadedCallback) {\n    var selectorRemap = options.selectorRemap;\n    var modifyStyle = options.modifyStyle;\n    var css = \"\";\n    // each font that has extranl link is saved into queue, and processed\n    // asynchronously\n    var fontsQueue = [];\n    var sheets = document.styleSheets;\n    for (var i = 0; i < sheets.length; i++) {\n      try {\n        var rules = sheets[i].cssRules;\n      } catch (e) {\n        console.warn(\"Stylesheet could not be loaded: \"+sheets[i].href);\n        continue;\n      }\n\n      if (rules != null) {\n        for (var j = 0, match; j < rules.length; j++, match = null) {\n          var rule = rules[j];\n          if (typeof(rule.style) != \"undefined\") {\n            var selectorText;\n\n            try {\n              selectorText = rule.selectorText;\n            } catch(err) {\n              console.warn('The following CSS rule has an invalid selector: \"' + rule + '\"', err);\n            }\n\n            try {\n              if (selectorText) {\n                match = el.querySelector(selectorText) || el.parentNode.querySelector(selectorText);\n              }\n            } catch(err) {\n              console.warn('Invalid CSS selector \"' + selectorText + '\"', err);\n            }\n\n            if (match) {\n              var selector = selectorRemap ? selectorRemap(rule.selectorText) : rule.selectorText;\n              var cssText = modifyStyle ? modifyStyle(rule.style.cssText) : rule.style.cssText;\n              css += selector + \" { \" + cssText + \" }\\n\";\n            } else if(rule.cssText.match(/^@font-face/)) {\n              // below we are trying to find matches to external link. E.g.\n              // @font-face {\n              //   // ...\n              //   src: local('Abel'), url(https://fonts.gstatic.com/s/abel/v6/UzN-iejR1VoXU2Oc-7LsbvesZW2xOQ-xsNqO47m55DA.woff2);\n              // }\n              //\n              // This regex will save extrnal link into first capture group\n              var fontUrlRegexp = /url\\([\"']?(.+?)[\"']?\\)/;\n              // TODO: This needs to be changed to support multiple url declarations per font.\n              var fontUrlMatch = rule.cssText.match(fontUrlRegexp);\n\n              var externalFontUrl = (fontUrlMatch && fontUrlMatch[1]) || '';\n              var fontUrlIsDataURI = externalFontUrl.match(/^data:/);\n              if (fontUrlIsDataURI) {\n                // We should ignore data uri - they are already embedded\n                externalFontUrl = '';\n              }\n\n              if (externalFontUrl) {\n                // okay, we are lucky. We can fetch this font later\n\n                //handle url if relative\n                if (externalFontUrl.startsWith('../')) {\n                  externalFontUrl = sheets[i].href + '/../' + externalFontUrl\n                } else if (externalFontUrl.startsWith('./')) {\n                  externalFontUrl = sheets[i].href + '/.' + externalFontUrl\n                }\n\n                fontsQueue.push({\n                  text: rule.cssText,\n                  // Pass url regex, so that once font is downladed, we can run `replace()` on it\n                  fontUrlRegexp: fontUrlRegexp,\n                  format: getFontMimeTypeFromUrl(externalFontUrl),\n                  url: externalFontUrl\n                });\n              } else {\n                // otherwise, use previous logic\n                css += rule.cssText + '\\n';\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Now all css is processed, it's time to handle scheduled fonts\n    processFontQueue(fontsQueue);\n\n    function getFontMimeTypeFromUrl(fontUrl) {\n      var supportedFormats = {\n        'woff2': 'font/woff2',\n        'woff': 'font/woff',\n        'otf': 'application/x-font-opentype',\n        'ttf': 'application/x-font-ttf',\n        'eot': 'application/vnd.ms-fontobject',\n        'sfnt': 'application/font-sfnt',\n        'svg': 'image/svg+xml'\n      };\n      var extensions = Object.keys(supportedFormats);\n      for (var i = 0; i < extensions.length; ++i) {\n        var extension = extensions[i];\n        // TODO: This is not bullet proof, it needs to handle edge cases...\n        if (fontUrl.indexOf('.' + extension) > 0) {\n          return supportedFormats[extension];\n        }\n      }\n\n      // If you see this error message, you probably need to update code above.\n      console.error('Unknown font format for ' + fontUrl+ '; Fonts may not be working correctly');\n      return 'application/octet-stream';\n    }\n\n    function processFontQueue(queue) {\n      if (queue.length > 0) {\n        // load fonts one by one until we have anything in the queue:\n        var font = queue.pop();\n        processNext(font);\n      } else {\n        // no more fonts to load.\n        cssLoadedCallback(css);\n      }\n\n      function processNext(font) {\n        // TODO: This could benefit from caching.\n        var oReq = new XMLHttpRequest();\n        oReq.addEventListener('load', fontLoaded);\n        oReq.addEventListener('error', transferFailed);\n        oReq.addEventListener('abort', transferFailed);\n        oReq.open('GET', font.url);\n        oReq.responseType = 'arraybuffer';\n        oReq.send();\n\n        function fontLoaded() {\n          // TODO: it may be also worth to wait until fonts are fully loaded before\n          // attempting to rasterize them. (e.g. use https://developer.mozilla.org/en-US/docs/Web/API/FontFaceSet )\n          var fontBits = oReq.response;\n          var fontInBase64 = arrayBufferToBase64(fontBits);\n          updateFontStyle(font, fontInBase64);\n        }\n\n        function transferFailed(e) {\n          console.warn('Failed to load font from: ' + font.url);\n          console.warn(e)\n          css += font.text + '\\n';\n          processFontQueue();\n        }\n\n        function updateFontStyle(font, fontInBase64) {\n          var dataUrl = 'url(\"data:' + font.format + ';base64,' + fontInBase64 + '\")';\n          css += font.text.replace(font.fontUrlRegexp, dataUrl) + '\\n';\n\n          // schedule next font download on next tick.\n          setTimeout(function() {\n            processFontQueue(queue)\n          }, 0);\n        }\n\n      }\n    }\n\n    function arrayBufferToBase64(buffer) {\n      var binary = '';\n      var bytes = new Uint8Array(buffer);\n      var len = bytes.byteLength;\n\n      for (var i = 0; i < len; i++) {\n          binary += String.fromCharCode(bytes[i]);\n      }\n\n      return window.btoa(binary);\n    }\n  }\n\n  function getDimension(el, clone, dim) {\n    var v = (el.viewBox && el.viewBox.baseVal && el.viewBox.baseVal[dim]) ||\n      (clone.getAttribute(dim) !== null && !clone.getAttribute(dim).match(/%$/) && parseInt(clone.getAttribute(dim))) ||\n      el.getBoundingClientRect()[dim] ||\n      parseInt(clone.style[dim]) ||\n      parseInt(window.getComputedStyle(el).getPropertyValue(dim));\n    return (typeof v === 'undefined' || v === null || isNaN(parseFloat(v))) ? 0 : v;\n  }\n\n  function reEncode(data) {\n    data = encodeURIComponent(data);\n    data = data.replace(/%([0-9A-F]{2})/g, function(match, p1) {\n      var c = String.fromCharCode('0x'+p1);\n      return c === '%' ? '%25' : c;\n    });\n    return decodeURIComponent(data);\n  }\n\n  out$.prepareSvg = function(el, options, cb) {\n    requireDomNode(el);\n\n    options = options || {};\n    options.scale = options.scale || 1;\n    options.responsive = options.responsive || false;\n    var xmlns = \"http://www.w3.org/2000/xmlns/\";\n\n    inlineImages(el, function() {\n      var outer = document.createElement(\"div\");\n      var clone = el.cloneNode(true);\n      var width, height;\n      if(el.tagName == 'svg') {\n        width = options.width || getDimension(el, clone, 'width');\n        height = options.height || getDimension(el, clone, 'height');\n      } else if(el.getBBox) {\n        var box = el.getBBox();\n        width = box.x + box.width;\n        height = box.y + box.height;\n        clone.setAttribute('transform', clone.getAttribute('transform').replace(/translate\\(.*?\\)/, ''));\n\n        var svg = document.createElementNS('http://www.w3.org/2000/svg','svg')\n        svg.appendChild(clone)\n        clone = svg;\n      } else {\n        console.error('Attempted to render non-SVG element', el);\n        return;\n      }\n\n      clone.setAttribute(\"version\", \"1.1\");\n      if (!clone.getAttribute('xmlns')) {\n        clone.setAttributeNS(xmlns, \"xmlns\", \"http://www.w3.org/2000/svg\");\n      }\n      if (!clone.getAttribute('xmlns:xlink')) {\n        clone.setAttributeNS(xmlns, \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n      }\n\n      if (options.responsive) {\n        clone.removeAttribute('width');\n        clone.removeAttribute('height');\n        clone.setAttribute('preserveAspectRatio', 'xMinYMin meet');\n      } else {\n        clone.setAttribute(\"width\", width * options.scale);\n        clone.setAttribute(\"height\", height * options.scale);\n      }\n\n      clone.setAttribute(\"viewBox\", [\n        options.left || 0,\n        options.top || 0,\n        width,\n        height\n      ].join(\" \"));\n\n      var fos = clone.querySelectorAll('foreignObject > *');\n      for (var i = 0; i < fos.length; i++) {\n        if (!fos[i].getAttribute('xmlns')) {\n          fos[i].setAttributeNS(xmlns, \"xmlns\", \"http://www.w3.org/1999/xhtml\");\n        }\n      }\n\n      outer.appendChild(clone);\n\n      // In case of custom fonts we need to fetch font first, and then inline\n      // its url into data-uri format (encode as base64). That's why style\n      // processing is done asynchonously. Once all inlining is finshed\n      // cssLoadedCallback() is called.\n      styles(el, options, cssLoadedCallback);\n\n      function cssLoadedCallback(css) {\n        // here all fonts are inlined, so that we can render them properly.\n        var s = document.createElement('style');\n        s.setAttribute('type', 'text/css');\n        s.innerHTML = \"<![CDATA[\\n\" + css + \"\\n]]>\";\n        var defs = document.createElement('defs');\n        defs.appendChild(s);\n        clone.insertBefore(defs, clone.firstChild);\n\n        if (cb) {\n          var outHtml = outer.innerHTML;\n          outHtml = outHtml.replace(/NS\\d+:href/gi, 'xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href');\n          cb(outHtml, width, height);\n        }\n      }\n    });\n  }\n\n  out$.svgAsDataUri = function(el, options, cb) {\n    out$.prepareSvg(el, options, function(svg) {\n      var uri = 'data:image/svg+xml;base64,' + window.btoa(reEncode(doctype + svg));\n      if (cb) {\n        cb(uri);\n      }\n    });\n  }\n\n  out$.svgAsPngUri = function(el, options, cb) {\n    requireDomNode(el);\n\n    options = options || {};\n    options.encoderType = options.encoderType || 'image/png';\n    options.encoderOptions = options.encoderOptions || 0.8;\n\n    var convertToPng = function(src, w, h) {\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      canvas.width = w;\n      canvas.height = h;\n\n      if(options.canvg) {\n        options.canvg(canvas, src);\n      } else {\n        context.drawImage(src, 0, 0);\n      }\n\n      if(options.backgroundColor){\n        context.globalCompositeOperation = 'destination-over';\n        context.fillStyle = options.backgroundColor;\n        context.fillRect(0, 0, canvas.width, canvas.height);\n      }\n\n      var png;\n      try {\n        png = canvas.toDataURL(options.encoderType, options.encoderOptions);\n      } catch (e) {\n        if ((typeof SecurityError !== 'undefined' && e instanceof SecurityError) || e.name == \"SecurityError\") {\n          console.error(\"Rendered SVG images cannot be downloaded in this browser.\");\n          return;\n        } else {\n          throw e;\n        }\n      }\n      cb(png);\n    }\n\n    if(options.canvg) {\n      out$.prepareSvg(el, options, convertToPng);\n    } else {\n      out$.svgAsDataUri(el, options, function(uri) {\n        var image = new Image();\n\n        image.onload = function() {\n          convertToPng(image, image.width, image.height);\n        }\n\n        image.onerror = function() {\n          console.error(\n            'There was an error loading the data URI as an image on the following SVG\\n',\n            window.atob(uri.slice(26)), '\\n',\n            \"Open the following link to see browser's diagnosis\\n\",\n            uri);\n        }\n\n        image.src = uri;\n      });\n    }\n  }\n\n  out$.download = function(name, uri) {\n    if (navigator.msSaveOrOpenBlob) {\n      navigator.msSaveOrOpenBlob(uriToBlob(uri), name);\n    } else {\n      var saveLink = document.createElement('a');\n      var downloadSupported = 'download' in saveLink;\n      if (downloadSupported) {\n        saveLink.download = name;\n        saveLink.style.display = 'none';\n        document.body.appendChild(saveLink);\n        try {\n          var blob = uriToBlob(uri);\n          var url = URL.createObjectURL(blob);\n          saveLink.href = url;\n          saveLink.onclick = function() {\n            requestAnimationFrame(function() {\n              URL.revokeObjectURL(url);\n            })\n          };\n        } catch (e) {\n          console.warn('This browser does not support object URLs. Falling back to string URL.');\n          saveLink.href = uri;\n        }\n        saveLink.click();\n        document.body.removeChild(saveLink);\n      }\n      else {\n        window.open(uri, '_temp', 'menubar=no,toolbar=no,status=no');\n      }\n    }\n  }\n\n  function uriToBlob(uri) {\n    var byteString = window.atob(uri.split(',')[1]);\n    var mimeString = uri.split(',')[0].split(':')[1].split(';')[0]\n    var buffer = new ArrayBuffer(byteString.length);\n    var intArray = new Uint8Array(buffer);\n    for (var i = 0; i < byteString.length; i++) {\n      intArray[i] = byteString.charCodeAt(i);\n    }\n    return new Blob([buffer], {type: mimeString});\n  }\n\n  out$.saveSvg = function(el, name, options) {\n    requireDomNode(el);\n\n    options = options || {};\n    out$.svgAsDataUri(el, options, function(uri) {\n      out$.download(name, uri);\n    });\n  }\n\n  out$.saveSvgAsPng = function(el, name, options) {\n    requireDomNode(el);\n\n    options = options || {};\n    out$.svgAsPngUri(el, options, function(uri) {\n      out$.download(name, uri);\n    });\n  }\n\n  // if define is defined create as an AMD module\n  if (typeof define !== 'undefined') {\n    define(function() {\n      return out$;\n    });\n  }\n\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/save-svg-as-png/saveSvgAsPng.js","import Renderer from './renderer';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class Message extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires('canvas.messages')\n  render() {\n\n    let messages = Object.keys(this.data.canvas.messages).map((key) => {\n      return {\n        id: key,\n        type: this.data.canvas.messages[key].type,\n        title: this.data.canvas.messages[key].title,\n        text: this.data.canvas.messages[key].text\n      };\n    });\n\n    let alertsId = `Messages-${this.data.canvas.id}`;\n    this.element = d3.select(`#${alertsId}`);\n    // check if the div is already present\n    if (!this.element.node()) {\n      this.element = this.parent.append('div').attr('class', 'francy-message-holder').attr('id', alertsId);\n    }\n\n    let message = this.element.selectAll('div.francy-alert').data(messages, d => d.id);\n    let messageEnter = message.enter().append('div').attr('id', d => d.id)\n      .attr('class', d => `francy-alert alert-${d.type}`).on('click', function() {\n        d3.select(this).style('display', 'none');\n      });\n    messageEnter.append('span').attr('class', 'strong').text(d => d.title);\n    messageEnter.append('span').text(d => d.text);\n    messageEnter.append('span').attr('class', 'strong').style('display', 'none').text('x');\n\n    messageEnter.merge(message);\n\n    message.exit().remove();\n\n    this.element.style('display', 'block');\n\n    return this;\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/message.js"],"sourceRoot":""}