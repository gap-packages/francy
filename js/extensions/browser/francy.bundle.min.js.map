{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap e81ab3b7d4fba8b7c259","webpack:///./src/render/renderer.js","webpack:///./src/util/data-decorator.js","webpack:///./src/util/initialize-decorator.js","webpack:///./src/render/base.js","webpack:///./src/render/chart.js","webpack:///./src/render/composite.js","webpack:///./src/util/logger.js","webpack:///./src/render/graph.js","webpack:///./src/render/menu.js","webpack:///./src/render/callback.js","webpack:///./src/render/modal.js","webpack:///./src/util/component.js","webpack:///./src/render/tooltip.js","webpack:///./src/francy.js","webpack:///./src/render/frame.js","webpack:///./src/util/json-utils.js","webpack:///./src/render/mathjax-wrapper.js","webpack:///./src/render/canvas.js","webpack:///./src/render/graph-factory.js","webpack:///./src/render/graph-tree.js","webpack:///./src/render/menu-context.js","webpack:///./src/render/modal-required.js","webpack:///./src/render/graph-generic.js","webpack:///./src/render/chart-factory.js","webpack:///./src/render/chart-bar.js","webpack:///./src/render/chart-line.js","webpack:///./src/render/chart-scatter.js","webpack:///./src/render/menu-main.js","webpack:///./src/render/modal-about.js","webpack:///./node_modules/save-svg-as-png/saveSvgAsPng.js","webpack:///./src/render/message.js"],"names":["Renderer","verbose","appendTo","callbackHandler","options","new","target","TypeError","render","undefined","unrender","logger","debug","mathjaxWrapper","element","transitionDuration","parent","node","tagName","toLowerCase","d3","select","parentNode","top","right","bottom","left","width","attr","getBoundingClientRect","margin","height","load","data","requires","enabled","props","decorator","name","descriptor","oldValue","value","hasData","getProperty","apply","arguments","obj","propertyPath","tmp","properties","split","property","hasOwnProperty","Array","length","Object","values","initialize","key","_initialize","Base","settings","log","Error","json","partial","parse","Chart","axis","yScale","xScale","datasets","datasetNames","tooltip","canvas","chart","keys","scaleLinear","range","domain","x","y","allValues","forEach","concat","max","d","xAxisGroup","selectAll","append","remove","call","axisBottom","style","text","title","yAxisGroup","axisLeft","showLegend","legendGroup","legend","slice","exit","enter","i","merge","colors","dataset","from","_","map","scaleSequential","interpolator","interpolateRainbow","Composite","renderers","renderer","push","Logger","console","message","_format","info","error","level","Date","toISOString","Graph","contextMenu","callback","self","on","executeCallback","selected","messages","mathjax","renderHTML","event","callbacks","cb","trigger","execute","s","t","angle","Math","atan2","cos","sin","type","symbolCross","symbolDiamond","symbolSquare","symbolTriangle","symbolStar","symbolWye","symbolCircle","Menu","menusIterator","hasNext","menuItem","next","entry","action","html","menus","content","subMenusIterator","iterator","traverse","array","nextIndex","CallbackHandler","requiredArgs","callbackObj","_execute","calbackObj","JSON","stringify","Modal","overlay","holder","RegisterJupyterKeyboardEvents","syntaxHighlight","classes","c","Jupyter","keyboard_manager","register_events","e","replace","match","cls","test","Tooltip","HTMLParent","pos","mouse","SVGParent","table","row","ALL_CANVAS","Francy","frame","id","exports","window","oldResize","onresize","zoomToFit","Frame","menu","add","frameId","renderChildren","JsonUtils","input","jsonRegex","exec","mime","MIME","initialized","MathJaxWrapper","MathJax","Hub","Config","showMathMenu","skipStartupTypeset","tex2jax","inlineMath","displayMath","processEscapes","processEnvironments","MathML","extensions","displayAlign","availableFonts","imageFont","preferredFont","font","webFont","styles","linebreaks","automatic","Register","MessageHook","mathJaxElement","svgMathJaxElement","setTimeout","baseVal","Configured","Queue","Canvas","graphFactory","chartFactory","zoom","updateZoom","translateX","translateY","scale","transform","zoomIdentity","translate","zoomed","stopped","defaultPrevented","stopPropagation","bounds","getBBox","clientBounds","fullWidth","fullHeight","midX","midY","transition","duration","canvasId","graph","TreeGraph","root","hierarchy","treeData","children","x0","y0","levelWidth","childCount","n","newHeight","treemap","tree","size","collapsed","collapse","update","_children","source","nodes","descendants","links","depth","linkGroup","link","linkEnter","o","diagonal","nodeGroup","nodeEnter","symbol","getSymbol","bound","nodeUpdate","layer","_applyEvents","nodeOnClick","click","canvasNodes","dataMap","reduce","ContextMenu","preventDefault","RequiredArgsModal","modalId","form","header","headerTitle","arg","onchange","checked","footer","checkValidity","inputElement","focus","GenericGraph","simulationActive","simulation","radius","canvasLinks","classed","linksToAdd","_filterNewElements","nodesToAdd","weight","color","highlight","startsWith","endsWith","renderSVG","drag","dragstarted","dragged","dragended","empty","showNeighbours","connectedNodes","manyForce","forceManyBody","strength","linkForce","forceLink","distance","collideForce","forceCollide","iterations","forceX","forceY","forceSimulation","force","ticked","restart","linkXPos","linkYPos","toggle","linkedByIndex","index","neighboring","a","b","__data__","active","alphaTarget","fx","fy","canvasObjects","d3Element","newElements","find","ChartFactory","BarChart","scaleBand","padding","domainRange","barsGroup","bar","barEnter","bandwidth","_renderAxis","_renderLegend","LineChart","linesGroup","valueLine","line","lineEnter","ScatterChart","scatterGroup","scatter","scatterEnter","SvgToPng","MainMenu","aboutModal","menuId","saveSvgAsPng","AboutModal","version","out$","doctype","isElement","HTMLElement","SVGElement","requireDomNode","el","isExternal","url","lastIndexOf","location","host","inlineImages","images","querySelectorAll","checkDone","image","href","getAttributeNS","warn","document","createElement","ctx","getContext","img","Image","crossOrigin","getAttribute","src","onload","drawImage","setAttributeNS","toDataURL","onerror","cssLoadedCallback","selectorRemap","modifyStyle","css","fontsQueue","sheets","styleSheets","rules","cssRules","j","rule","selectorText","err","querySelector","selector","cssText","fontUrlRegexp","fontUrlMatch","externalFontUrl","fontUrlIsDataURI","format","getFontMimeTypeFromUrl","processFontQueue","fontUrl","supportedFormats","extension","indexOf","queue","pop","processNext","oReq","XMLHttpRequest","addEventListener","fontLoaded","transferFailed","open","responseType","send","fontBits","response","fontInBase64","arrayBufferToBase64","updateFontStyle","dataUrl","buffer","binary","bytes","Uint8Array","len","byteLength","String","fromCharCode","btoa","getDimension","clone","dim","v","viewBox","parseInt","getComputedStyle","getPropertyValue","isNaN","parseFloat","reEncode","encodeURIComponent","p1","decodeURIComponent","prepareSvg","responsive","xmlns","outer","cloneNode","box","setAttribute","svg","createElementNS","appendChild","removeAttribute","join","fos","innerHTML","defs","insertBefore","firstChild","outHtml","svgAsDataUri","uri","svgAsPngUri","encoderType","encoderOptions","convertToPng","w","h","context","canvg","backgroundColor","globalCompositeOperation","fillStyle","fillRect","png","SecurityError","atob","download","navigator","msSaveOrOpenBlob","uriToBlob","saveLink","downloadSupported","display","body","blob","URL","createObjectURL","onclick","requestAnimationFrame","revokeObjectURL","removeChild","byteString","mimeString","ArrayBuffer","intArray","charCodeAt","Blob","saveSvg","define","Message","alertsId","messageEnter"],"mappings":"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","file":"francy.bundle.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e81ab3b7d4fba8b7c259","import Base from './base';\nimport MathJaxWrapper from './mathjax-wrapper';\n\n/* global d3 */\n\nexport default class Renderer extends Base {\n\n  constructor({ verbose = false, appendTo, callbackHandler, options = {} }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler, options: options });\n    if (new.target === Renderer) {\n      throw new TypeError('Cannot construct [Renderer] instances directly!');\n    }\n    if (this.render === undefined || typeof this.render !== 'function') {\n      throw new TypeError('Must override [render()] method!');\n    }\n    if (this.unrender === undefined) {\n      this.logger.debug('No [unrender()] method specified...');\n    }\n    this.mathjaxWrapper = new MathJaxWrapper(this.options);\n    this.element = undefined;\n    this.transitionDuration = 750; //ms\n  }\n  \n  _initialize() {}\n\n  get HTMLParent() {\n    return this.parent.node().tagName.toLowerCase() === 'svg' ? d3.select(this.parent.node().parentNode) : this.parent;\n  }\n\n  get SVGParent() {\n    return this.parent.node().tagName.toLowerCase() === 'div' ? this.parent.select('svg') : this.parent;\n  }\n  \n  get margin() {\n    return { top: 50, right: 50, bottom: 50, left: 50 };\n  }\n  \n  get width() {\n    let width = +this.parent.attr('width') || d3.select('body').node().getBoundingClientRect().width;\n    return width - this.margin.left - this.margin.right;\n  }\n  \n  get height() {\n    let height = +this.parent.attr('height') || d3.select('body').node().getBoundingClientRect().height;\n    return height - this.margin.top - this.margin.bottom;\n  }\n  \n  get mathjax() {\n    return this.mathjaxWrapper.load(this.data);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/renderer.js","export function requires(props) {\n  return function decorator(target, name, descriptor) {\n    var oldValue = descriptor.value;\n\n    descriptor.value = function() {\n      if (!hasData(getProperty(this.data, props))) {\n        this.logger.debug(`No data here [${props}], nothing to render... continuing...`);\n        return;\n      }\n      return oldValue.apply(this, arguments);\n    };\n\n    return descriptor;\n  };\n}\n\nexport function enabled(props) {\n  return function decorator(target, name, descriptor) {\n    var oldValue = descriptor.value;\n\n    descriptor.value = function() {\n      if (!getProperty(this.data, props)) {\n        this.logger.debug(`Property disabled [${props}], skip execution... continuing...`);\n        return;\n      }\n      return oldValue.apply(this, arguments);\n    };\n\n    return descriptor;\n  };\n}\n\nfunction getProperty(obj, propertyPath) {\n\n  var tmp = obj;\n\n  if (tmp && propertyPath) {\n    var properties = propertyPath.split('.');\n\n    for (var property of properties) {\n      if (!tmp.hasOwnProperty(property)) {\n        tmp = undefined;\n        break;\n      } else {\n        tmp = tmp[property];\n      }\n    }\n  }\n\n  return tmp;\n}\n\nfunction hasData(obj) {\n  return obj && ((obj instanceof Array && obj.length) || (obj instanceof Object && Object.values(obj).length));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/data-decorator.js","export function initialize() {\n  return function (target, key, descriptor) {\n    var oldValue = descriptor.value;\n\n    descriptor.value = function() {\n      this._initialize();\n      return oldValue.apply(this, arguments);\n    };\n    return descriptor;\n  };\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/initialize-decorator.js","import Logger from '../util/logger';\nimport JsonUtils from '../util/json-utils';\n\n/* global d3 */\n\nexport default class Base {\n\n  constructor({ verbose = false, appendTo = 'body', callbackHandler }) {\n    /**\n     * @typedef {Object} Options\n     * @property {Boolean} verbose prints extra log information to console.log, default false\n     * @property {Boolean} appendTo where the generated html/svg components will be attached to, default body\n     * @property {Function} callbackHandler this handler will be used to invoke actions from the menu, default console.log\n     */\n    this.options = undefined;\n    this.settings({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    /**\n     * @Type {Object} the internal data model object\n     */\n    this.data = undefined;\n    /**\n     * @type {Logger} the logger for this class\n     */\n    this.log = new Logger(this.options);\n  }\n\n  settings({ verbose, appendTo, callbackHandler }) {\n    this.options = this.options || {};\n    if (!this.options.callbackHandler && !callbackHandler) {\n      throw new Error('A Callback Handler must be provided! This will be used to trigger events from the graphics produced...');\n    }\n    if (!this.options.appendTo && !appendTo) {\n      throw new Error('Missing an element or id to append the graphics to...!');\n    }\n    if (typeof appendTo === 'string') {\n      appendTo = d3.select(appendTo);\n    }\n    this.options.verbose = verbose || this.options.verbose;\n    this.options.appendTo = appendTo || this.options.appendTo;\n    this.options.callbackHandler = callbackHandler || this.options.callbackHandler;\n    return this;\n  }\n\n  load(json, partial) {\n    let data = JsonUtils.parse(json, partial);\n    if (data) {\n      this.data = data;\n    }\n    return this;\n  }\n\n  get parent() {\n    return this.options.appendTo.element;\n  }\n\n  get logger() {\n    return this.log;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/base.js","import Renderer from './renderer';\nimport Tooltip from './tooltip';\n\n/* global d3 */\n\nexport default class Chart extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.axis = undefined;\n    this.yScale = undefined;\n    this.xScale = undefined;\n    this.datasets = undefined;\n    this.datasetNames = undefined;\n    this.tooltip = undefined;\n  }\n  \n  _initialize() {\n    this.tooltip = new Tooltip(this.options);\n    \n    this.element = this.parent.select('g.francy-content');\n    \n    this.axis = this.data.canvas.chart.axis;\n    this.datasets = this.data.canvas.chart.data;\n    this.datasetNames = Object.keys(this.datasets);\n\n    this.xScale = d3.scaleLinear().range([0, this.width]).domain(this.axis.x.domain);\n    this.yScale = d3.scaleLinear().range([this.height, 0]).domain(this.axis.y.domain);\n    \n    this.allValues = [];\n    this.datasetNames.forEach(key => this.allValues = this.allValues.concat(this.datasets[key]));\n\n    if (!this.axis.y.domain.length) {\n      this.yScale.domain([0, d3.max(this.allValues, d => d)]);\n    }\n\n    if (!this.axis.x.domain.length) {\n      this.xScale.domain([0, this.allValues.length / this.datasetNames.length]);\n    }\n  }\n  \n  _renderAxis() {\n    // force rebuild axis again\n    let xAxisGroup = this.element.selectAll('g.francy-x-axis');\n\n    if (!xAxisGroup.node()) {\n      xAxisGroup = this.element.append('g').attr('class', 'francy-x-axis');\n    }\n\n    xAxisGroup.selectAll('*').remove();\n\n    // add the x Axis\n    xAxisGroup\n      .attr('transform', `translate(0,${this.height})`)\n      .call(d3.axisBottom(this.xScale))\n      .append('text')\n      .attr('dy', 50)\n      .attr('dx', this.width / 2)\n      .attr('fill', 'black')\n      .attr('class', 'francy-axis')\n      .style('text-anchor', 'end')\n      .text(this.axis.x.title);\n\n    // force rebuild axis again\n    let yAxisGroup = this.element.selectAll('g.francy-y-axis');\n\n    if (!yAxisGroup.node()) {\n      yAxisGroup = this.element.append('g').attr('class', 'francy-y-axis');\n    }\n\n    yAxisGroup.selectAll('*').remove();\n\n    // add the y Axis\n    yAxisGroup\n      .call(d3.axisLeft(this.yScale))\n      .append('text')\n      .attr('dx', -50)\n      .attr('dy', this.height / 2)\n      .attr('fill', 'black')\n      .attr('class', 'francy-axis')\n      .style('text-anchor', 'end')\n      .text(this.axis.y.title);\n  }\n  \n  _renderLegend() {\n    if (this.data.canvas.chart.showLegend) {\n\n      let legendGroup = this.element.selectAll('.francy-legend');\n\n      if (!legendGroup.node()) {\n        legendGroup = this.element.append('g').attr('class', 'francy-legend');\n      }\n\n      // force rebuild legend again\n      legendGroup.selectAll('*').remove();\n\n      let legend = legendGroup.selectAll('g').data(this.datasetNames.slice());\n\n      legend.exit().remove();\n\n      legend = legend.enter()\n        .append('g')\n        .attr('transform', (d, i) => `translate(0,${i * 20})`)\n        .merge(legend);\n\n      legend.append('rect')\n        .attr('x', this.width + 20)\n        .attr('width', 19)\n        .attr('height', 19)\n        .style('fill', (d, i) => Chart.colors(i * 5));\n\n      legend.append('text')\n        .attr('x', this.width + 80)\n        .attr('y', 9)\n        .attr('dy', '.35em')\n        .style('text-anchor', 'end')\n        .text(d => d);\n    }\n  }\n\n  static tooltip(dataset, value) {\n    return { 'A': { 'title': 'Dataset', 'text': dataset }, 'B': { 'title': 'Value', 'text': value } };\n  }\n\n  static get colors() {\n    return d3.scaleSequential().domain([0, 100]).interpolator(d3.interpolateRainbow);\n  }\n\n  static domainRange(max) {\n    return Array.from(new Array(max), (_, i) => i).map(x => x);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart.js","import Renderer from './renderer';\n\nexport default class Composite extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    if (new.target === Composite) {\n      throw new TypeError('Cannot construct [Composite] instances directly!');\n    }\n    this.renderers = [];\n  }\n\n  add(renderer) {\n    if (renderer) {\n      this.renderers.push(renderer);\n    }\n    return this;\n  }\n\n  renderChildren() {\n    // render other components\n    for (let renderer of this.renderers) {\n      renderer.settings({appendTo: this}).load(this.data).render();\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/composite.js","/**\n * This class provides a logger for the Francy application.\n */\nexport default class Logger {\n\n  /**\n   * Logger constructor\n   * @param verbose prints extra log information to console.log, defaults to false\n   */\n  constructor({ verbose = false } = {}) {\n    this.verbose = verbose;\n    this.console = console;\n  }\n\n  /**\n   * Creates a [DEBUG] entry in the console log\n   * @param message the message to print\n   */\n  debug(message) {\n    if (this.verbose) {\n      this.console.debug(Logger._format('DEBUG', message));\n    }\n  }\n\n  /**\n   * Creates a [INFO] entry in the console log\n   * @param message the message to print\n   */\n  info(message) {\n    this.console.info(Logger._format('INFO', message));\n  }\n\n  /**\n   * Creates a [ERROR] entry in the console log\n   * @param message the message to print\n   * @param error the error Object to attach to the message\n   */\n  error(message, error) {\n    this.console.error(Logger._format('ERROR', message), error);\n  }\n\n  /**\n   * Creates a [WARN] entry in the console log\n   * @param message the message to print\n   * @param error the error Object to attach to the message\n   */\n  warn(message, error) {\n    error = error || {};\n    this.console.error(Logger._format('WARN', message), error);\n  }\n\n  /**\n   * This is a private method that formats all log messages\n   * @param level the log level\n   * @param message the message to print\n   */\n  static _format(level, message) {\n    return `[${level}] - ${new Date().toISOString()} - ${message}`;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/logger.js","import Renderer from './renderer';\nimport ContextMenu from './menu-context';\nimport Tooltip from './tooltip';\nimport Callback from './callback';\n\n/* global d3 */\n\nexport default class Graph extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.tooltip = new Tooltip(this.options);\n    this.contextMenu = new ContextMenu(this.options);\n    this.callback = new Callback(this.options);\n  }\n  \n  _initialize() {\n    this.element = this.parent.select('g.francy-content');\n  }\n\n  _applyEvents(element) {\n    if (!element) return;\n    \n    var self = this;\n    element\n      .on('contextmenu', function(d) {\n        let data = d.data || d;\n        // default, build context menu\n        self.contextMenu.load(data, true).render();\n        // any callbacks will be handled here\n        executeCallback.call(this, data, 'contextmenu');\n      })\n      .on('click', function(d) {\n        let data = d.data || d;\n        // TODO make some sense of selection on nodes\n        d.selected = !d.selected;\n        // any callbacks will be handled here\n        executeCallback.call(this, data, 'click');\n      })\n      .on('dblclick', function(d) {\n        let data = d.data || d;\n        // any callbacks will be handled here\n        executeCallback.call(this, data, 'dblclick');\n      })\n      .on('mouseover', function(d) {\n        let data = d.data || d;\n        if (data.messages) {\n          // default, show tooltip\n          self.tooltip.load({messages: data.messages}, true).render();\n          // ok, this is almost a hack, because this should be rendered on\n          // the tooltip itself.. but because a tooltip gets only the messages \n          // object to render and not the whole this.data object, \n          // we can't check for the property canvas.texTypesetting, \n          // hence this:\n          self.mathjax.settings({appendTo: self.tooltip}).renderHTML();\n        } \n      })\n      .on('mouseout', function() {\n        // default, hide tooltip\n        self.tooltip.unrender();\n      });\n\n    function executeCallback(data, event) {\n      if (data.callbacks) {\n        Object.values(data.callbacks).forEach((cb) => {\n          // execute only the ones that match the event!\n          cb.trigger === event && self.callback.load({ callback: cb }, true).execute();\n        });\n      }\n    }\n  }\n  \n  static linkXPos(s, t) {\n    let angle = Math.atan2(t.y - s.y, t.x - s.x);\n    return Math.cos(angle) + (s.x + t.x)/2;\n  }\n    \n  static linkYPos(s, t) {\n    let angle = Math.atan2(t.y - s.y, t.x - s.x);\n    return Math.sin(angle) + (s.y + t.y) / 2;\n  }\n\n  static get colors() {\n    return d3.scaleSequential().domain([0, 100]).interpolator(d3.interpolateRainbow);\n  }\n\n  static getSymbol(type) {\n    \n    let element = undefined;\n    switch (type) {\n    case 'cross':\n      element = d3.symbolCross;\n      break;\n    case 'diamond':\n      element = d3.symbolDiamond;\n      break;\n    case 'square':\n      element = d3.symbolSquare;\n      break;\n    case 'triangle':\n      element = d3.symbolTriangle;\n      break;\n    case 'star':\n      element = d3.symbolStar;\n      break;\n    case 'wye':\n      element = d3.symbolWye;\n      break;\n    case 'circle':\n    default:\n      element = d3.symbolCircle;\n    }\n\n    return element;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/graph.js","import Renderer from './renderer';\nimport Callback from './callback';\n\nexport default class Menu extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  traverse(appendTo, menusIterator) {\n    while (menusIterator.hasNext()) {\n      let menuItem = menusIterator.next();\n      let entry = appendTo.append('li');\n      let action = entry.selectAll('a').data([menuItem]).enter().append('a').attr('title', menuItem.title).html(menuItem.title);\n      if (menuItem.callback && Object.values(menuItem.callback).length) {\n        action.on('click', (d) => new Callback(this.options).load(d, true).execute());\n      }\n      if (menuItem.menus && Object.values(menuItem.menus).length > 0) {\n        let content = entry.append('ul');\n        let subMenusIterator = this.iterator(Object.values(menuItem.menus));\n        this.traverse(content, subMenusIterator);\n      }\n    }\n  }\n\n  iterator(array) {\n    let nextIndex = 0;\n    return {\n      next: function() {\n        return this.hasNext() ? array[nextIndex++] : undefined;\n      },\n      hasNext: function() {\n        return nextIndex < array.length;\n      }\n    };\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/menu.js","import Base from './base';\nimport RequiredArgsModal from './modal-required';\nimport { requires } from '../util/data-decorator';\n\nexport default class CallbackHandler extends Base {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.callback = callbackHandler;\n  }\n\n  @requires('callback')\n  execute() {\n    if (Object.keys(this.data.callback.requiredArgs).length) {\n      let options = this.options;\n      options.callbackHandler = (callbackObj) => this._execute.call(this, callbackObj);\n      return new RequiredArgsModal(options).load(this.data, true).render();\n    }\n    \n    // Trigger is the expected command on GAP for this events!\n    this._execute(this.data.callback);\n    \n  }\n\n  _execute(calbackObj) {\n    this.callback(`Trigger(${JSON.stringify(JSON.stringify(calbackObj))});`);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/callback.js","import Renderer from './renderer';\n\n/* global d3 */\n\nexport default class Modal extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.overlay = undefined;\n    this.holder = undefined;\n  }\n  \n  _initialize() {\n    // we want to overlay everything, hence 'body' must be used\n    this.overlay = d3.select('body').append('div').attr('class', 'francy-overlay');\n    this.holder = d3.select('body').append('div').attr('class', 'francy');\n  }\n  \n  unrender() {\n    this.overlay.remove();\n    this.element.remove();\n    this.holder.remove();\n    return false;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/modal.js","import Logger from './logger';\n\n/* global Jupyter */\n\nexport function RegisterJupyterKeyboardEvents(classes) {\n  // disable keyboard shortcuts in Jupyter for specific css classed elements\n  if (!classes) return;\n  try {\n    classes.map((c) => {\n      Jupyter.keyboard_manager.register_events(c);\n    });\n  } catch (e) {\n    if (e.name === 'ReferenceError') {\n      new Logger().info('It seems we\\'re not running on Jupyter...', e);\n    }\n  }\n}\n\n// credits here: https://stackoverflow.com/questions/4810841/how-can-i-pretty-print-json-using-javascript#answer-7220510\nexport function syntaxHighlight(json) {\n  json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n  return json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)/g, (match) => {\n    let cls = 'number';\n    if (/^\"/.test(match)) {\n      if (/:$/.test(match)) {\n        cls = 'key';\n      } else {\n        cls = 'string';\n      }\n    } else if (/true|false/.test(match)) {\n      cls = 'boolean';\n    } else if (/null/.test(match)) {\n      cls = 'null';\n    }\n    return `<span class=\"${cls}\">${match}</span>`;\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/component.js","import Renderer from './renderer';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class Tooltip extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires('messages')\n  render() {\n\n    this.element = this.HTMLParent.select('div.francy-tooltip-holder');\n    // check if the window is already present\n    if (!this.element.node()) {\n      this.element = this.HTMLParent.append('div')\n        .attr('class', 'francy-tooltip-holder');\n    }\n\n    // check if it exists already\n    if (this.element.selectAll('*').node()) return;\n\n    let pos = d3.mouse(this.SVGParent.node());\n\n    // TODO this won't be visible all the times, fine until someone complains about :P\n    this.element.style('left', (pos[0] + 15) + 'px').style('top', (pos[1] - 15) + 'px');\n\n    let table = this.element.append('div').attr('class', 'francy-tooltip')\n      .append('div').attr('class', 'francy-table')\n      .append('div').attr('class', 'francy-table-body');\n\n    Object.keys(this.data.messages).map((key) => {\n      let row = table.append('div').attr('class', 'francy-table-row');\n      row.append('div').attr('class', 'francy-table-cell').text(this.data.messages[key].title);\n      row.append('div').attr('class', 'francy-table-cell').text(this.data.messages[key].text);\n    });\n\n    // show tooltip\n    this.element.style('display', 'block');\n\n    return this;\n  }\n\n  unrender() {\n    if (this.element) {\n      this.element.selectAll('*').remove();\n      this.element.style('display', null);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/tooltip.js","import Frame from './render/frame';\nimport Renderer from './render/renderer';\nimport { requires } from './util/data-decorator';\n\n/* global d3 */\n\nlet ALL_CANVAS = {};\n\n/**\n * Francy is the main entry point for the whole framework. By passing an input string/object to the {Francy.load} function,\n * Francy will handle the creation of that json as long it is a valid and understandable json object to Francy.\n *  \n * @access public\n * \n * @version 0.5.x\n * \n * @example\n * let francy = new Francy({verbose: true, appendTo: '#div-id', callbackHandler: console.log});\n * francy.load(json).render();\n */\nexport default class Francy extends Renderer {\n\n  /**\n   * Creates an instance of Francy with the following options:\n   * @typedef {Object} Options\n   * @property {Boolean} verbose prints extra log information to console.log, default false\n   * @property {Boolean} appendTo where the generated html/svg components will be attached to, default body\n   * @property {Function} callbackHandler this handler will be used to invoke actions from the menu, default console.log\n   */\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    if (!d3) {\n      throw new Error('D3 is not imported and Francy won\\'t work without it... please import D3 v4+ library.');\n    }\n  }\n\n  /**\n   * Main entry point. Calling render will trigger the drawing of a json object \n   * passed through the load method.\n   * @returns {Object} the html element created\n   */\n  @requires('canvas')\n  render() {\n    let frame = new Frame(this.options).load(this.data).render();\n    ALL_CANVAS[this.data.canvas.id] = frame;\n    return frame.element.node();\n  }\n\n  static unrender(id) {\n    delete ALL_CANVAS[id];\n  }\n}\n\ntry {\n  exports.Francy = window.Francy = Francy;\n  // handle events on resize\n  let oldResize = window.onresize;\n  window.onresize = () => {\n    // zoom to fit all canvas on resize\n    Object.values(ALL_CANVAS).forEach((frame) => {\n      frame.canvas.zoomToFit();\n    });\n    // call old resize function if any!\n    if (typeof oldResize === 'function') {\n      oldResize();\n    }\n  };\n} catch (e) {\n  exports.Francy = Francy;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/francy.js","import Composite from './composite';\nimport Canvas from './canvas';\nimport MainMenu from './menu-main';\nimport Message from './message';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class Frame extends Composite {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.canvas = new Canvas(this.options);\n    this.menu = new MainMenu(this.options);\n    this.messages = new Message(this.options);\n    this.add(this.menu).add(this.canvas).add(this.messages);\n  }\n\n  @requires('canvas')\n  render() {\n    let parent = this.options.appendTo;\n\n    const frameId = `Frame-${this.data.canvas.id}`;\n    this.element = d3.select(`div#${frameId}`);\n    // check if the canvas is already present\n    if (!this.element.node()) {\n      // create a svg element detached from the DOM!\n      this.logger.debug(`Creating Frame [${frameId}]...`);\n      this.element = parent.append('div').attr('class', 'francy').attr('id', frameId);\n    }\n\n    // cannot continue if canvas is not present\n    if (!this.element.node()) {\n      throw new Error(`Oops, could not create frame with id [${frameId}]... Cannot proceed.`);\n    }\n\n    this.logger.debug(`Frame updated [${frameId}]...`);\n\n    this.renderChildren();\n\n    return this;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/frame.js","/**\n * This class contains methods to deal with JSON.\n */\nexport default class JsonUtils {\n\n  /**\n   * Parses an input nd checks whether this input is valid and returns a JSON object.\n   * @param input - the input to parse\n   * @param partial - if the input is not a complete Francy JSON Object, defaults to false\n   * @returns {json} - if the input is a valid JSON object, otherwise returns {undefined}\n   */\n  static parse(input, partial = false) {\n    if (!input) return;\n    if (typeof input === 'string') {\n      input = input.replace(/[\\n\\r\\b]+|(gap>)/g, '');\n      let jsonRegex = /{(?:[^])*}/g;\n      let match = jsonRegex.exec(input);\n      if (!match) return;\n      input = JSON.parse(match[0]);\n    }\n    return input.mime === JsonUtils.MIME || partial ? input : undefined;\n  }\n\n  /**\n   * Returns a static string representing the mime type supported by this package\n   */\n  static get MIME() {\n    return 'application/vnd.francy+json';\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/json-utils.js","import Base from './base';\nimport { enabled } from '../util/data-decorator';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global MathJax, d3 */\n\nlet initialized = false;\n\nexport default class MathJaxWrapper extends Base {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n  \n  _initialize() {\n    if (initialized) return;\n    MathJax.Hub.Config({\n      showMathMenu: false,\n      skipStartupTypeset: true,\n      tex2jax: {\n        inlineMath: [ ['$','$'], ['\\\\(','\\\\)'] ],\n        displayMath: [ ['$$','$$'], ['\\\\[','\\\\]'] ],\n        processEscapes: true,\n        processEnvironments: true\n      },\n      MathML: {\n        extensions: ['content-mathml.js']\n      },\n      displayAlign: 'center',\n      'HTML-CSS': {\n        availableFonts: [],\n        imageFont: null,\n        preferredFont: null,\n        font: 'STIX-Web', \n        webFont: 'STIX-Web',\n        styles: {'.MathJax_Display': {'margin': 0}},\n        linebreaks: { \n          automatic: true \n        }\n      },\n      'SVG': {\n        availableFonts: [],\n        imageFont: null,\n        preferredFont: null,\n        font: 'STIX-Web', \n        webFont: 'STIX-Web',\n        styles: {'.MathJax_Display': {'margin': 0}},\n        linebreaks: { \n          automatic: true \n        }\n      }\n    });\n\n    MathJax.Hub.Register.MessageHook('New Math', function(id) {\n      if (id && id.length > 1) {\n        var mathJaxElement = d3.select(`#${id[1]}-Frame`);\n        var svgMathJaxElement = mathJaxElement.select('svg');\n        if (svgMathJaxElement.node()) {\n          setTimeout(() => {\n            setTimeout(() => {\n              let width = svgMathJaxElement.node().width.baseVal.value;\n              svgMathJaxElement.attr('x', -width / 2);\n              svgMathJaxElement.attr('y', -15);\n            }, 50);\n            d3.select(mathJaxElement.node().parentNode.parentNode).append(function() {\n              return svgMathJaxElement.node();\n            });\n          }, 50);\n        }\n      }\n    });\n\n    MathJax.Hub.Configured();\n\n    initialized = true;\n  }\n\n  @initialize()\n  @enabled('canvas.texTypesetting')\n  renderSVG() {\n    // if no element here just return...\n    if (!this.parent || !this.parent.node()) return;\n    MathJax.Hub.Queue(\n      ['setRenderer', MathJax.Hub, 'SVG'],\n      ['Typeset', MathJax.Hub, this.parent.node()]\n    );\n  }\n  \n  @initialize()\n  @enabled('canvas.texTypesetting')\n  renderHTML() {\n    // if no element here just return...\n    if (!this.parent || !this.parent.node()) return;\n    MathJax.Hub.Queue(\n      ['setRenderer', MathJax.Hub, 'HTML-CSS'],\n      ['Typeset', MathJax.Hub, this.parent.node()],\n    );\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/mathjax-wrapper.js","import Composite from './composite';\nimport GraphFactory from './graph-factory';\nimport ChartFactory from './chart-factory';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class Canvas extends Composite {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.graphFactory = new GraphFactory(this.options);\n    this.chartFactory = new ChartFactory(this.options);\n    this.add(this.graphFactory).add(this.chartFactory);\n  }\n\n  @requires('canvas')\n  render() {\n    let content;\n    let zoom = d3.zoom();\n    let self = this;\n\n    function updateZoom(translateX, translateY, scale) {\n      self.element.call(zoom.transform, d3.zoomIdentity.translate(translateX, translateY).scale(scale, scale));\n    }\n\n    function zoomed() {\n      content.attr('transform', d3.event.transform);\n    }\n\n    function stopped() {\n      if (d3.event.defaultPrevented) {\n        d3.event.stopPropagation(); \n      }\n    }\n\n    function zoomToFit() {\n      // only execute if enable, of course\n      if (self.data.canvas.zoomToFit) {\n        let bounds = content.node().getBBox();\n\n        let clientBounds = self.element.node().getBoundingClientRect(),\n          fullWidth = clientBounds.right - clientBounds.left,\n          fullHeight = clientBounds.bottom - clientBounds.top;\n\n        let width = +bounds.width,\n          height = +bounds.height;\n\n        if (width === 0 || height === 0) return;\n\n        let midX = bounds.x + width / 2,\n          midY = bounds.y + height / 2;\n\n        let scale = 0.9 / Math.max(width / fullWidth, height / fullHeight);\n        let translateX = fullWidth / 2 - scale * midX,\n          translateY = fullHeight / 2 - scale * midY;\n\n        content.transition()\n          .duration(self.transitionDuration)\n          .attr('transform', `translate(${translateX},${translateY})scale(${scale},${scale})`)\n          .on('end', () => updateZoom(translateX, translateY, scale));\n      }\n    }\n\n    const canvasId = `Canvas-${this.data.canvas.id}`;\n    this.element = d3.select(`svg#${canvasId}`);\n    // check if the canvas is already present\n    if (!this.element.node()) {\n      // create a svg element detached from the DOM!\n      this.logger.debug(`Creating Canvas [${canvasId}]...`);\n      this.element = this.parent.append('svg')\n        .attr('class', 'francy-canvas')\n        .attr('id', canvasId);\n    }\n\n    // cannot continue if canvas is not present\n    if (!this.element.node()) {\n      throw new Error(`Oops, could not create canvas with id [${canvasId}]... Cannot proceed.`);\n    }\n\n    this.element.attr('width', this.data.canvas.width).attr('height', this.data.canvas.height);\n\n    content = this.element.select('g.francy-content');\n\n    if (!content.node()) {\n      content = this.element.append('g').attr('class', 'francy-content');\n      zoom.on('zoom', zoomed);\n      // remove zoom on double click!\n      this.element.call(zoom).on('dblclick.zoom', null);\n    }\n\n    this.element.on('click', stopped, true);\n\n    this.element.zoomToFit = this.zoomToFit = zoomToFit;\n\n    this.logger.debug(`Canvas updated [${canvasId}]...`);\n\n    this.renderChildren();\n\n    setTimeout(() => {\n      zoomToFit();\n    }, this.transitionDuration);\n\n    return this;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/canvas.js","import Renderer from './renderer';\nimport TreeGraph from './graph-tree';\nimport GenericGraph from './graph-generic';\nimport { requires } from '../util/data-decorator';\n\nexport default class Graph extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires('canvas.graph')\n  render() {\n\n    let element = undefined;\n    switch (this.data.canvas.graph.type) {\n    case 'tree':\n      element = new TreeGraph(this.options).load(this.data).render();\n      break;\n    default:\n      element = new GenericGraph(this.options).load(this.data).render();\n    }\n\n    return element;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/graph-factory.js","import Graph from './graph';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class TreeGraph extends Graph {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n\n    let i = 0,\n      root;\n\n    root = d3.hierarchy(this.treeData, d => d.children);\n    root.x0 = this.height / 2;\n    root.y0 = 0;\n\n    // compute height based on the depth of the graph\n    let levelWidth = [1];\n    let childCount = function (level, n) {\n\n      if (n.children && n.children.length > 0) {\n        if (levelWidth.length <= level + 1) levelWidth.push(0);\n\n        levelWidth[level + 1] += n.children.length;\n        n.children.forEach(function (d) {\n          childCount(level + 1, d);\n        });\n      }\n    };\n    childCount(0, root);\n    let newHeight = d3.max(levelWidth) * 100;\n\n    let treemap = d3.tree().size([newHeight, this.width]);\n\n    if (this.data.canvas.graph.collapsed) {\n      root.children.forEach(collapse);\n    }\n\n    update.call(this, root);\n\n    function collapse(d) {\n      if (d.children) {\n        d._children = d.children;\n        d._children.forEach(collapse);\n        d.children = null;\n      }\n    }\n\n    function update(source) {\n      let treeData = treemap(root);\n\n      let nodes = treeData.descendants(),\n        links = treeData.descendants().slice(1);\n\n      nodes.forEach(d => d.y = d.depth * 150);\n\n      let linkGroup = this.element.selectAll('g.francy-links');\n\n      if (!linkGroup.node()) {\n        linkGroup = this.element.append('g').attr('class', 'francy-links');\n      }\n\n      let link = linkGroup.selectAll('path.francy-edge')\n        .data(links, d => d.id || (d.id = ++i));\n\n      let linkEnter = link.enter()\n        .append('path').attr('class', 'francy-edge')\n        .attr('d', () => {\n          let o = {x: source.x0, y: source.y0};\n          return diagonal(o, o);\n        });\n\n      linkEnter.merge(link)\n        .transition().duration(this.transitionDuration).attr('d', d => diagonal(d, d.parent));\n\n      link.exit().transition().duration(this.transitionDuration)\n        .attr('d', () => {\n          let o = {x: source.x, y: source.y};\n          return diagonal(o, o);\n        }).remove();\n\n      linkGroup.selectAll('path.francy-edge')\n        .style('fill', 'none')\n        .style('stroke', '#ccc')\n        .style('stroke-width', '1px');\n\n      nodes.forEach((d) => {\n        d.x0 = d.x;\n        d.y0 = d.y;\n      });\n\n      function diagonal(s, d) {\n        return `M ${s.y} ${s.x}\n            C ${(s.y + d.y) / 2} ${s.x},\n              ${(s.y + d.y) / 2} ${d.x},\n              ${d.y} ${d.x}`;\n      }\n\n      let nodeGroup = this.element.selectAll('g.francy-nodes');\n\n      if (!nodeGroup.node()) {\n        nodeGroup = this.element.append('g').attr('class', 'francy-nodes');\n      }\n\n      let node = nodeGroup.selectAll('g.francy-node')\n        .data(nodes, d => d.id || (d.id = ++i));\n\n      let nodeEnter = node.enter().append('g')\n        .attr('class', 'francy-node')\n        .attr('transform', () => `translate(${source.y0},${source.x0})`);\n\n      nodeEnter.append('path')\n        .attr('d', d3.symbol().type(d => Graph.getSymbol(d.data.type)).size(d => d.data.size * 100))\n        .attr('class', 'francy-symbol');\n\n      nodeEnter.append('text')\n        .attr('class', 'francy-label')\n        .text(d => d.data.title)\n        .attr('x',  function() {\n          let bound = this.getBBox();\n          return -(bound.width / 2);\n        })\n        .style('cursor', d => d.children || d._children ? 'pointer' : 'default');\n\n      let nodeUpdate = nodeEnter.merge(node);\n\n      nodeUpdate.transition()\n        .duration(this.transitionDuration)\n        .attr('transform', d => `translate(${d.y},${d.x})`);\n\n      node.exit().transition().duration(this.transitionDuration)\n        .attr('transform', () => `translate(${source.y},${source.x})`)\n        .remove();\n\n      nodeGroup.selectAll('path.francy-symbol')\n        .style('fill', d => d.children || d._children ? 'lightsteelblue' : Graph.colors(d.data.layer * 5))\n        .style('cursor', d => d.children || d._children ? 'pointer' : 'default');\n\n      node = nodeGroup.selectAll('g.francy-node');\n      \n      if (node.node()) {\n        this._applyEvents(node);\n\n        let nodeOnClick = node.on('click');\n        node.on('click', (d) => {\n        // any callbacks will be handled here\n          nodeOnClick.call(this, d.data);\n          // default, highlight connected nodes\n          click.call(this, d);\n        });\n      }\n\n      // Toggle children on click.\n      let self = this;\n\n      function click(d) {\n        if (d.children) {\n          d._children = d.children;\n          d.children = null;\n        } else {\n          d.children = d._children;\n          d._children = null;\n        }\n        update.call(self, d);\n      }\n\n      setTimeout(() => {\n        this.parent.zoomToFit();\n      }, this.transitionDuration);\n    }\n\n    return this;\n\n  }\n\n  unrender() {}\n\n  /**\n   * Transforms flat data into tree data by analysing the parents of each node\n   * @returns {Object} the data transformed in tree data\n   */\n  get treeData() {\n    let canvasNodes = this.data.canvas.graph.nodes ? Object.values(this.data.canvas.graph.nodes) : [];\n    let dataMap = canvasNodes.reduce(function (map, node) {\n      map[node.id] = node;\n      return map;\n    }, {});\n    let treeData = [];\n    canvasNodes.forEach(function(node) {\n      let parent = dataMap[node.parent];\n      if (parent) {\n        (parent.children || (parent.children = [])).push(node);\n      } else {\n        treeData.push(node);\n      }\n    });\n    return treeData[0];\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/graph-tree.js","import Menu from './menu';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class ContextMenu extends Menu {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires('menus')\n  render() {\n\n    d3.event.preventDefault();\n\n    this.element = this.HTMLParent.select('div.francy-context-menu-holder');\n    // check if the menu holder is already present\n    if (!this.element.node()) {\n      this.element = this.HTMLParent.append('div')\n        .attr('class', 'francy-context-menu-holder');\n    }\n\n    let pos = d3.mouse(this.SVGParent.node());\n\n    this.element.style('left', pos[0] + 5 + 'px').style('top', pos[1] + 5 + 'px');\n\n    // show the context menu\n    this.element.style('display', 'block');\n\n    // check if it exists already\n    if (this.element.selectAll('*').node()) return;\n\n    // destroy menu\n    d3.select('body').on('click.francy-context-menu', () => this.unrender());\n\n    // this gets executed when a contextmenu event occurs\n    let menu = this.element.append('div').attr('class', 'francy-context-menu').append('ul');\n    let menusIterator = this.iterator(Object.values(this.data.menus));\n    this.traverse(menu, menusIterator);\n\n    return this;\n  }\n\n  unrender() {\n    if (this.element) {\n      this.element.selectAll('*').remove();\n      this.element.style('display', null);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/menu-context.js","import Modal from './modal';\nimport { RegisterJupyterKeyboardEvents } from '../util/component';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class RequiredArgsModal extends Modal {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n    let self = this;\n\n    let modalId = this.data.callback.id;\n\n    this.logger.debug(`Creating Callback Modal [${modalId}]...`);\n\n    this.element = this.holder.append('div')\n      .attr('id', modalId)\n      .attr('class', 'francy-modal');\n\n    let form = this.element.append('form');\n\n    let header = form.append('div').attr('class', 'francy-modal-header');\n\n    let headerTitle = header.append('span').html('Required arguments&nbsp;');\n    if (this.data.title) {\n      headerTitle.append('span').attr('style', 'font-weight: bold;').text(`for ${this.data.title}`);\n    }\n\n    let content = form.append('div').attr('class', 'francy-modal-content').append('div').attr('class', 'francy-table').append('div').attr('class', 'francy-table-body');\n\n    for (let arg of Object.values(this.data.callback.requiredArgs)) {\n      let row = content.append('div').attr('class', 'francy-table-row');\n      row.append('div').attr('class', 'francy-table-cell').append('label').attr('for', arg.id).text(arg.title);\n      let input = row.append('div').attr('class', 'francy-table-cell').append('input').attr('id', arg.id).attr('class', 'francy-arg')\n        .attr('required', '')\n        .attr('name', arg.id)\n        .attr('type', arg.type)\n        .attr('value', arg.value)\n        .on('change', function () {\n          self.data.callback.requiredArgs[this.id].value = this.value;\n        })\n        .on('input', this.onchange)\n        .on('keyup', this.onchange)\n        .on('paste', this.onchange);\n      // wait, if it is boolean we create a checkbox\n      if (arg.type === 'boolean') {\n        // well, a checkbox works this way so we need to initialize \n        // the value to false and update the value based on the checked \n        // property that triggers the onchange event\n        arg.value = arg.value || false;\n        input.attr('type', 'checkbox').attr('required', null)\n          .attr('value', arg.value)\n          .on('change', function() {\n            self.data.callback.requiredArgs[this.id].value = this.value = this.checked; \n          });\n      }\n      row.append('span').attr('class', 'validity');\n    }\n\n    let footer = form.append('div').attr('class', 'francy-modal-footer');\n\n    footer.append('button').text('Ok').on('click', () => {\n      if (form.node().checkValidity()) {\n        d3.event.preventDefault();\n        this.options.callbackHandler(this.data.callback);\n        this.unrender.call(this);\n      }\n      return false;\n    });\n    footer.append('button').text('Cancel').on('click', () => { \n      d3.event.preventDefault(); \n      this.unrender.call(this); \n    });\n\n    // disable keyboard shortcuts when using this modal in Jupyter\n    RegisterJupyterKeyboardEvents(['.francy', '.francy-arg', '.francy-overlay', '.francy-modal']);\n\n    let inputElement = content.selectAll('.francy-arg').node();\n    if (inputElement) {\n      inputElement.focus();\n    }\n\n    this.logger.debug(`Callback Modal updated [${modalId}]...`);\n\n    return this;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/modal-required.js","import Graph from './graph';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class GenericGraph extends Graph {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n    var self = this;\n    \n    let simulationActive = this.data.canvas.graph.simulation;\n    let radius = 0;\n\n    let canvasNodes = this.data.canvas.graph.nodes ? Object.values(this.data.canvas.graph.nodes) : [],\n      canvasLinks = this.data.canvas.graph.links ? Object.values(this.data.canvas.graph.links) : [];\n\n    let linkGroup = this.element.selectAll('g.francy-links');\n\n    if (!linkGroup.node()) {\n      linkGroup = this.element.append('g').classed('francy-links', true);\n    }\n\n    let links = linkGroup.selectAll('g.francy-link').data();\n    let linksToAdd = this._filterNewElements(canvasLinks, links);\n\n    let link = linkGroup.selectAll('g.francy-link').data(linksToAdd, d => d.id);\n\n    let nodeGroup = this.element.selectAll('g.francy-nodes');\n\n    if (!nodeGroup.node()) {\n      nodeGroup = this.element.append('g').classed('francy-nodes', true);\n    }\n\n    let nodes = nodeGroup.selectAll('g.francy-node').data();\n    let nodesToAdd = this._filterNewElements(canvasNodes, nodes);\n\n    let node = nodeGroup.selectAll('g.francy-node').data(nodesToAdd, d => d.id);\n\n    // this means no changes, so we can safely return\n    if (node.exit().data().length === 0 &&\n      node.enter().data().length === 0 &&\n      link.enter().data().length === 0 &&\n      link.exit().data().length === 0) return;\n\n    let linkEnter = link.enter().append('g')\n      .classed('francy-link', true);\n\n    linkEnter.append('line')\n      .classed('francy-edge', true)\n      .style('stroke-width', d => {\n        if (d.weight >= 3) {\n          d.weight = 3; d.pos = 15;\n        } else if (d.weight <= 1) {\n          d.weight = 1; d.pos = 28;\n        } else {\n          d.pos = 18;\n        }\n        return d.weight;\n      })\n      .style('stroke', d => d.color || undefined);\n\n    linkEnter.append('text')\n      .classed('francy-label', true)\n      .classed('francy-size10', true)\n      .text(d => d.title)\n      .attr('text-anchor', 'middle');\n\n    link.exit().remove();\n\n    link = linkGroup.selectAll('g.francy-link');\n\n    if (this.data.canvas.graph.type === 'directed') {\n      // this means we need arrows, so we append the marker\n      self.parent.append('defs').selectAll('marker')\n        .data(linksToAdd)\n        .enter().append('marker')\n        .classed('francy-arrows', true)\n        .attr('id', d => `arrow-${d.id}`)\n        .attr('viewBox', '0 0 12 12')\n        .attr('refX', d  => d.pos)\n        .attr('refY', 6)\n        .attr('markerHeight', 12)\n        .attr('markerWidth', 12)\n        .attr('markerUnits', 'strokeWidth')\n        .attr('orient', 'auto')\n        .append('path')\n        .attr('d', 'M2,2 L10,6 L2,10 L6,6 L2,2')\n        .style('fill', d => d.color || undefined);\n      // update the style of the link\n      link.selectAll('line.francy-edge').style('marker-end', d => `url(#arrow-${d.id})`);\n    }\n\n    let nodeEnter = node.enter().append('g')\n      .classed('francy-node', true)\n      .attr('id', d => d.id);\n\n    nodeEnter.append('path')\n      .attr('d', d3.symbol().type(d => Graph.getSymbol(d.type)).size(d => d.size * 100))\n      .style('fill', d => d.color || Graph.colors(d.layer * 5))\n      .classed('francy-symbol', true)\n      .classed('francy-highlight', d => d.highlight)\n      .classed('francy-context', d => Object.values(d.menus).length && Object.values(d.menus).length > 0);\n\n    nodeEnter.append('text')\n      .classed('francy-label', true)\n      .text(d => d.title)\n      .attr('x', function() {\n        // apply mathjax if this is the case\n        let text = d3.select(this);\n        if (text.text().startsWith('$') && text.text().endsWith('$')) {\n          self.mathjax.settings({appendTo: {element: text}}).renderSVG();\n        }\n        let bound = this.getBBox();\n        // check the widest label so that we use it as default radius for colisions\n        if (radius < bound.width) {\n          radius = bound.width;\n        }\n        return -(bound.width / 2);\n      });\n\n    node.exit().remove();\n\n    node = nodeGroup.selectAll('g.francy-node');\n\n    if (this.data.canvas.graph.drag) {\n      node.call(d3.drag()\n        .on('start', dragstarted)\n        .on('drag', dragged)\n        .on('end', dragended));\n    }\n\n    if (node && !node.empty()) {\n\n      this._applyEvents(node);\n\n      if (this.data.canvas.graph.showNeighbours) {\n        let nodeOnClick = node.on('click');\n        node.on('click', function(d) {\n          // default, highlight connected nodes\n          connectedNodes.call(this);\n          // any callbacks will be handled here\n          nodeOnClick.call(this, d);\n        });\n      }\n    }\n\n    if (simulationActive) {\n      //Canvas Forces\n      //let centerForce = d3.forceCenter().x(this.width / 2).y(this.height / 2);\n      let manyForce = d3.forceManyBody().strength(-canvasNodes.length * 75);\n      let linkForce = d3.forceLink(canvasLinks).id(d => d.id).distance(75);\n      let collideForce = d3.forceCollide().radius(radius/2).iterations(3);\n\n      //Generic gravity for the X position\n      let forceX = d3.forceX(this.width).strength(0.05);\n      //Generic gravity for the Y position - undirected/directed graphs fall here\n      let forceY = d3.forceY(-this.height).strength(0.25);\n\n      if (this.data.canvas.graph.type === 'hasse') {\n        //Generic gravity for the X position\n        //forceX = d3.forceX(this.width).strength(0.4);\n        //Strong y positioning based on layer to simulate the hasse diagram\n        forceY = d3.forceY(d => d.layer * 75).strength(1);\n      }\n\n      var simulation = d3.forceSimulation().nodes(nodesToAdd)\n        .force('charge', manyForce)\n        .force('link', linkForce)\n        //.force('center', centerForce)\n        .force('x', forceX)\n        .force('y', forceY)\n        .force('collide', collideForce)\n        .on('tick', ticked)\n        .on('end', function() {\n          // zoom to fit when simulation is over\n          self.parent.zoomToFit();\n        });\n\n      //force simulation restart\n      simulation.restart();\n    } else {\n      // well, simulation is off, apply fixed positions and zoom to fit now\n      ticked();\n      self.parent.zoomToFit();\n    }\n\n    function ticked() {\n      link.selectAll('line.francy-edge')\n        .attr('x1', d => d.source.x)\n        .attr('y1', d => d.source.y)\n        .attr('x2', d => d.target.x)\n        .attr('y2', d => d.target.y);\n\n      link.selectAll('text.francy-label')\n        .attr('x', function(d) { \n          return Graph.linkXPos(d.target, d.source); \n          \n        })\n        .attr('y', function(d) { \n          return Graph.linkYPos(d.target, d.source); \n        });\n\n      node.attr('transform', d => `translate(${d.x},${d.y})`);\n    }\n\n    // HIGHLIGHT\n    //Toggle stores whether the highlighting is on\n    let toggle = 0;\n    //Create an array logging what is connected to what\n    let linkedByIndex = {};\n\n    for (let i = 0; i < canvasNodes.length; i++) {\n      linkedByIndex[`${i},${i}`] = 1;\n    }\n\n    canvasLinks.forEach(function(d) {\n      linkedByIndex[`${d.source.index},${d.target.index}`] = 1;\n    });\n\n    function connectedNodes() {\n      //This function looks up whether a pair are neighbours\n      function neighboring(a, b) {\n        return linkedByIndex[`${a.index},${b.index}`];\n      }\n      d3.event.preventDefault();\n      if (toggle === 0) {\n        //Reduce the opacity of all but the neighbouring nodes\n        let d = d3.select(this).node().__data__;\n        node.style('opacity', o => neighboring(d, o) || neighboring(o, d) ? 1 : 0.1);\n        link.style('opacity', o => d.index === o.source.index || d.index === o.target.index ? 1 : 0.1);\n        //Reduce the op\n        toggle = 1;\n      } else {\n        //Put them back to opacity=1\n        node.style('opacity', 1);\n        link.style('opacity', 1);\n        toggle = 0;\n      }\n    }\n\n    function dragstarted(d) {\n      if (!d3.event.active && simulationActive) {\n        simulation.alphaTarget(0.01).restart();\n      }\n      d.fx = d.x;\n      d.fy = d.y;\n    }\n\n    function dragged(d) {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    }\n\n    function dragended(d) {\n      if (!d3.event.active && simulationActive) {\n        simulation.alphaTarget(0);\n      }\n      d.fx = null;\n      d.fy = null;\n    }\n\n    return this;\n\n  }\n\n  unrender() {}\n  \n  _filterNewElements(canvasObjects, d3Element) {\n    let newElements = [];\n    canvasObjects.forEach(o => {\n      let link = d3Element.find(d => d.id === o.id);\n      if (link) {\n        newElements.push(link);\n      } else {\n        newElements.push(o);\n      }\n    });\n    return newElements;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/graph-generic.js","import Renderer from './renderer';\nimport BarChart from './chart-bar';\nimport LineChart from './chart-line';\nimport ScatterChart from './chart-scatter';\nimport { requires } from '../util/data-decorator';\n\nexport default class ChartFactory extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires('canvas.chart')\n  render() {\n    \n    let element = undefined;\n    switch (this.data.canvas.chart.type) {\n    case 'bar':\n      element = new BarChart(this.options).load(this.data).render();\n      break;\n    case 'line':\n      element = new LineChart(this.options).load(this.data).render();\n      break;\n    case 'scatter':\n      element = new ScatterChart(this.options).load(this.data).render();\n      break;\n    }\n\n    return element;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart-factory.js","import Chart from './chart';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class BarChart extends Chart {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n    \n    this.xScale = d3.scaleBand().range([0, this.width]).padding(0.1).domain(this.axis.x.domain);\n\n    if (!this.axis.x.domain.length) {\n      this.axis.x.domain = Chart.domainRange(this.allValues.length / this.datasetNames.length);\n      this.xScale.domain(this.axis.x.domain);\n    }\n\n    let barsGroup = this.element.selectAll('g.francy-bars');\n\n    if (!barsGroup.node()) {\n      barsGroup = this.element.append('g').attr('class', 'francy-bars');\n    }\n\n    var self = this;\n    \n    this.datasetNames.forEach(function(key, index) {\n      let bar = barsGroup.selectAll(`.francy-bar-${index}`).data(self.datasets[key]);\n\n      bar.exit().transition().duration(750)\n        .style('fill-opacity', 1e-6)\n        .remove();\n\n      // append the rectangles for the bar chart\n      let barEnter = bar.enter()\n        .append('rect')\n        .style('fill', () => Chart.colors(index * 5))\n        .attr('class', `francy-bar-${index}`)\n        .attr('x', function(d, i) {\n          return self.xScale(self.axis.x.domain[i]) + index * (self.xScale.bandwidth() / self.datasetNames.length);\n        })\n        .attr('width', (self.xScale.bandwidth() / self.datasetNames.length) - 1)\n        .attr('y', function(d) {\n          return self.yScale(d);\n        })\n        .attr('height', function(d) {\n          return self.height - self.yScale(d);\n        })\n        .on('mouseenter', function(d) {\n          d3.select(this).transition()\n            .duration(250).style('fill-opacity', 0.5);\n          self.tooltip.load(Chart.tooltip(key, d), true).render();\n        })\n        .on('mouseleave', function() {\n          d3.select(this).transition()\n            .duration(250).style('fill-opacity', 1);\n          self.tooltip.unrender();\n        });\n\n      barEnter.merge(bar)\n        .attr('x', function(d, i) {\n          return self.xScale(self.axis.x.domain[i]) + index * (self.xScale.bandwidth() / self.datasetNames.length); \n        })\n        .attr('width', (self.xScale.bandwidth() / self.datasetNames.length) - 1)\n        .attr('y', function(d) {\n          return self.yScale(d); \n        })\n        .attr('height', function(d) {\n          return self.height - self.yScale(d); \n        });\n    });\n\n    this._renderAxis();\n    this._renderLegend();\n\n    return this;\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart-bar.js","import Chart from './chart';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class LineChart extends Chart {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n    \n    let linesGroup = this.element.selectAll('g.francy-lines');\n\n    if (!linesGroup.node()) {\n      linesGroup = this.element.append('g').attr('class', 'francy-lines');\n    }\n\n    var self = this;\n    \n    this.datasetNames.forEach(function(key, index) {\n      let valueLine = d3.line()\n        .x(function(d, i) {\n          return self.xScale(i);\n        })\n        .y(function(d) {\n          return self.yScale(d);\n        });\n\n      let line = linesGroup.selectAll(`.francy-line-${index}`).data([self.datasets[key]]);\n\n      line.exit().transition().duration(750)\n        .style('fill-opacity', 1e-6)\n        .remove();\n\n      // append the rectangles for the bar chart\n      let lineEnter = line.enter()\n        .append('path')\n        .style('stroke', () => Chart.colors(index * 5))\n        .style('stroke-width', '5px')\n        .attr('class', `francy-line-${index}`)\n        .attr('d', valueLine)\n        .on('mouseenter', function(d) {\n          d3.select(this).transition()\n            .duration(250)\n            .style('stroke-opacity', 0.5)\n            .style('stroke-width', '10px');\n          self.tooltip.load(Chart.tooltip(key, d), true).render();\n        })\n        .on('mouseleave', function() {\n          d3.select(this).transition()\n            .duration(250)\n            .style('stroke-opacity', 1)\n            .style('stroke-width', '5px');\n          self.tooltip.unrender();\n        });\n\n      lineEnter.merge(line);\n    });\n\n    this._renderAxis();\n    this._renderLegend();\n\n    return this;\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart-line.js","import Chart from './chart';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class ScatterChart extends Chart {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n\n    let scatterGroup = this.element.selectAll('g.francy-scatters');\n\n    if (!scatterGroup.node()) {\n      scatterGroup = this.element.append('g').attr('class', 'francy-scatters');\n    }\n    \n    let self = this;\n\n    this.datasetNames.forEach(function(key, index) {\n      let scatter = scatterGroup.selectAll(`.francy-scatter-${index}`).data(self.datasets[key]);\n\n      scatter.exit().transition().duration(750)\n        .style('fill-opacity', 1e-6)\n        .remove();\n\n      // append the rectangles for the bar chart\n      let scatterEnter = scatter\n        .enter()\n        .append('circle')\n        .style('fill', () => Chart.colors(index * 5))\n        .attr('class', `francy-scatter-${index}`)\n        .attr('r', 5)\n        .attr('cx', function(d, i) {\n          return self.xScale(i);\n        })\n        .attr('cy', function(d) {\n          return self.yScale(d);\n        })\n        .on('mouseenter', function(d) {\n          d3.select(this).transition()\n            .duration(250)\n            .style('fill-opacity', 0.5)\n            .attr('r', 10);\n          self.tooltip.load(Chart.tooltip(key, d), true).render();\n        })\n        .on('mouseleave', function() {\n          d3.select(this).transition()\n            .duration(250)\n            .style('fill-opacity', 1)\n            .attr('r', 5);\n          self.tooltip.unrender();\n        });\n\n      scatterEnter.merge(scatter);\n    });\n\n    this._renderAxis();\n\n    this._renderLegend();\n\n    return this;\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart-scatter.js","import Menu from './menu';\nimport AboutModal from './modal-about';\nimport * as SvgToPng from '../../node_modules/save-svg-as-png/saveSvgAsPng';\n\n/* global d3 window */\n\nexport default class MainMenu extends Menu {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  render() {\n    let aboutModal = new AboutModal(this.options);\n\n    // Otherwise clashes with the canvas itself!\n    const menuId = `MainMenu-${this.data.canvas.id}`;\n    this.element = d3.select(`#${menuId}`);\n\n    // Check if the menu is already present\n    if (!this.element.node()) {\n      // create a div element detached from the DOM!\n      this.logger.debug(`Creating Main Menu [${menuId}]...`);\n      this.element = this.parent.append('div').attr('class', 'francy-main-menu-holder').attr('id', menuId);\n    }\n\n    // Force rebuild menu again\n    this.element.selectAll('*').remove();\n\n    this.element = this.element.append('ul').attr('class', 'francy-main-menu');\n\n    if (this.data.canvas.title) {\n      this.element.append('li').attr('class', 'francy-title').append('a').html(this.data.canvas.title);\n    }\n\n    let entry = this.element.append('li');\n    entry.append('a').html('Francy');\n    let content = entry.append('ul');\n    content.append('li').append('a').on('click', () => this.options.appendTo.canvas.zoomToFit()).attr('title', 'Zoom to Fit').html('Zoom to Fit');\n    content.append('li').append('a').on('click', () => SvgToPng.saveSvgAsPng(this.SVGParent.node(), 'diagram.png')).attr('title', 'Save to PNG').html('Save to PNG');\n    content.append('li').append('a').on('click', () => aboutModal.load(this.data).render()).attr('title', 'About').html('About');\n\n    // Traverse all menus and flatten them!\n    let menusIterator = this.iterator(Object.values(this.data.canvas.menus));\n    this.traverse(this.element, menusIterator);\n\n    this.logger.debug(`Main Menu updated [${menuId}]...`);\n\n    return this;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/menu-main.js","import Modal from './modal';\nimport { RegisterJupyterKeyboardEvents, syntaxHighlight } from '../util/component';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class AboutModal extends Modal {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n\n    let modalId = 'AboutModalWindow';\n\n    this.logger.debug(`Creating About Modal [${modalId}]...`);\n\n    this.element = this.holder.append('div')\n      .attr('id', modalId)\n      .attr('class', 'francy-modal');\n\n    let form = this.element.append('form');\n\n    let header = form.append('div').attr('class', 'francy-modal-header');\n\n    header.append('span').html(`About Francy v${this.data.version || 'N/A'}`);\n\n    let content = form.append('div').attr('class', 'francy-modal-content')\n      .append('div').attr('class', 'francy-table')\n      .append('div').attr('class', 'francy-table-body');\n\n    content.append('span').text('Loaded Object:');\n    content.append('pre').attr('class', 'francy').html(syntaxHighlight(JSON.stringify(this.data.canvas, null, 2)));\n    content.append('span').append('a').attr('href', 'https://github.com/mcmartins/francy').text('Francy on Github');\n\n    let footer = form.append('div').attr('class', 'francy-modal-footer');\n\n    footer.append('button').text('Ok').on('click', () => { \n      d3.event.preventDefault(); \n      this.unrender.call(this); \n    });\n\n    // disable keyboard shortcuts when using this modal in Jupyter\n    RegisterJupyterKeyboardEvents(['.francy', '.francy-arg', '.francy-overlay', '.francy-modal']);\n\n    this.logger.debug(`Callback About updated [${modalId}]...`);\n\n    return this;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/modal-about.js","(function() {\n  var out$ = typeof exports != 'undefined' && exports || typeof define != 'undefined' && {} || this;\n\n  var doctype = '<?xml version=\"1.0\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\" [<!ENTITY nbsp \"&#160;\">]>';\n\n  function isElement(obj) {\n    return obj instanceof HTMLElement || obj instanceof SVGElement;\n  }\n\n  function requireDomNode(el) {\n    if (!isElement(el)) {\n      throw new Error('an HTMLElement or SVGElement is required; got ' + el);\n    }\n  }\n\n  function isExternal(url) {\n    return url && url.lastIndexOf('http',0) == 0 && url.lastIndexOf(window.location.host) == -1;\n  }\n\n  function inlineImages(el, callback) {\n    requireDomNode(el);\n\n    var images = el.querySelectorAll('image'),\n        left = images.length,\n        checkDone = function() {\n          if (left === 0) {\n            callback();\n          }\n        };\n\n    checkDone();\n    for (var i = 0; i < images.length; i++) {\n      (function(image) {\n        var href = image.getAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\");\n        if (href) {\n          if (isExternal(href.value)) {\n            console.warn(\"Cannot render embedded images linking to external hosts: \"+href.value);\n            return;\n          }\n        }\n        var canvas = document.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        var img = new Image();\n        img.crossOrigin=\"anonymous\";\n        href = href || image.getAttribute('href');\n        if (href) {\n          img.src = href;\n          img.onload = function() {\n            canvas.width = img.width;\n            canvas.height = img.height;\n            ctx.drawImage(img, 0, 0);\n            image.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\", canvas.toDataURL('image/png'));\n            left--;\n            checkDone();\n          }\n          img.onerror = function() {\n            console.log(\"Could not load \"+href);\n            left--;\n            checkDone();\n          }\n        } else {\n          left--;\n          checkDone();\n        }\n      })(images[i]);\n    }\n  }\n\n  function styles(el, options, cssLoadedCallback) {\n    var selectorRemap = options.selectorRemap;\n    var modifyStyle = options.modifyStyle;\n    var css = \"\";\n    // each font that has extranl link is saved into queue, and processed\n    // asynchronously\n    var fontsQueue = [];\n    var sheets = document.styleSheets;\n    for (var i = 0; i < sheets.length; i++) {\n      try {\n        var rules = sheets[i].cssRules;\n      } catch (e) {\n        console.warn(\"Stylesheet could not be loaded: \"+sheets[i].href);\n        continue;\n      }\n\n      if (rules != null) {\n        for (var j = 0, match; j < rules.length; j++, match = null) {\n          var rule = rules[j];\n          if (typeof(rule.style) != \"undefined\") {\n            var selectorText;\n\n            try {\n              selectorText = rule.selectorText;\n            } catch(err) {\n              console.warn('The following CSS rule has an invalid selector: \"' + rule + '\"', err);\n            }\n\n            try {\n              if (selectorText) {\n                match = el.querySelector(selectorText) || el.parentNode.querySelector(selectorText);\n              }\n            } catch(err) {\n              console.warn('Invalid CSS selector \"' + selectorText + '\"', err);\n            }\n\n            if (match) {\n              var selector = selectorRemap ? selectorRemap(rule.selectorText) : rule.selectorText;\n              var cssText = modifyStyle ? modifyStyle(rule.style.cssText) : rule.style.cssText;\n              css += selector + \" { \" + cssText + \" }\\n\";\n            } else if(rule.cssText.match(/^@font-face/)) {\n              // below we are trying to find matches to external link. E.g.\n              // @font-face {\n              //   // ...\n              //   src: local('Abel'), url(https://fonts.gstatic.com/s/abel/v6/UzN-iejR1VoXU2Oc-7LsbvesZW2xOQ-xsNqO47m55DA.woff2);\n              // }\n              //\n              // This regex will save extrnal link into first capture group\n              var fontUrlRegexp = /url\\([\"']?(.+?)[\"']?\\)/;\n              // TODO: This needs to be changed to support multiple url declarations per font.\n              var fontUrlMatch = rule.cssText.match(fontUrlRegexp);\n\n              var externalFontUrl = (fontUrlMatch && fontUrlMatch[1]) || '';\n              var fontUrlIsDataURI = externalFontUrl.match(/^data:/);\n              if (fontUrlIsDataURI) {\n                // We should ignore data uri - they are already embedded\n                externalFontUrl = '';\n              }\n\n              if (externalFontUrl) {\n                // okay, we are lucky. We can fetch this font later\n\n                //handle url if relative\n                if (externalFontUrl.startsWith('../')) {\n                  externalFontUrl = sheets[i].href + '/../' + externalFontUrl\n                } else if (externalFontUrl.startsWith('./')) {\n                  externalFontUrl = sheets[i].href + '/.' + externalFontUrl\n                }\n\n                fontsQueue.push({\n                  text: rule.cssText,\n                  // Pass url regex, so that once font is downladed, we can run `replace()` on it\n                  fontUrlRegexp: fontUrlRegexp,\n                  format: getFontMimeTypeFromUrl(externalFontUrl),\n                  url: externalFontUrl\n                });\n              } else {\n                // otherwise, use previous logic\n                css += rule.cssText + '\\n';\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Now all css is processed, it's time to handle scheduled fonts\n    processFontQueue(fontsQueue);\n\n    function getFontMimeTypeFromUrl(fontUrl) {\n      var supportedFormats = {\n        'woff2': 'font/woff2',\n        'woff': 'font/woff',\n        'otf': 'application/x-font-opentype',\n        'ttf': 'application/x-font-ttf',\n        'eot': 'application/vnd.ms-fontobject',\n        'sfnt': 'application/font-sfnt',\n        'svg': 'image/svg+xml'\n      };\n      var extensions = Object.keys(supportedFormats);\n      for (var i = 0; i < extensions.length; ++i) {\n        var extension = extensions[i];\n        // TODO: This is not bullet proof, it needs to handle edge cases...\n        if (fontUrl.indexOf('.' + extension) > 0) {\n          return supportedFormats[extension];\n        }\n      }\n\n      // If you see this error message, you probably need to update code above.\n      console.error('Unknown font format for ' + fontUrl+ '; Fonts may not be working correctly');\n      return 'application/octet-stream';\n    }\n\n    function processFontQueue(queue) {\n      if (queue.length > 0) {\n        // load fonts one by one until we have anything in the queue:\n        var font = queue.pop();\n        processNext(font);\n      } else {\n        // no more fonts to load.\n        cssLoadedCallback(css);\n      }\n\n      function processNext(font) {\n        // TODO: This could benefit from caching.\n        var oReq = new XMLHttpRequest();\n        oReq.addEventListener('load', fontLoaded);\n        oReq.addEventListener('error', transferFailed);\n        oReq.addEventListener('abort', transferFailed);\n        oReq.open('GET', font.url);\n        oReq.responseType = 'arraybuffer';\n        oReq.send();\n\n        function fontLoaded() {\n          // TODO: it may be also worth to wait until fonts are fully loaded before\n          // attempting to rasterize them. (e.g. use https://developer.mozilla.org/en-US/docs/Web/API/FontFaceSet )\n          var fontBits = oReq.response;\n          var fontInBase64 = arrayBufferToBase64(fontBits);\n          updateFontStyle(font, fontInBase64);\n        }\n\n        function transferFailed(e) {\n          console.warn('Failed to load font from: ' + font.url);\n          console.warn(e)\n          css += font.text + '\\n';\n          processFontQueue();\n        }\n\n        function updateFontStyle(font, fontInBase64) {\n          var dataUrl = 'url(\"data:' + font.format + ';base64,' + fontInBase64 + '\")';\n          css += font.text.replace(font.fontUrlRegexp, dataUrl) + '\\n';\n\n          // schedule next font download on next tick.\n          setTimeout(function() {\n            processFontQueue(queue)\n          }, 0);\n        }\n\n      }\n    }\n\n    function arrayBufferToBase64(buffer) {\n      var binary = '';\n      var bytes = new Uint8Array(buffer);\n      var len = bytes.byteLength;\n\n      for (var i = 0; i < len; i++) {\n          binary += String.fromCharCode(bytes[i]);\n      }\n\n      return window.btoa(binary);\n    }\n  }\n\n  function getDimension(el, clone, dim) {\n    var v = (el.viewBox && el.viewBox.baseVal && el.viewBox.baseVal[dim]) ||\n      (clone.getAttribute(dim) !== null && !clone.getAttribute(dim).match(/%$/) && parseInt(clone.getAttribute(dim))) ||\n      el.getBoundingClientRect()[dim] ||\n      parseInt(clone.style[dim]) ||\n      parseInt(window.getComputedStyle(el).getPropertyValue(dim));\n    return (typeof v === 'undefined' || v === null || isNaN(parseFloat(v))) ? 0 : v;\n  }\n\n  function reEncode(data) {\n    data = encodeURIComponent(data);\n    data = data.replace(/%([0-9A-F]{2})/g, function(match, p1) {\n      var c = String.fromCharCode('0x'+p1);\n      return c === '%' ? '%25' : c;\n    });\n    return decodeURIComponent(data);\n  }\n\n  out$.prepareSvg = function(el, options, cb) {\n    requireDomNode(el);\n\n    options = options || {};\n    options.scale = options.scale || 1;\n    options.responsive = options.responsive || false;\n    var xmlns = \"http://www.w3.org/2000/xmlns/\";\n\n    inlineImages(el, function() {\n      var outer = document.createElement(\"div\");\n      var clone = el.cloneNode(true);\n      var width, height;\n      if(el.tagName == 'svg') {\n        width = options.width || getDimension(el, clone, 'width');\n        height = options.height || getDimension(el, clone, 'height');\n      } else if(el.getBBox) {\n        var box = el.getBBox();\n        width = box.x + box.width;\n        height = box.y + box.height;\n        clone.setAttribute('transform', clone.getAttribute('transform').replace(/translate\\(.*?\\)/, ''));\n\n        var svg = document.createElementNS('http://www.w3.org/2000/svg','svg')\n        svg.appendChild(clone)\n        clone = svg;\n      } else {\n        console.error('Attempted to render non-SVG element', el);\n        return;\n      }\n\n      clone.setAttribute(\"version\", \"1.1\");\n      if (!clone.getAttribute('xmlns')) {\n        clone.setAttributeNS(xmlns, \"xmlns\", \"http://www.w3.org/2000/svg\");\n      }\n      if (!clone.getAttribute('xmlns:xlink')) {\n        clone.setAttributeNS(xmlns, \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n      }\n\n      if (options.responsive) {\n        clone.removeAttribute('width');\n        clone.removeAttribute('height');\n        clone.setAttribute('preserveAspectRatio', 'xMinYMin meet');\n      } else {\n        clone.setAttribute(\"width\", width * options.scale);\n        clone.setAttribute(\"height\", height * options.scale);\n      }\n\n      clone.setAttribute(\"viewBox\", [\n        options.left || 0,\n        options.top || 0,\n        width,\n        height\n      ].join(\" \"));\n\n      var fos = clone.querySelectorAll('foreignObject > *');\n      for (var i = 0; i < fos.length; i++) {\n        if (!fos[i].getAttribute('xmlns')) {\n          fos[i].setAttributeNS(xmlns, \"xmlns\", \"http://www.w3.org/1999/xhtml\");\n        }\n      }\n\n      outer.appendChild(clone);\n\n      // In case of custom fonts we need to fetch font first, and then inline\n      // its url into data-uri format (encode as base64). That's why style\n      // processing is done asynchonously. Once all inlining is finshed\n      // cssLoadedCallback() is called.\n      styles(el, options, cssLoadedCallback);\n\n      function cssLoadedCallback(css) {\n        // here all fonts are inlined, so that we can render them properly.\n        var s = document.createElement('style');\n        s.setAttribute('type', 'text/css');\n        s.innerHTML = \"<![CDATA[\\n\" + css + \"\\n]]>\";\n        var defs = document.createElement('defs');\n        defs.appendChild(s);\n        clone.insertBefore(defs, clone.firstChild);\n\n        if (cb) {\n          var outHtml = outer.innerHTML;\n          outHtml = outHtml.replace(/NS\\d+:href/gi, 'xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href');\n          cb(outHtml, width, height);\n        }\n      }\n    });\n  }\n\n  out$.svgAsDataUri = function(el, options, cb) {\n    out$.prepareSvg(el, options, function(svg) {\n      var uri = 'data:image/svg+xml;base64,' + window.btoa(reEncode(doctype + svg));\n      if (cb) {\n        cb(uri);\n      }\n    });\n  }\n\n  out$.svgAsPngUri = function(el, options, cb) {\n    requireDomNode(el);\n\n    options = options || {};\n    options.encoderType = options.encoderType || 'image/png';\n    options.encoderOptions = options.encoderOptions || 0.8;\n\n    var convertToPng = function(src, w, h) {\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      canvas.width = w;\n      canvas.height = h;\n\n      if(options.canvg) {\n        options.canvg(canvas, src);\n      } else {\n        context.drawImage(src, 0, 0);\n      }\n\n      if(options.backgroundColor){\n        context.globalCompositeOperation = 'destination-over';\n        context.fillStyle = options.backgroundColor;\n        context.fillRect(0, 0, canvas.width, canvas.height);\n      }\n\n      var png;\n      try {\n        png = canvas.toDataURL(options.encoderType, options.encoderOptions);\n      } catch (e) {\n        if ((typeof SecurityError !== 'undefined' && e instanceof SecurityError) || e.name == \"SecurityError\") {\n          console.error(\"Rendered SVG images cannot be downloaded in this browser.\");\n          return;\n        } else {\n          throw e;\n        }\n      }\n      cb(png);\n    }\n\n    if(options.canvg) {\n      out$.prepareSvg(el, options, convertToPng);\n    } else {\n      out$.svgAsDataUri(el, options, function(uri) {\n        var image = new Image();\n\n        image.onload = function() {\n          convertToPng(image, image.width, image.height);\n        }\n\n        image.onerror = function() {\n          console.error(\n            'There was an error loading the data URI as an image on the following SVG\\n',\n            window.atob(uri.slice(26)), '\\n',\n            \"Open the following link to see browser's diagnosis\\n\",\n            uri);\n        }\n\n        image.src = uri;\n      });\n    }\n  }\n\n  out$.download = function(name, uri) {\n    if (navigator.msSaveOrOpenBlob) {\n      navigator.msSaveOrOpenBlob(uriToBlob(uri), name);\n    } else {\n      var saveLink = document.createElement('a');\n      var downloadSupported = 'download' in saveLink;\n      if (downloadSupported) {\n        saveLink.download = name;\n        saveLink.style.display = 'none';\n        document.body.appendChild(saveLink);\n        try {\n          var blob = uriToBlob(uri);\n          var url = URL.createObjectURL(blob);\n          saveLink.href = url;\n          saveLink.onclick = function() {\n            requestAnimationFrame(function() {\n              URL.revokeObjectURL(url);\n            })\n          };\n        } catch (e) {\n          console.warn('This browser does not support object URLs. Falling back to string URL.');\n          saveLink.href = uri;\n        }\n        saveLink.click();\n        document.body.removeChild(saveLink);\n      }\n      else {\n        window.open(uri, '_temp', 'menubar=no,toolbar=no,status=no');\n      }\n    }\n  }\n\n  function uriToBlob(uri) {\n    var byteString = window.atob(uri.split(',')[1]);\n    var mimeString = uri.split(',')[0].split(':')[1].split(';')[0]\n    var buffer = new ArrayBuffer(byteString.length);\n    var intArray = new Uint8Array(buffer);\n    for (var i = 0; i < byteString.length; i++) {\n      intArray[i] = byteString.charCodeAt(i);\n    }\n    return new Blob([buffer], {type: mimeString});\n  }\n\n  out$.saveSvg = function(el, name, options) {\n    requireDomNode(el);\n\n    options = options || {};\n    out$.svgAsDataUri(el, options, function(uri) {\n      out$.download(name, uri);\n    });\n  }\n\n  out$.saveSvgAsPng = function(el, name, options) {\n    requireDomNode(el);\n\n    options = options || {};\n    out$.svgAsPngUri(el, options, function(uri) {\n      out$.download(name, uri);\n    });\n  }\n\n  // if define is defined create as an AMD module\n  if (typeof define !== 'undefined') {\n    define(function() {\n      return out$;\n    });\n  }\n\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/save-svg-as-png/saveSvgAsPng.js","import Renderer from './renderer';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class Message extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires('canvas.messages')\n  render() {\n\n    let messages = Object.keys(this.data.canvas.messages).map((key) => {\n      return {\n        id: key,\n        type: this.data.canvas.messages[key].type,\n        title: this.data.canvas.messages[key].title,\n        text: this.data.canvas.messages[key].text\n      };\n    });\n\n    let alertsId = `Messages-${this.data.canvas.id}`;\n    this.element = d3.select(`#${alertsId}`);\n    // check if the div is already present\n    if (!this.element.node()) {\n      this.element = this.parent.append('div').attr('class', 'francy-message-holder').attr('id', alertsId);\n    }\n\n    let message = this.element.selectAll('div.francy-alert').data(messages, d => d.id);\n    let messageEnter = message.enter().append('div').attr('id', d => d.id)\n      .attr('class', d => `francy-alert alert-${d.type}`).on('click', function() {\n        d3.select(this).style('display', 'none');\n      });\n    messageEnter.append('span').attr('class', 'strong').text(d => d.title);\n    messageEnter.append('span').text(d => d.text);\n    messageEnter.append('span').attr('class', 'strong closeme').style('display', 'none').text('x');\n\n    messageEnter.merge(message);\n\n    message.exit().remove();\n\n    this.element.style('display', 'block');\n    \n    // render mathjax\n    this.mathjax.settings({appendTo: this}).renderHTML();\n\n    return this;\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/message.js"],"sourceRoot":""}