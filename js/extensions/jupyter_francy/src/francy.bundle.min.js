define(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(5),i=(r=o)&&r.__esModule?r:{default:r};var l=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler,i=e.options,l=void 0===i?{}:i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var c=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o,options:l}));if(new.target===t)throw new TypeError("Cannot construct [Renderer] instances directly!");if(void 0===c.render||"function"!=typeof c.render)throw new TypeError("Must override [render()] method!");return void 0===c.unrender&&c.logger.debug("No [unrender()] method specified..."),c.element=void 0,c.transitionDuration=750,c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),a(t,[{key:"_initialize",value:function(){}},{key:"HTMLParent",get:function(){return"svg"===this.options.appendTo.element.node().tagName.toLowerCase()?d3.select(this.options.appendTo.element.node().parentNode):this.options.appendTo.element}},{key:"SVGParent",get:function(){return"div"===this.options.appendTo.element.node().tagName.toLowerCase()?this.options.appendTo.element.select("svg"):this.options.appendTo.element}},{key:"parent",get:function(){return this.options.appendTo.element}},{key:"margin",get:function(){return{top:50,right:50,bottom:50,left:50}}},{key:"width",get:function(){return(+this.parent.attr("width")||d3.select("body").node().getBoundingClientRect().width)-this.margin.left-this.margin.right}},{key:"height",get:function(){return(+this.parent.attr("height")||d3.select("body").node().getBoundingClientRect().height)-this.margin.top-this.margin.bottom}}]),t}();t.default=l},function(e,t,n){"use strict";function r(e,t){var n=e;if(n&&t){var r=t.split("."),a=!0,o=!1,i=void 0;try{for(var l,c=r[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var u=l.value;if(!n.hasOwnProperty(u)){n=void 0;break}n=n[u]}}catch(e){o=!0,i=e}finally{try{!a&&c.return&&c.return()}finally{if(o)throw i}}}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.requires=function(e){return function(t,n,a){var o=a.value;return a.value=function(){var t;if((t=r(this.data,e))&&(t instanceof Array&&t.length||t instanceof Object&&Object.values(t).length))return o.apply(this,arguments);this.logger.debug("No data here ["+e+"], nothing to render... continuing...")},a}},t.enabled=function(e){return function(t,n,a){var o=a.value;return a.value=function(){if(r(this.data,e))return o.apply(this,arguments);this.logger.debug("No data here ["+e+"], nothing to render... continuing...")},a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){return function(e,t,n){var r=n.value;return n.value=function(){return this._initialize(),r.apply(this,arguments)},n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=i(n(0)),o=i(n(13));function i(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}));return i.axis=void 0,i.yScale=void 0,i.xScale=void 0,i.datasets=void 0,i.datasetNames=void 0,i.tooltip=void 0,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"_initialize",value:function(){var e=this;this.tooltip=new o.default(this.options),this.element=this.parent.select("g.francy-content"),this.axis=this.data.canvas.chart.axis,this.datasets=this.data.canvas.chart.data,this.datasetNames=Object.keys(this.datasets),this.xScale=d3.scaleLinear().range([0,this.width]).domain(this.axis.x.domain),this.yScale=d3.scaleLinear().range([this.height,0]).domain(this.axis.y.domain),this.allValues=[],this.datasetNames.forEach(function(t){return e.allValues=e.allValues.concat(e.datasets[t])}),this.axis.y.domain.length||this.yScale.domain([0,d3.max(this.allValues,function(e){return e})]),this.axis.x.domain.length||this.xScale.domain([0,this.allValues.length/this.datasetNames.length])}},{key:"_renderAxis",value:function(){var e=this.element.selectAll("g.francy-x-axis");e.node()||(e=this.element.append("g").attr("class","francy-x-axis")),e.selectAll("*").remove(),e.attr("transform","translate(0,"+this.height+")").call(d3.axisBottom(this.xScale)).append("text").attr("dy",50).attr("dx",this.width/2).attr("fill","black").attr("class","francy-axis").style("text-anchor","end").text(this.axis.x.title);var t=this.element.selectAll("g.francy-y-axis");t.node()||(t=this.element.append("g").attr("class","francy-y-axis")),t.selectAll("*").remove(),t.call(d3.axisLeft(this.yScale)).append("text").attr("dx",-50).attr("dy",this.height/2).attr("fill","black").attr("class","francy-axis").style("text-anchor","end").text(this.axis.y.title)}},{key:"_renderLegend",value:function(){if(this.data.canvas.chart.showLegend){var e=this.element.selectAll(".francy-legend");e.node()||(e=this.element.append("g").attr("class","francy-legend")),e.selectAll("*").remove();var n=e.selectAll("g").data(this.datasetNames.slice());n.exit().remove(),(n=n.enter().append("g").attr("transform",function(e,t){return"translate(0,"+20*t+")"}).merge(n)).append("rect").attr("x",this.width+20).attr("width",19).attr("height",19).style("fill",function(e,n){return t.colors(5*n)}),n.append("text").attr("x",this.width+80).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(e){return e})}}}],[{key:"tooltip",value:function(e,t){return{A:{title:"Dataset",text:e},B:{title:"Value",text:t}}}},{key:"domainRange",value:function(e){return Array.from(new Array(e),function(e,t){return t}).map(function(e){return e})}},{key:"colors",get:function(){return d3.scaleSequential().domain([0,100]).interpolator(d3.interpolateRainbow)}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=(r=o)&&r.__esModule?r:{default:r};var l=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}));if(new.target===t)throw new TypeError("Cannot construct [Composite] instances directly!");return i.renderers=[],i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),a(t,[{key:"add",value:function(e){return this.renderers.push(e),this}},{key:"renderChildren",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.renderers[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.settings({appendTo:this}).load(this.data).render()}}catch(e){t=!0,n=e}finally{try{!e&&a.return&&a.return()}finally{if(t)throw n}}}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=i(n(6)),o=i(n(16));function i(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){var n=t.verbose,r=void 0!==n&&n,o=t.appendTo,i=void 0===o?"body":o,l=t.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings({verbose:r,appendTo:i,callbackHandler:l}),this.log=new a.default(this.options)}return r(e,[{key:"settings",value:function(e){var t=e.verbose,n=e.appendTo,r=e.callbackHandler;if(this.options=this.options||{},!this.options.callbackHandler&&!r)throw new Error("A Callback Handler must be provided! This will be used to trigger events from the graphics produced...");if(!this.options.appendTo&&!n)throw new Error("Missing an element or id to append the graphics to...!");return"string"==typeof n&&(n=d3.select(n)),this.options.verbose=t||this.options.verbose,this.options.appendTo=n||this.options.appendTo,this.options.callbackHandler=r||this.options.callbackHandler,this}},{key:"load",value:function(e,t){var n=o.default.parse(e,t);return n&&(this.data=n),this}},{key:"logger",get:function(){return this.log}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var a=function(){function e(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).verbose,n=void 0!==t&&t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.verbose=n,this.console=console}return r(e,[{key:"debug",value:function(t){this.verbose&&this.console.debug(e._format("DEBUG",t))}},{key:"info",value:function(t){this.console.info(e._format("INFO",t))}},{key:"error",value:function(t,n){this.console.error(e._format("ERROR",t),n)}},{key:"warn",value:function(t,n){n=n||{},this.console.error(e._format("WARN",t),n)}}],[{key:"_format",value:function(e,t){return"["+e+"] - "+(new Date).toISOString()+" - "+t}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=u(n(0)),o=u(n(8)),i=u(n(20)),l=u(n(13)),c=u(n(10));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"_initialize",value:function(){this.element=this.parent.select("g.francy-content")}},{key:"_applyEvents",value:function(e){var t=this;if(e){var n=new l.default(this.options),r=new i.default(this.options),a=new c.default(this.options),u=new o.default(this.options);e.on("contextmenu",function(e){var t=e.data||e;r.load(t,!0).render(),s.call(this,t,"contextmenu")}).on("click",function(e){var t=e.data||e;s.call(this,t,"click")}).on("dblclick",function(e){var t=e.data||e;s.call(this,t,"dblclick")}).on("mouseover",function(e){var r=e.data||e;n.load(r.messages,!0).render(),u.settings({appendTo:n}).load(t.data).render()}).on("mouseout",function(){n.unrender()})}function s(e,t){e.callbacks&&Object.values(e.callbacks).forEach(function(e){e.trigger===t&&a.load({callback:e},!0).execute()})}}}],[{key:"getSymbol",value:function(e){var t=void 0;switch(e){case"cross":t=d3.symbolCross;break;case"diamond":t=d3.symbolDiamond;break;case"square":t=d3.symbolSquare;break;case"triangle":t=d3.symbolTriangle;break;case"star":t=d3.symbolStar;break;case"wye":t=d3.symbolWye;break;case"circle":default:t=d3.symbolCircle}return t}},{key:"colors",get:function(){return d3.scaleSequential().domain([0,100]).interpolator(d3.interpolateRainbow)}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),c=(o=l)&&o.__esModule?o:{default:o};var u,s,f,d,p,h,y=(r=(0,n(1).enabled)("canvas.texTypesetting"),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.default),i(t,[{key:"render",value:function(){this.element=this.options.appendTo.element;try{MathJax.Hub.Config({showMathMenu:!1,skipStartupTypeset:!0,tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],processEscapes:!0},"HTML-CSS":{font:"STIX-Web",linebreaks:{automatic:!0}},SVG:{font:"STIX-Web",linebreaks:{automatic:!0}}}),MathJax.Hub.Register.MessageHook("New Math",function(e){if(e&&e.length>1){var t=d3.select("#"+e[1]+"-Frame"),n=t.select("svg");n.node()&&setTimeout(function(){setTimeout(function(){var e=n.select("g").node().getBoundingClientRect();n.attr("x",-e.width/2),n.attr("y",-15)},10),d3.select(t.node().parentNode.parentNode).append(function(){return n.node()})},10)}});var e=this.element.select("svg");e.node()?MathJax.Hub.Queue(["setRenderer",MathJax.Hub,"SVG"],["Typeset",MathJax.Hub,e.node()],["setRenderer",MathJax.Hub,"HTML-CSS"],["Typeset",MathJax.Hub,this.element.node()]):MathJax.Hub.Queue(["setRenderer",MathJax.Hub,"HTML-CSS"],["Typeset",MathJax.Hub,this.element.node()]),MathJax.Hub.Configured()}catch(e){"ReferenceError"===e.name?this.logger.warn("It seems MathJax is not loaded...",e):this.logger.error("Not sure what happened :/",e)}}}]),t}(),u=a.prototype,s="render",f=[r],d=Object.getOwnPropertyDescriptor(a.prototype,"render"),p=a.prototype,h={},Object.keys(d).forEach(function(e){h[e]=d[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=f.slice().reverse().reduce(function(e,t){return t(u,s,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(u,s,h),h=null),a);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=i(n(0)),o=i(n(10));function i(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"traverse",value:function(e,t){for(var n=this;t.hasNext();){var r=t.next(),a=e.append("li"),i=a.selectAll("a").data([r]).enter().append("a").attr("title",r.title).html(r.title);if(r.callback&&Object.values(r.callback).length&&i.on("click",function(e){return new o.default(n.options).load(e,!0).execute()}),r.menus&&Object.values(r.menus).length>0){var l=a.append("ul"),c=this.iterator(Object.values(r.menus));this.traverse(l,c)}}}},{key:"iterator",value:function(e){var t=0;return{next:function(){return this.hasNext()?e[t++]:void 0},hasNext:function(){return t<e.length}}}},{key:"unrender",value:function(){}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(5)),l=c(n(21));function c(e){return e&&e.__esModule?e:{default:e}}var u,s,f,d,p,h,y=(r=(0,n(1).requires)("callback"),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}));return i.callback=o,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"execute",value:function(){var e=this;if(Object.keys(this.data.callback.requiredArgs).length){var t=this.options;return t.callbackHandler=function(t){return e._execute.call(e,t)},new l.default(t).load(this.data,!0).render()}this._execute(this.data.callback)}},{key:"_execute",value:function(e){this.callback("Trigger("+JSON.stringify(JSON.stringify(e))+");")}}]),t}(),u=a.prototype,s="execute",f=[r],d=Object.getOwnPropertyDescriptor(a.prototype,"execute"),p=a.prototype,h={},Object.keys(d).forEach(function(e){h[e]=d[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=f.slice().reverse().reduce(function(e,t){return t(u,s,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(u,s,h),h=null),a);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=(r=o)&&r.__esModule?r:{default:r};var l=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}));return i.overlay=void 0,i.holder=void 0,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),a(t,[{key:"_initialize",value:function(){this.overlay=d3.select("body").append("div").attr("class","francy-overlay"),this.holder=d3.select("body").append("div").attr("class","francy")}},{key:"unrender",value:function(){return this.overlay.remove(),this.element.remove(),this.holder.remove(),!1}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterJupyterKeyboardEvents=function(e){if(!e)return;try{e.map(function(e){Jupyter.keyboard_manager.register_events(e)})}catch(e){"ReferenceError"===e.name&&(new o.default).info("It seems we're not running on Jupyter...",e)}},t.syntaxHighlight=function(e){return(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?)/g,function(e){var t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),'<span class="'+t+'">'+e+"</span>"})};var r,a=n(6),o=(r=a)&&r.__esModule?r:{default:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),c=(o=l)&&o.__esModule?o:{default:o};var u,s,f,d,p,h,y=(r=(0,n(1).requires)(),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.default),i(t,[{key:"render",value:function(){if(this.element=this.HTMLParent.select("div.francy-tooltip-holder"),this.element.node()||(this.element=this.HTMLParent.append("div").attr("class","francy-tooltip-holder")),!this.element.selectAll("*").node()){var e=d3.mouse(this.SVGParent.node());this.element.style("left",e[0]+15+"px").style("top",e[1]-15+"px");var t=this.element.append("div").attr("class","francy-tooltip").append("div").attr("class","francy-table").append("div").attr("class","francy-table-body"),n=this;return Object.keys(this.data).map(function(e){var r=t.append("div").attr("class","francy-table-row");r.append("div").attr("class","francy-table-cell").text(n.data[e].title),r.append("div").attr("class","francy-table-cell").text(n.data[e].text)}),this.element.style("display","block"),this}}},{key:"unrender",value:function(){this.element&&(this.element.selectAll("*").remove(),this.element.style("display",null))}}]),t}(),u=a.prototype,s="render",f=[r],d=Object.getOwnPropertyDescriptor(a.prototype,"render"),p=a.prototype,h={},Object.keys(d).forEach(function(e){h[e]=d[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=f.slice().reverse().reduce(function(e,t){return t(u,s,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(u,s,h),h=null),a);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(15)),l=c(n(0));function c(e){return e&&e.__esModule?e:{default:e}}var u,s,f,d,p,h,y={},v=(r=(0,n(1).requires)("canvas"),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}));if(!d3)throw new Error("D3 is not imported! Francy won't work without it... please import D3 v4+.");return i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.default),o(t,[{key:"render",value:function(){var e=new i.default(this.options).load(this.data).render();return y[this.data.canvas.id]=e,e.element.node()}}],[{key:"unrender",value:function(e){delete y[e]}}]),t}(),u=a.prototype,s="render",f=[r],d=Object.getOwnPropertyDescriptor(a.prototype,"render"),p=a.prototype,h={},Object.keys(d).forEach(function(e){h[e]=d[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=f.slice().reverse().reduce(function(e,t){return t(u,s,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(u,s,h),h=null),a);t.default=v;try{t.Francy=window.Francy=v;var b=window.onresize;window.onresize=function(){Object.values(y).forEach(function(e){e.canvas.zoomToFit()}),"function"==typeof b&&b()}}catch(e){t.Francy=v}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=f(n(4)),l=f(n(17)),c=f(n(27)),u=f(n(30)),s=f(n(8));function f(e){return e&&e.__esModule?e:{default:e}}var d,p,h,y,v,b,g=(r=(0,n(1).requires)("canvas"),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}));return i.canvas=new l.default(i.options),i.menu=new c.default(i.options),i.messages=new u.default(i.options),i.mathjax=new s.default(i.options),i.add(i.messages).add(i.menu).add(i.canvas).add(i.mathjax),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"render",value:function(){var e=this.options.appendTo,t="Frame-"+this.data.canvas.id;if(this.element=d3.select("div#"+t),this.element.node()||(this.logger.debug("Creating Frame ["+t+"]..."),this.element=e.append("div").attr("class","francy").attr("id",t)),!this.element.node())throw new Error("Oops, could not create frame with id ["+t+"]... Cannot proceed.");return this.logger.debug("Frame updated ["+t+"]..."),this.renderChildren(),this}},{key:"unrender",value:function(){}}]),t}(),d=a.prototype,p="render",h=[r],y=Object.getOwnPropertyDescriptor(a.prototype,"render"),v=a.prototype,b={},Object.keys(y).forEach(function(e){b[e]=y[e]}),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=h.slice().reverse().reduce(function(e,t){return t(d,p,e)||e},b),v&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(v):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(d,p,b),b=null),a);t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"parse",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){t=(t="string"!=typeof t?JSON.stringify(t):t).replace(/[\n\r\b\\]+|(gap>)/g,"");var r=/{(?:[^])*}/g.exec(t);if(r){t=r[0];try{var a=JSON.parse(t);return a.mime===e.MIME||n?a:void 0}catch(e){console.error(e)}}}}},{key:"MIME",get:function(){return"application/vnd.francy+json"}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(4)),l=u(n(18)),c=u(n(23));function u(e){return e&&e.__esModule?e:{default:e}}var s,f,d,p,h,y,v=(r=(0,n(1).requires)("canvas"),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}));return i.graph=new l.default(i.options),i.chartFactory=new c.default(i.options),i.add(i.graph).add(i.chartFactory),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"render",value:function(){var e=void 0,t=d3.zoom(),n=this;function r(){if(n.data.canvas.zoomToFit){var r=e.node().getBBox(),a=n.element.node().getBoundingClientRect(),o=a.right-a.left,i=a.bottom-a.top,l=+r.width,c=+r.height;if(0===l||0===c)return;var u=r.x+l/2,s=r.y+c/2,f=.9/Math.max(l/o,c/i),d=o/2-f*u,p=i/2-f*s;e.transition().duration(n.transitionDuration).attr("transform","translate("+d+","+p+")scale("+f+","+f+")").on("end",function(){return function(e,r,a){n.element.call(t.transform,d3.zoomIdentity.translate(e,r).scale(a,a))}(d,p,f)})}}var a="Canvas-"+this.data.canvas.id;if(this.element=d3.select("svg#"+a),this.element.node()||(this.logger.debug("Creating Canvas ["+a+"]..."),this.element=this.parent.append("svg").attr("class","francy-canvas").attr("id",a)),!this.element.node())throw new Error("Oops, could not create canvas with id ["+a+"]... Cannot proceed.");return this.element.attr("width",this.data.canvas.width).attr("height",this.data.canvas.height),(e=this.element.select("g.francy-content")).node()||(e=this.element.append("g").attr("class","francy-content"),t.on("zoom",function(){e.attr("transform",d3.event.transform)}),this.element.call(t).on("dblclick.zoom",null)),this.element.on("click",function(){d3.event.defaultPrevented&&d3.event.stopPropagation()},!0),this.element.zoomToFit=this.zoomToFit=r,this.logger.debug("Canvas updated ["+a+"]..."),this.renderChildren(),setTimeout(function(){r()},this.transitionDuration),this}},{key:"unrender",value:function(){}}]),t}(),s=a.prototype,f="render",d=[r],p=Object.getOwnPropertyDescriptor(a.prototype,"render"),h=a.prototype,y={},Object.keys(p).forEach(function(e){y[e]=p[e]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=d.slice().reverse().reduce(function(e,t){return t(s,f,e)||e},y),h&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(h):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(s,f,y),y=null),a);t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(0)),l=u(n(19)),c=u(n(22));function u(e){return e&&e.__esModule?e:{default:e}}var s,f,d,p,h,y,v=(r=(0,n(1).requires)("canvas.graph"),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"render",value:function(){var e=void 0;switch(this.data.canvas.graph.type){case"tree":e=new l.default(this.options).load(this.data).render();break;default:e=new c.default(this.options).load(this.data).render()}return e}},{key:"unrender",value:function(){}}]),t}(),s=a.prototype,f="render",d=[r],p=Object.getOwnPropertyDescriptor(a.prototype,"render"),h=a.prototype,y={},Object.keys(p).forEach(function(e){y[e]=p[e]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=d.slice().reverse().reduce(function(e,t){return t(s,f,e)||e},y),h&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(h):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(s,f,y),y=null),a);t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(7),c=(o=l)&&o.__esModule?o:{default:o};var u,s,f,d,p,h,y=(r=(0,n(2).initialize)(),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.default),i(t,[{key:"render",value:function(){var e=0,t=void 0;(t=d3.hierarchy(this.treeData,function(e){return e.children})).x0=this.height/2,t.y0=0;var n=[1];!function e(t,r){r.children&&r.children.length>0&&(n.length<=t+1&&n.push(0),n[t+1]+=r.children.length,r.children.forEach(function(n){e(t+1,n)}))}(0,t);var r=100*d3.max(n),a=d3.tree().size([r,this.width]);function o(n){var r=this;var i=a(t);var l=i.descendants(),u=i.descendants().slice(1);l.forEach(function(e){return e.y=e.depth*180});var s=this.element.selectAll("g.francy-links");if(!s.node()){s=this.element.append("g").attr("class","francy-links")}var f=s.selectAll("path.francy-edge").data(u,function(t){return t.id||(t.id=++e)});var d=f.enter().append("path").attr("class","francy-edge").attr("d",function(){var e={x:n.x0,y:n.y0};return p(e,e)});d.merge(f).transition().duration(this.transitionDuration).attr("d",function(e){return p(e,e.parent)});f.exit().transition().duration(this.transitionDuration).attr("d",function(){var e={x:n.x,y:n.y};return p(e,e)}).remove();s.selectAll("path.francy-edge").style("fill","none").style("stroke","#ccc").style("stroke-width","1px");l.forEach(function(e){e.x0=e.x;e.y0=e.y});function p(e,t){return"M "+e.y+" "+e.x+"\n            C "+(e.y+t.y)/2+" "+e.x+",\n              "+(e.y+t.y)/2+" "+t.x+",\n              "+t.y+" "+t.x}var h=this.element.selectAll("g.francy-nodes");if(!h.node()){h=this.element.append("g").attr("class","francy-nodes")}var y=h.selectAll("g.francy-node").data(l,function(t){return t.id||(t.id=++e)});var v=y.enter().append("g").attr("class","francy-node").attr("transform",function(){return"translate("+n.y0+","+n.x0+")"});v.append("path").attr("d",d3.symbol().type(function(e){return c.default.getSymbol(e.data.type)}).size(function(e){return e.data.size*100})).attr("class","francy-symbol");v.append("text").attr("class","francy-label").text(function(e){return e.data.title}).attr("x",function(){var e=this.getBBox();return-(e.width/2)}).style("cursor",function(e){return e.children||e._children?"pointer":"default"});var b=v.merge(y);b.transition().duration(this.transitionDuration).attr("transform",function(e){return"translate("+e.y+","+e.x+")"});y.exit().transition().duration(this.transitionDuration).attr("transform",function(){return"translate("+n.y+","+n.x+")"}).remove();h.selectAll("path.francy-symbol").style("fill",function(e){return e.children||e._children?"lightsteelblue":c.default.colors(e.data.layer*5)}).style("cursor",function(e){return e.children||e._children?"pointer":"default"});y=h.selectAll("g.francy-node");if(y.node()){this._applyEvents(y);var g=y.on("click");y.on("click",function(e){g.call(r,e.data);w.call(r,e)})}var m=this;function w(e){if(e.children){e._children=e.children;e.children=null}else{e.children=e._children;e._children=null}o.call(m,e)}setTimeout(function(){r.parent.zoomToFit()},this.transitionDuration)}return this.data.canvas.graph.collapsed&&t.children.forEach(function e(t){t.children&&(t._children=t.children,t._children.forEach(e),t.children=null)}),function(n){var r=this;var i=a(t);var l=i.descendants(),u=i.descendants().slice(1);l.forEach(function(e){return e.y=180*e.depth});var s=this.element.selectAll("g.francy-links");s.node()||(s=this.element.append("g").attr("class","francy-links"));var f=s.selectAll("path.francy-edge").data(u,function(t){return t.id||(t.id=++e)});var d=f.enter().append("path").attr("class","francy-edge").attr("d",function(){var e={x:n.x0,y:n.y0};return p(e,e)});d.merge(f).transition().duration(this.transitionDuration).attr("d",function(e){return p(e,e.parent)});f.exit().transition().duration(this.transitionDuration).attr("d",function(){var e={x:n.x,y:n.y};return p(e,e)}).remove();s.selectAll("path.francy-edge").style("fill","none").style("stroke","#ccc").style("stroke-width","1px");l.forEach(function(e){e.x0=e.x,e.y0=e.y});function p(e,t){return"M "+e.y+" "+e.x+"\n            C "+(e.y+t.y)/2+" "+e.x+",\n              "+(e.y+t.y)/2+" "+t.x+",\n              "+t.y+" "+t.x}var h=this.element.selectAll("g.francy-nodes");h.node()||(h=this.element.append("g").attr("class","francy-nodes"));var y=h.selectAll("g.francy-node").data(l,function(t){return t.id||(t.id=++e)});var v=y.enter().append("g").attr("class","francy-node").attr("transform",function(){return"translate("+n.y0+","+n.x0+")"});v.append("path").attr("d",d3.symbol().type(function(e){return c.default.getSymbol(e.data.type)}).size(function(e){return 100*e.data.size})).attr("class","francy-symbol");v.append("text").attr("class","francy-label").text(function(e){return e.data.title}).attr("x",function(){var e=this.getBBox();return-e.width/2}).style("cursor",function(e){return e.children||e._children?"pointer":"default"});var b=v.merge(y);b.transition().duration(this.transitionDuration).attr("transform",function(e){return"translate("+e.y+","+e.x+")"});y.exit().transition().duration(this.transitionDuration).attr("transform",function(){return"translate("+n.y+","+n.x+")"}).remove();h.selectAll("path.francy-symbol").style("fill",function(e){return e.children||e._children?"lightsteelblue":c.default.colors(5*e.data.layer)}).style("cursor",function(e){return e.children||e._children?"pointer":"default"});y=h.selectAll("g.francy-node");if(y.node()){this._applyEvents(y);var g=y.on("click");y.on("click",function(e){g.call(r,e.data),function(e){e.children?(e._children=e.children,e.children=null):(e.children=e._children,e._children=null);o.call(m,e)}.call(r,e)})}var m=this;setTimeout(function(){r.parent.zoomToFit()},this.transitionDuration)}.call(this,t),this}},{key:"unrender",value:function(){}},{key:"treeData",get:function(){var e=this.data.canvas.graph.nodes?Object.values(this.data.canvas.graph.nodes):[],t=e.reduce(function(e,t){return e[t.id]=t,e},{}),n=[];return e.forEach(function(e){var r=t[e.parent];r?(r.children||(r.children=[])).push(e):n.push(e)}),n[0]}}]),t}(),u=a.prototype,s="render",f=[r],d=Object.getOwnPropertyDescriptor(a.prototype,"render"),p=a.prototype,h={},Object.keys(d).forEach(function(e){h[e]=d[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=f.slice().reverse().reduce(function(e,t){return t(u,s,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(u,s,h),h=null),a);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(9),c=(o=l)&&o.__esModule?o:{default:o};var u,s,f,d,p,h,y=(r=(0,n(1).requires)("menus"),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.default),i(t,[{key:"render",value:function(){var e=this;d3.event.preventDefault(),this.element=this.HTMLParent.select("div.francy-context-menu-holder"),this.element.node()||(this.element=this.HTMLParent.append("div").attr("class","francy-context-menu-holder"));var t=d3.mouse(this.SVGParent.node());if(this.element.style("left",t[0]+5+"px").style("top",t[1]+5+"px"),this.element.style("display","block"),!this.element.selectAll("*").node()){d3.select("body").on("click.francy-context-menu",function(){return e.unrender()});var n=this.element.append("div").attr("class","francy-context-menu").append("ul"),r=this.iterator(Object.values(this.data.menus));return this.traverse(n,r),this}}},{key:"unrender",value:function(){this.element&&(this.element.selectAll("*").remove(),this.element.style("display",null))}}]),t}(),u=a.prototype,s="render",f=[r],d=Object.getOwnPropertyDescriptor(a.prototype,"render"),p=a.prototype,h={},Object.keys(d).forEach(function(e){h[e]=d[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=f.slice().reverse().reduce(function(e,t){return t(u,s,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(u,s,h),h=null),a);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(11),c=(o=l)&&o.__esModule?o:{default:o},u=n(12);var s,f,d,p,h,y,v=(r=(0,n(2).initialize)(),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.default),i(t,[{key:"render",value:function(){var e=this,t=this,n=this.data.callback.id;this.logger.debug("Creating Callback Modal ["+n+"]..."),this.element=this.holder.append("div").attr("id",n).attr("class","francy-modal");var r=this.element.append("form"),a=r.append("div").attr("class","francy-modal-header").append("span").html("Required arguments&nbsp;");this.data.title&&a.append("span").attr("style","font-weight: bold;").text("for "+this.data.title);var o=r.append("div").attr("class","francy-modal-content").append("div").attr("class","francy-table").append("div").attr("class","francy-table-body"),i=!0,l=!1,c=void 0;try{for(var s,f=Object.values(this.data.callback.requiredArgs)[Symbol.iterator]();!(i=(s=f.next()).done);i=!0){var d=s.value,p=o.append("div").attr("class","francy-table-row");p.append("div").attr("class","francy-table-cell").append("label").attr("for",d.id).text(d.title);var h=p.append("div").attr("class","francy-table-cell").append("input").attr("id",d.id).attr("class","francy-arg").attr("required","").attr("name",d.id).attr("type",d.type).attr("value",d.value).on("change",function(){t.data.callback.requiredArgs[this.id].value=this.value}).on("input",this.onchange).on("keyup",this.onchange).on("paste",this.onchange);"boolean"===d.type&&(d.value=d.value||!1,h.attr("type","checkbox").attr("required",null).attr("value",d.value).on("change",function(){t.data.callback.requiredArgs[this.id].value=this.value=this.checked})),p.append("span").attr("class","validity")}}catch(e){l=!0,c=e}finally{try{!i&&f.return&&f.return()}finally{if(l)throw c}}var y=r.append("div").attr("class","francy-modal-footer");y.append("button").text("Ok").on("click",function(){return r.node().checkValidity()&&(d3.event.preventDefault(),e.options.callbackHandler(e.data.callback),e.unrender.call(e)),!1}),y.append("button").text("Cancel").on("click",function(){d3.event.preventDefault(),e.unrender.call(e)}),(0,u.RegisterJupyterKeyboardEvents)([".francy",".francy-arg",".francy-overlay",".francy-modal"]);var v=o.selectAll(".francy-arg").node();return v&&v.focus(),this.logger.debug("Callback Modal updated ["+n+"]..."),this}}]),t}(),s=a.prototype,f="render",d=[r],p=Object.getOwnPropertyDescriptor(a.prototype,"render"),h=a.prototype,y={},Object.keys(p).forEach(function(e){y[e]=p[e]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=d.slice().reverse().reduce(function(e,t){return t(s,f,e)||e},y),h&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(h):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(s,f,y),y=null),a);t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(7),c=(o=l)&&o.__esModule?o:{default:o};var u,s,f,d,p,h,y=(r=(0,n(2).initialize)(),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.default),i(t,[{key:"render",value:function(){var e=this,t=this.data.canvas.graph.simulation,n=this.data.canvas.graph.nodes?Object.values(this.data.canvas.graph.nodes):[],r=this.data.canvas.graph.links?Object.values(this.data.canvas.graph.links):[],a=this.element.selectAll("g.francy-links");a.node()||(a=this.element.append("g").attr("class","francy-links"));var o=a.selectAll("g.francy-link").data(),i=this._filterNewElements(r,o),l=a.selectAll("g.francy-link").data(i,function(e){return e.id}),u=this.element.selectAll("g.francy-nodes");u.node()||(u=this.element.append("g").attr("class","francy-nodes"));var s=u.selectAll("g.francy-node").data(),f=this._filterNewElements(n,s),d=u.selectAll("g.francy-node").data(f,function(e){return e.id});if(0!==d.exit().data().length||0!==d.enter().data().length||0!==l.enter().data().length||0!==l.exit().data().length){l.enter().append("g").attr("class","francy-link").append("line").attr("class","francy-edge"),l.exit().remove(),l=a.selectAll("g.francy-link line.francy-edge"),"directed"===this.data.canvas.graph.type&&(e.parent.append("defs").selectAll("marker").data(["arrow"]).enter().append("marker").attr("class","francy-arrows").attr("id",function(e){return e}).attr("viewBox","0 -5 10 10").attr("refX",25).attr("refY",0).attr("markerWidth",10).attr("markerHeight",10).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5 L10,0 L0, -5"),l.style("marker-end","url(#arrow)"));var p=d.enter().append("g").attr("class","francy-node").attr("id",function(e){return e.id});if(p.append("path").attr("d",d3.symbol().type(function(e){return c.default.getSymbol(e.type)}).size(function(e){return 100*e.size})).style("fill",function(e){return c.default.colors(5*e.layer)}).attr("class",function(e){return"francy-symbol"+(e.highlight?" francy-highlight":"")+(Object.values(e.menus).length?" francy-context":"")}),p.append("text").attr("class","francy-label").text(function(e){return e.title}).attr("x",function(){return-this.getBBox().width/2}),d.exit().remove(),d=u.selectAll("g.francy-node"),this.data.canvas.graph.drag&&d.call(d3.drag().on("start",function(e){!d3.event.active&&t&&_.alphaTarget(.01).restart();e.fx=e.x,e.fy=e.y}).on("drag",function(e){e.fx=d3.event.x,e.fy=d3.event.y}).on("end",function(e){!d3.event.active&&t&&_.alphaTarget(0);e.fx=null,e.fy=null})),d&&!d.empty()&&(this._applyEvents(d),this.data.canvas.graph.showNeighbours)){var h=d.on("click");d.on("click",function(e){(function(){function e(e,t){return x[e.index+","+t.index]}if(d3.event.preventDefault(),0===O){var t=d3.select(this).node().__data__;d.style("opacity",function(n){return e(t,n)||e(n,t)?1:.1}),l.style("opacity",function(e){return t.index===e.source.index||t.index===e.target.index?1:.1}),O=1}else d.style("opacity",1),l.style("opacity",1),O=0}).call(this),h.call(this,e)})}if(t){var y=0;d.each(function(){var e=this.getBBox();y<e.width&&(y=e.width)});var v=d3.forceManyBody().strength(75*-n.length),b=d3.forceLink(r).id(function(e){return e.id}).distance(75),g=d3.forceCollide().radius(y/2).iterations(3),m=d3.forceX(this.width).strength(.05),w=d3.forceY(-this.height).strength(.25);"hasse"===this.data.canvas.graph.type&&(m=d3.forceX(this.width).strength(.4),w=d3.forceY(function(e){return 75*e.layer}).strength(.7));var _=d3.forceSimulation().nodes(f).force("charge",v).force("link",b).force("x",m).force("y",w).force("collide",g).on("tick",j).on("end",function(){e.parent.zoomToFit()});_.restart()}else j(),e.parent.zoomToFit();for(var O=0,x={},k=0;k<n.length;k++)x[k+","+k]=1;return r.forEach(function(e){x[e.source.index+","+e.target.index]=1}),this}function j(){l.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),d.attr("transform",function(e){return"translate("+e.x+","+e.y+")"})}}},{key:"unrender",value:function(){}},{key:"_filterNewElements",value:function(e,t){var n=[];return e.forEach(function(e){var r=t.find(function(t){return t.id===e.id});r?n.push(r):n.push(e)}),n}}]),t}(),u=a.prototype,s="render",f=[r],d=Object.getOwnPropertyDescriptor(a.prototype,"render"),p=a.prototype,h={},Object.keys(d).forEach(function(e){h[e]=d[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=f.slice().reverse().reduce(function(e,t){return t(u,s,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(u,s,h),h=null),a);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(0)),l=s(n(24)),c=s(n(25)),u=s(n(26));function s(e){return e&&e.__esModule?e:{default:e}}var f,d,p,h,y,v,b=(r=(0,n(1).requires)("canvas.chart"),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"render",value:function(){var e=void 0;switch(this.data.canvas.chart.type){case"bar":e=new l.default(this.options).load(this.data).render();break;case"line":e=new c.default(this.options).load(this.data).render();break;case"scatter":e=new u.default(this.options).load(this.data).render()}return e}},{key:"unrender",value:function(){}}]),t}(),f=a.prototype,d="render",p=[r],h=Object.getOwnPropertyDescriptor(a.prototype,"render"),y=a.prototype,v={},Object.keys(h).forEach(function(e){v[e]=h[e]}),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=p.slice().reverse().reduce(function(e,t){return t(f,d,e)||e},v),y&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(y):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(f,d,v),v=null),a);t.default=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(3),c=(o=l)&&o.__esModule?o:{default:o};var u,s,f,d,p,h,y=(r=(0,n(2).initialize)(),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.default),i(t,[{key:"render",value:function(){this.xScale=d3.scaleBand().range([0,this.width]).padding(.1).domain(this.axis.x.domain),this.axis.x.domain.length||(this.axis.x.domain=c.default.domainRange(this.allValues.length/this.datasetNames.length),this.xScale.domain(this.axis.x.domain));var e=this.element.selectAll("g.francy-bars");e.node()||(e=this.element.append("g").attr("class","francy-bars"));var t=this;return this.datasetNames.forEach(function(n,r){var a=e.selectAll(".francy-bar-"+r).data(t.datasets[n]);a.exit().transition().duration(750).style("fill-opacity",1e-6).remove(),a.enter().append("rect").style("fill",function(){return c.default.colors(5*r)}).attr("class","francy-bar-"+r).attr("x",function(e,n){return t.xScale(t.axis.x.domain[n])+r*(t.xScale.bandwidth()/t.datasetNames.length)}).attr("width",t.xScale.bandwidth()/t.datasetNames.length-1).attr("y",function(e){return t.yScale(e)}).attr("height",function(e){return t.height-t.yScale(e)}).on("mouseenter",function(e){d3.select(this).transition().duration(250).style("fill-opacity",.5),t.tooltip.load(c.default.tooltip(n,e),!0).render()}).on("mouseleave",function(){d3.select(this).transition().duration(250).style("fill-opacity",1),t.tooltip.unrender()}).merge(a).attr("x",function(e,n){return t.xScale(t.axis.x.domain[n])+r*(t.xScale.bandwidth()/t.datasetNames.length)}).attr("width",t.xScale.bandwidth()/t.datasetNames.length-1).attr("y",function(e){return t.yScale(e)}).attr("height",function(e){return t.height-t.yScale(e)})}),this._renderAxis(),this._renderLegend(),this}},{key:"unrender",value:function(){}}]),t}(),u=a.prototype,s="render",f=[r],d=Object.getOwnPropertyDescriptor(a.prototype,"render"),p=a.prototype,h={},Object.keys(d).forEach(function(e){h[e]=d[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=f.slice().reverse().reduce(function(e,t){return t(u,s,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(u,s,h),h=null),a);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(3),c=(o=l)&&o.__esModule?o:{default:o};var u,s,f,d,p,h,y=(r=(0,n(2).initialize)(),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.default),i(t,[{key:"render",value:function(){var e=this.element.selectAll("g.francy-lines");e.node()||(e=this.element.append("g").attr("class","francy-lines"));var t=this;return this.datasetNames.forEach(function(n,r){var a=d3.line().x(function(e,n){return t.xScale(n)}).y(function(e){return t.yScale(e)}),o=e.selectAll(".francy-line-"+r).data([t.datasets[n]]);o.exit().transition().duration(750).style("fill-opacity",1e-6).remove(),o.enter().append("path").style("stroke",function(){return c.default.colors(5*r)}).style("stroke-width","5px").attr("class","francy-line-"+r).attr("d",a).on("mouseenter",function(e){d3.select(this).transition().duration(250).style("stroke-opacity",.5).style("stroke-width","10px"),t.tooltip.load(c.default.tooltip(n,e),!0).render()}).on("mouseleave",function(){d3.select(this).transition().duration(250).style("stroke-opacity",1).style("stroke-width","5px"),t.tooltip.unrender()}).merge(o)}),this._renderAxis(),this._renderLegend(),this}},{key:"unrender",value:function(){}}]),t}(),u=a.prototype,s="render",f=[r],d=Object.getOwnPropertyDescriptor(a.prototype,"render"),p=a.prototype,h={},Object.keys(d).forEach(function(e){h[e]=d[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=f.slice().reverse().reduce(function(e,t){return t(u,s,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(u,s,h),h=null),a);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(3),c=(o=l)&&o.__esModule?o:{default:o};var u,s,f,d,p,h,y=(r=(0,n(2).initialize)(),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.default),i(t,[{key:"render",value:function(){var e=this.element.selectAll("g.francy-scatters");e.node()||(e=this.element.append("g").attr("class","francy-scatters"));var t=this;return this.datasetNames.forEach(function(n,r){var a=e.selectAll(".francy-scatter-"+r).data(t.datasets[n]);a.exit().transition().duration(750).style("fill-opacity",1e-6).remove(),a.enter().append("circle").style("fill",function(){return c.default.colors(5*r)}).attr("class","francy-scatter-"+r).attr("r",5).attr("cx",function(e,n){return t.xScale(n)}).attr("cy",function(e){return t.yScale(e)}).on("mouseenter",function(e){d3.select(this).transition().duration(250).style("fill-opacity",.5).attr("r",10),t.tooltip.load(c.default.tooltip(n,e),!0).render()}).on("mouseleave",function(){d3.select(this).transition().duration(250).style("fill-opacity",1).attr("r",5),t.tooltip.unrender()}).merge(a)}),this._renderAxis(),this._renderLegend(),this}},{key:"unrender",value:function(){}}]),t}(),u=a.prototype,s="render",f=[r],d=Object.getOwnPropertyDescriptor(a.prototype,"render"),p=a.prototype,h={},Object.keys(d).forEach(function(e){h[e]=d[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=f.slice().reverse().reduce(function(e,t){return t(u,s,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(u,s,h),h=null),a);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=l(n(9)),o=l(n(28)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(29));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"render",value:function(){var e=this,t=new o.default(this.options),n="MainMenu-"+this.data.canvas.id;this.element=d3.select("#"+n),this.element.node()||(this.logger.debug("Creating Main Menu ["+n+"]..."),this.element=this.parent.append("div").attr("class","francy-main-menu-holder").attr("id",n)),this.element.selectAll("*").remove(),this.element=this.element.append("ul").attr("class","francy-main-menu"),this.data.canvas.title&&this.element.append("li").attr("class","francy-title").append("a").html(this.data.canvas.title);var r=this.element.append("li");r.append("a").html("Francy");var a=r.append("ul");a.append("li").append("a").on("click",function(){return e.options.appendTo.canvas.zoomToFit()}).attr("title","Zoom to Fit").html("Zoom to Fit"),a.append("li").append("a").on("click",function(){return i.saveSvgAsPng(e.SVGParent.node(),"diagram.png")}).attr("title","Save to PNG").html("Save to PNG"),a.append("li").append("a").on("click",function(){return t.load(e.data).render()}).attr("title","About").html("About");var l=this.iterator(Object.values(this.data.canvas.menus));return this.traverse(this.element,l),this.logger.debug("Main Menu updated ["+n+"]..."),this}},{key:"unrender",value:function(){}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(11),c=(o=l)&&o.__esModule?o:{default:o},u=n(12);var s,f,d,p,h,y,v=(r=(0,n(2).initialize)(),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.default),i(t,[{key:"render",value:function(){var e=this,t="AboutModalWindow";this.logger.debug("Creating About Modal ["+t+"]..."),this.element=this.holder.append("div").attr("id",t).attr("class","francy-modal");var n=this.element.append("form");n.append("div").attr("class","francy-modal-header").append("span").html("About Francy v"+(this.data.version||"N/A"));var r=n.append("div").attr("class","francy-modal-content").append("div").attr("class","francy-table").append("div").attr("class","francy-table-body");return r.append("span").text("Loaded Object:"),r.append("pre").attr("class","francy").html((0,u.syntaxHighlight)(JSON.stringify(this.data.canvas,null,2))),r.append("span").append("a").attr("href","https://github.com/mcmartins/francy").text("Francy on Github"),n.append("div").attr("class","francy-modal-footer").append("button").text("Ok").on("click",function(){d3.event.preventDefault(),e.unrender.call(e)}),(0,u.RegisterJupyterKeyboardEvents)([".francy",".francy-arg",".francy-overlay",".francy-modal"]),this.logger.debug("Callback About updated ["+t+"]..."),this}}]),t}(),s=a.prototype,f="render",d=[r],p=Object.getOwnPropertyDescriptor(a.prototype,"render"),h=a.prototype,y={},Object.keys(p).forEach(function(e){y[e]=p[e]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=d.slice().reverse().reduce(function(e,t){return t(s,f,e)||e},y),h&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(h):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(s,f,y),y=null),a);t.default=v},function(e,t,n){"use strict";var r;!function(){var a=void 0!==t&&t||{}||this;function o(e){if(!((t=e)instanceof HTMLElement||t instanceof SVGElement))throw new Error("an HTMLElement or SVGElement is required; got "+e);var t}function i(e,t,n){for(var r=t.selectorRemap,a=t.modifyStyle,o="",i=[],l=document.styleSheets,c=0;c<l.length;c++){try{var u=l[c].cssRules}catch(e){console.warn("Stylesheet could not be loaded: "+l[c].href);continue}if(null!=u)for(var s,f=0;f<u.length;f++,s=null){var d=u[f];if(void 0!==d.style){var p;try{p=d.selectorText}catch(e){console.warn('The following CSS rule has an invalid selector: "'+d+'"',e)}try{p&&(s=e.querySelector(p)||e.parentNode.querySelector(p))}catch(e){console.warn('Invalid CSS selector "'+p+'"',e)}if(s){var h=r?r(d.selectorText):d.selectorText,y=a?a(d.style.cssText):d.style.cssText;o+=h+" { "+y+" }\n"}else if(d.cssText.match(/^@font-face/)){var v=/url\(["']?(.+?)["']?\)/,b=d.cssText.match(v),g=b&&b[1]||"";g.match(/^data:/)&&(g=""),g?(g.startsWith("../")?g=l[c].href+"/../"+g:g.startsWith("./")&&(g=l[c].href+"/."+g),i.push({text:d.cssText,fontUrlRegexp:v,format:m(g),url:g})):o+=d.cssText+"\n"}}}}function m(e){for(var t={woff2:"font/woff2",woff:"font/woff",otf:"application/x-font-opentype",ttf:"application/x-font-ttf",eot:"application/vnd.ms-fontobject",sfnt:"application/font-sfnt",svg:"image/svg+xml"},n=Object.keys(t),r=0;r<n.length;++r){var a=n[r];if(e.indexOf("."+a)>0)return t[a]}return console.error("Unknown font format for "+e+"; Fonts may not be working correctly"),"application/octet-stream"}function w(e){if(e.length>0){var t=e.pop();r(t)}else{n(o)}function r(t){var n=new XMLHttpRequest;function r(){var e,r=_(n.response);i(t,r)}function a(e){console.warn("Failed to load font from: "+t.url);console.warn(e);o+=t.text+"\n";w()}function i(t,n){var r='url("data:'+t.format+";base64,"+n+'")';o+=t.text.replace(t.fontUrlRegexp,r)+"\n",setTimeout(function(){w(e)},0)}n.addEventListener("load",r),n.addEventListener("error",a),n.addEventListener("abort",a),n.open("GET",t.url),n.responseType="arraybuffer",n.send()}}function _(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,a=0;a<r;a++){t+=String.fromCharCode(n[a])}return window.btoa(t)}!function(e){if(e.length>0){var t=e.pop();!function(t){var n=new XMLHttpRequest;function r(e){console.warn("Failed to load font from: "+t.url),console.warn(e),o+=t.text+"\n",w()}n.addEventListener("load",function(){var r=function(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,a=0;a<r;a++)t+=String.fromCharCode(n[a]);return window.btoa(t)}(n.response);!function(t,n){var r='url("data:'+t.format+";base64,"+n+'")';o+=t.text.replace(t.fontUrlRegexp,r)+"\n",setTimeout(function(){w(e)},0)}(t,r)}),n.addEventListener("error",r),n.addEventListener("abort",r),n.open("GET",t.url),n.responseType="arraybuffer",n.send()}(t)}else n(o)}(i)}function l(e,t,n){var r=e.viewBox&&e.viewBox.baseVal&&e.viewBox.baseVal[n]||null!==t.getAttribute(n)&&!t.getAttribute(n).match(/%$/)&&parseInt(t.getAttribute(n))||e.getBoundingClientRect()[n]||parseInt(t.style[n])||parseInt(window.getComputedStyle(e).getPropertyValue(n));return void 0===r||null===r||isNaN(parseFloat(r))?0:r}function c(e){for(var t=window.atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),a=new Uint8Array(r),o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return new Blob([r],{type:n})}a.prepareSvg=function(e,t,n){o(e),(t=t||{}).scale=t.scale||1,t.responsive=t.responsive||!1;var r="http://www.w3.org/2000/xmlns/";!function(e,t){o(e);var n=e.querySelectorAll("image"),r=n.length,a=function(){0===r&&t()};a();for(var i=0;i<n.length;i++)!function(e){var t=e.getAttributeNS("http://www.w3.org/1999/xlink","href");if(t&&(n=t.value)&&0==n.lastIndexOf("http",0)&&-1==n.lastIndexOf(window.location.host))console.warn("Cannot render embedded images linking to external hosts: "+t.value);else{var n,o=document.createElement("canvas"),i=o.getContext("2d"),l=new Image;l.crossOrigin="anonymous",(t=t||e.getAttribute("href"))?(l.src=t,l.onload=function(){o.width=l.width,o.height=l.height,i.drawImage(l,0,0),e.setAttributeNS("http://www.w3.org/1999/xlink","href",o.toDataURL("image/png")),r--,a()},l.onerror=function(){console.log("Could not load "+t),r--,a()}):(r--,a())}}(n[i])}(e,function(){var a,o,c=document.createElement("div"),u=e.cloneNode(!0);if("svg"==e.tagName)a=t.width||l(e,u,"width"),o=t.height||l(e,u,"height");else{if(!e.getBBox)return void console.error("Attempted to render non-SVG element",e);var s=e.getBBox();a=s.x+s.width,o=s.y+s.height,u.setAttribute("transform",u.getAttribute("transform").replace(/translate\(.*?\)/,""));var f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.appendChild(u),u=f}u.setAttribute("version","1.1"),u.getAttribute("xmlns")||u.setAttributeNS(r,"xmlns","http://www.w3.org/2000/svg"),u.getAttribute("xmlns:xlink")||u.setAttributeNS(r,"xmlns:xlink","http://www.w3.org/1999/xlink"),t.responsive?(u.removeAttribute("width"),u.removeAttribute("height"),u.setAttribute("preserveAspectRatio","xMinYMin meet")):(u.setAttribute("width",a*t.scale),u.setAttribute("height",o*t.scale)),u.setAttribute("viewBox",[t.left||0,t.top||0,a,o].join(" "));for(var d=u.querySelectorAll("foreignObject > *"),p=0;p<d.length;p++)d[p].getAttribute("xmlns")||d[p].setAttributeNS(r,"xmlns","http://www.w3.org/1999/xhtml");c.appendChild(u),i(e,t,function(e){var t=document.createElement("style");t.setAttribute("type","text/css"),t.innerHTML="<![CDATA[\n"+e+"\n]]>";var r=document.createElement("defs");if(r.appendChild(t),u.insertBefore(r,u.firstChild),n){var i=c.innerHTML;i=i.replace(/NS\d+:href/gi,'xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href'),n(i,a,o)}})})},a.svgAsDataUri=function(e,t,n){a.prepareSvg(e,t,function(e){var t,r="data:image/svg+xml;base64,"+window.btoa((t='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" [<!ENTITY nbsp "&#160;">]>'+e,t=(t=encodeURIComponent(t)).replace(/%([0-9A-F]{2})/g,function(e,t){var n=String.fromCharCode("0x"+t);return"%"===n?"%25":n}),decodeURIComponent(t)));n&&n(r)})},a.svgAsPngUri=function(e,t,n){o(e),(t=t||{}).encoderType=t.encoderType||"image/png",t.encoderOptions=t.encoderOptions||.8;var r=function(e,r,a){var o,i=document.createElement("canvas"),l=i.getContext("2d");i.width=r,i.height=a,t.canvg?t.canvg(i,e):l.drawImage(e,0,0),t.backgroundColor&&(l.globalCompositeOperation="destination-over",l.fillStyle=t.backgroundColor,l.fillRect(0,0,i.width,i.height));try{o=i.toDataURL(t.encoderType,t.encoderOptions)}catch(e){if("undefined"!=typeof SecurityError&&e instanceof SecurityError||"SecurityError"==e.name)return void console.error("Rendered SVG images cannot be downloaded in this browser.");throw e}n(o)};t.canvg?a.prepareSvg(e,t,r):a.svgAsDataUri(e,t,function(e){var t=new Image;t.onload=function(){r(t,t.width,t.height)},t.onerror=function(){console.error("There was an error loading the data URI as an image on the following SVG\n",window.atob(e.slice(26)),"\n","Open the following link to see browser's diagnosis\n",e)},t.src=e})},a.download=function(e,t){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(c(t),e);else{var n=document.createElement("a");if("download"in n){n.download=e,n.style.display="none",document.body.appendChild(n);try{var r=c(t),a=URL.createObjectURL(r);n.href=a,n.onclick=function(){requestAnimationFrame(function(){URL.revokeObjectURL(a)})}}catch(e){console.warn("This browser does not support object URLs. Falling back to string URL."),n.href=t}n.click(),document.body.removeChild(n)}else window.open(t,"_temp","menubar=no,toolbar=no,status=no")}},a.saveSvg=function(e,t,n){o(e),n=n||{},a.svgAsDataUri(e,n,function(e){a.download(t,e)})},a.saveSvgAsPng=function(e,t,n){o(e),n=n||{},a.svgAsPngUri(e,n,function(e){a.download(t,e)})},void 0===(r=function(){return a}.call(t,n,t,e))||(e.exports=r)}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),c=(o=l)&&o.__esModule?o:{default:o};var u,s,f,d,p,h,y=(r=(0,n(1).requires)("canvas.messages"),a=function(e){function t(e){var n=e.verbose,r=void 0!==n&&n,a=e.appendTo,o=e.callbackHandler;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{verbose:r,appendTo:a,callbackHandler:o}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.default),i(t,[{key:"render",value:function(){var e=this,t=Object.keys(this.data.canvas.messages).map(function(t){return{id:t,type:e.data.canvas.messages[t].type,title:e.data.canvas.messages[t].title,text:e.data.canvas.messages[t].text}}),n="Messages-"+this.data.canvas.id;this.element=d3.select("#"+n),this.element.node()||(this.element=this.parent.append("div").attr("class","francy-message-holder").attr("id",n));var r=this.element.selectAll("div.francy-alert").data(t,function(e){return e.id}),a=r.enter().append("div").attr("id",function(e){return e.id}).attr("class",function(e){return"francy-alert alert-"+e.type}).on("click",function(){d3.select(this).style("display","none")});return a.append("span").attr("class","strong").text(function(e){return e.title}),a.append("span").text(function(e){return e.text}),a.append("span").attr("class","strong closeme").style("display","none").text("x"),a.merge(r),r.exit().remove(),this.element.style("display","block"),this}},{key:"unrender",value:function(){}}]),t}(),u=a.prototype,s="render",f=[r],d=Object.getOwnPropertyDescriptor(a.prototype,"render"),p=a.prototype,h={},Object.keys(d).forEach(function(e){h[e]=d[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=f.slice().reverse().reduce(function(e,t){return t(u,s,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(u,s,h),h=null),a);t.default=y}])});